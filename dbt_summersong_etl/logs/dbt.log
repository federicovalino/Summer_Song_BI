[0m02:42:24.031474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:42:24.033471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:42:24.034470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:24.039468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:42:24.040467 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:42:24.041466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:24.045464 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:42:24.045464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:42:24.046464 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:42:24.048378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:42:24.053379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:42:24.054378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:42:24.059183 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:42:24.062181 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:24.063181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:42:24.064180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1434c88a-0a83-4a1a-8b8b-72149d429960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5A3AAB00>]}
[0m02:42:24.065180 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.15s]
[0m02:42:24.067179 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:42:24.068178 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:42:24.069177 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:42:24.072178 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.072178 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:42:24.073176 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:42:24.143135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.144135 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:24.145134 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:42:24.151130 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.152131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.153130 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:42:24.154128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:24.194108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:42:24.194108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.195106 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:42:24.270104 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.07 seconds
[0m02:42:24.274115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.274115 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:42:24.275100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:24.279098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.280104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:42:24.281099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:24.284109 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:42:24.284109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.285094 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:42:24.287595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:42:24.289617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:42:24.290595 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:42:24.296188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:42:24.298209 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:24.298209 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:42:24.299191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1434c88a-0a83-4a1a-8b8b-72149d429960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5A3F4DC0>]}
[0m02:42:24.300188 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.23s]
[0m02:42:24.303187 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:42:24.304186 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:42:24.305185 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:42:24.306185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:24.307184 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:42:24.308184 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:42:24.315182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:24.316181 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:24.317183 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:42:24.325174 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:24.327174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:24.328173 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:42:24.329172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:24.384842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:42:24.384842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:24.385840 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:42:25.274603 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.89 seconds
[0m02:42:25.279601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:25.280602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:42:25.282601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:25.289595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:25.290595 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:42:25.291593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:25.298591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:42:25.299589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:25.299589 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:42:25.301587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:42:25.308583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:42:25.309583 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:42:25.317579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:42:25.322576 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:25.323574 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:42:25.325574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1434c88a-0a83-4a1a-8b8b-72149d429960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE59FC7E20>]}
[0m02:42:25.326574 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 1.02s]
[0m02:42:25.329572 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:42:25.332571 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:42:25.333569 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:42:25.334570 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.338574 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:42:25.339567 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:42:25.351560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.356557 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:25.356557 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:42:25.365553 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.367551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.367551 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:42:25.370550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:25.431513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:42:25.432514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.432514 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:42:25.449191 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:42:25.454189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.455187 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:42:25.456187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:25.460185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.460185 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:42:25.461184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:42:25.465183 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:42:25.466181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.466181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:42:25.468180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:42:25.473178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:42:25.474177 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:42:25.482173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:42:25.486170 [debug] [Thread-1 (]: finished collecting timing info
[0m02:42:25.487170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:42:25.488169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1434c88a-0a83-4a1a-8b8b-72149d429960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5A3B8B80>]}
[0m02:42:25.489169 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.15s]
[0m02:42:25.491168 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:42:25.495165 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:42:25.496164 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:25.496164 [debug] [MainThread]: On master: BEGIN
[0m02:42:25.497164 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:25.581115 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m02:42:25.582115 [debug] [MainThread]: On master: COMMIT
[0m02:42:25.583115 [debug] [MainThread]: Using postgres connection "master"
[0m02:42:25.584114 [debug] [MainThread]: On master: COMMIT
[0m02:42:25.584114 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:42:25.585114 [debug] [MainThread]: On master: Close
[0m02:42:25.587114 [info ] [MainThread]: 
[0m02:42:25.596107 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m02:42:25.598106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:25.599106 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:42:25.599106 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m02:42:25.600105 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:42:25.623093 [info ] [MainThread]: 
[0m02:42:25.625092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:42:25.652075 [info ] [MainThread]: 
[0m02:42:25.668067 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:42:25.683059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE59F0DD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE59F0CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5A1D9A50>]}


============================== 2022-11-23 02:43:30.274140 | 4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb ==============================
[0m02:43:30.274140 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:43:30.275139 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:43:30.276136 [debug] [MainThread]: Tracking: tracking
[0m02:43:30.302133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FDC4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FDF0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FDF0700>]}
[0m02:43:30.408062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:43:30.408062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:43:30.409062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:43:30.424748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FF5FF70>]}
[0m02:43:30.442732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FF269B0>]}
[0m02:43:30.442732 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:43:30.444730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FDC4B20>]}
[0m02:43:30.449730 [info ] [MainThread]: 
[0m02:43:30.451727 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:43:30.462721 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:43:30.495702 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:43:30.496704 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:43:30.497701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:30.557665 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:43:30.560665 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:43:30.561665 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:43:30.564662 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:43:30.565661 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:43:30.565661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:30.625628 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:43:30.627626 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:43:30.628626 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:43:30.631624 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:43:30.632624 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:43:30.632624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:30.674599 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:43:30.676598 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:43:30.679597 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:43:30.688590 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:43:30.689590 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:43:30.690590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:30.728568 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:43:30.728568 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:43:30.729568 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:43:30.736565 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:43:30.738563 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:43:30.739562 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:43:30.740562 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:43:30.743561 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:43:30.743561 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:43:30.744560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:30.782538 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:43:30.782538 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:43:30.783537 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:43:30.792531 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:43:30.795530 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:43:30.796529 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:43:30.797529 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:43:30.801527 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:43:30.801527 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:43:30.802526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:43:30.846500 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:43:30.847500 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:43:30.847500 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:43:30.856494 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:43:30.859493 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:43:30.860492 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:43:30.867490 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:30.868489 [debug] [MainThread]: On master: BEGIN
[0m02:43:30.868489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:30.918460 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:43:30.919459 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:30.919459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:43:30.980424 [debug] [MainThread]: SQL status: SELECT 0 in 0.06 seconds
[0m02:43:30.982423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FF1B820>]}
[0m02:43:30.983422 [debug] [MainThread]: On master: ROLLBACK
[0m02:43:30.983422 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:30.984422 [debug] [MainThread]: On master: BEGIN
[0m02:43:30.984422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:43:30.985421 [debug] [MainThread]: On master: COMMIT
[0m02:43:30.985421 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:30.986420 [debug] [MainThread]: On master: COMMIT
[0m02:43:30.987422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:43:30.987422 [debug] [MainThread]: On master: Close
[0m02:43:30.988421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:30.990419 [info ] [MainThread]: 
[0m02:43:31.000412 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:43:31.001412 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:43:31.012407 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.013408 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:43:31.013408 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:43:31.025399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.026398 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.027397 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:43:31.112350 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.114349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.115347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:43:31.115347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:43:31.156324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:43:31.157323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.157323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:43:31.172598 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:43:31.183591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.183591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:43:31.184591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.188590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.189587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:43:31.190587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.220572 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:43:31.220572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.221569 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:43:31.223586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.230566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:43:31.230566 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:43:31.235324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:31.237339 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.238338 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:43:31.239322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FF9E2F0>]}
[0m02:43:31.240322 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.23s]
[0m02:43:31.242321 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:43:31.243320 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:43:31.243320 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:43:31.245332 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.246335 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:43:31.246335 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:43:31.250347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.252260 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.253264 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:43:31.263258 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.266262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.267258 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:43:31.268266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:31.324222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:31.325222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.325222 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:43:31.335045 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:43:31.340041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.340041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:43:31.341040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.346038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.347038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:43:31.348038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.351034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:43:31.352033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.352033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:43:31.354218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.356220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:43:31.357220 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:43:31.361246 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:31.363245 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.363245 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:43:31.365245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700688E0>]}
[0m02:43:31.366243 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m02:43:31.367243 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:43:31.368241 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:43:31.369241 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:43:31.371241 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.371241 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:43:31.372240 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:43:31.379235 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:43:31.381234 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.382233 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:43:31.392228 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:43:31.394226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.394226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:43:31.396226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:31.449195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:31.450195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.450195 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:43:31.470182 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:43:31.475181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.476179 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:43:31.477180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.481178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.481178 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:43:31.483176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.488172 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:43:31.489172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.489172 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:43:31.492169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.495170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:43:31.495170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:43:31.501165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:31.503165 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.504165 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:43:31.505163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700788E0>]}
[0m02:43:31.506163 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:43:31.508161 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:43:31.508161 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:43:31.509162 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:43:31.510160 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.511161 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:43:31.511161 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:43:31.524155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.527151 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.528150 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:43:31.534145 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.537146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.539143 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:43:31.539143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:31.595111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:31.596112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.596112 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
   /* p.popularity,*/
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    /*inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)*/
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
)

select * from profiled_data
  );
[0m02:43:31.690056 [debug] [Thread-1 (]: SQL status: SELECT 1958 in 0.09 seconds
[0m02:43:31.695055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.696055 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:43:31.697053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.700051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.701050 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:43:31.702050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.706049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:43:31.706049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.707048 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:43:31.709918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.713918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:43:31.714918 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:43:31.720877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:31.722876 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.722876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:43:31.723875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700A09A0>]}
[0m02:43:31.724873 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 1958[0m in 0.21s]
[0m02:43:31.726873 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:43:31.727874 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:43:31.727874 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:43:31.729872 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.729872 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:43:31.730870 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:43:31.734867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.736867 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.736867 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:43:31.749863 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.751861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.753867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:43:31.754857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:31.805837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:31.806827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.806827 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:43:31.829063 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:43:31.832062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.833063 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:43:31.833063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.839060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.839060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:43:31.840058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.843056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:43:31.844055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.844055 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:43:31.846211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.849212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:43:31.849212 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:43:31.853210 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:31.854210 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.855209 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:43:31.856207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700BEAD0>]}
[0m02:43:31.857207 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.13s]
[0m02:43:31.858207 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:43:31.859207 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:43:31.860205 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:43:31.861205 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.862204 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:43:31.862204 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:43:31.871199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.872199 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.873200 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:43:31.882193 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.884191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.885191 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:43:31.885191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:31.940161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:31.940161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.941159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:43:31.969156 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:43:31.973153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.974153 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:43:31.975154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.978152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.978152 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:43:31.979151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:31.983150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:43:31.983150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.984147 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:43:31.986511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:31.991513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:43:31.991513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:43:31.997669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:31.999667 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:31.999667 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:43:32.000668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700E63B0>]}
[0m02:43:32.001667 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.14s]
[0m02:43:32.003666 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:43:32.004667 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:43:32.004667 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:43:32.006664 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.007664 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:43:32.007664 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:43:32.013660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.014659 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.015659 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:43:32.024654 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.025653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.026653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:43:32.027652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.091615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:32.091615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.092615 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:43:32.118600 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:43:32.122597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.122597 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:43:32.123598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.127595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.127595 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:43:32.128594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.133592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:43:32.134591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.134591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:43:32.161576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:43:32.165573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:43:32.166572 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:43:32.172569 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:32.175568 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.175568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:43:32.177566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFB5CF0>]}
[0m02:43:32.178566 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.17s]
[0m02:43:32.180565 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:43:32.181564 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:43:32.182564 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:43:32.184563 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.184563 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:43:32.185563 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:43:32.194557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.196559 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.197555 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:43:32.205550 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.207549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.207549 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:43:32.208549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.264520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:32.265516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.266516 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:43:32.293502 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:43:32.297498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.298497 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:43:32.299499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.304493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.305493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:43:32.306492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.310490 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:43:32.311489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.311489 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:43:32.313488 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:32.317487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:43:32.317487 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:43:32.324482 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:32.326484 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.326484 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:43:32.328480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFE5060>]}
[0m02:43:32.329482 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:43:32.331479 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:43:32.331479 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:43:32.332478 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:43:32.334477 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.335476 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:43:32.336476 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:43:32.345471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.347470 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.348469 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:43:32.363462 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.364460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.365459 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:43:32.365459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.423427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:32.424426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.425425 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:43:32.449410 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:43:32.455407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.455407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:43:32.457407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.462403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.463403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:43:32.464403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.467401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:43:32.468400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.469399 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:43:32.471399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:32.474398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:43:32.475397 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:43:32.481394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:32.483391 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.484391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:43:32.485390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A700F3E80>]}
[0m02:43:32.486390 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.15s]
[0m02:43:32.488389 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:43:32.489388 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:43:32.490388 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:43:32.492387 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.493386 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:43:32.494386 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:43:32.500383 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.502381 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.504389 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:43:32.514380 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.516374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.517373 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:43:32.518373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.573340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:32.574341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.574341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:43:32.596031 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:43:32.600030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.601030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:43:32.601030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.605027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.606027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:43:32.607026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.611023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:43:32.611023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.612022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:43:32.634343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:43:32.637343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:43:32.637343 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:43:32.643340 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:32.645339 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.645339 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:43:32.646338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FF950C0>]}
[0m02:43:32.647339 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.15s]
[0m02:43:32.649337 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:43:32.650336 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:43:32.650336 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:43:32.652334 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.653334 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:43:32.654333 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:43:32.663328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.664328 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.665329 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:43:32.673323 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.675322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.675322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:43:32.676321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.731292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:32.732289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.732289 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:43:32.757509 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:43:32.761506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.761506 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:43:32.762506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.767503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.767503 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:43:32.769502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.773499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:43:32.774498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.774498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:43:32.777138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:32.780139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:43:32.780139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:43:32.786034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:32.788033 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.789032 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:43:32.790031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFE4DC0>]}
[0m02:43:32.791030 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.14s]
[0m02:43:32.793029 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:43:32.794028 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:43:32.795028 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:43:32.797026 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.798026 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:43:32.799025 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:43:32.811019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.814018 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.815017 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:43:32.822012 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.824012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.824012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:43:32.825010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:32.875983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:43:32.876980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.876980 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:43:32.931073 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.05 seconds
[0m02:43:32.935085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.936070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:43:32.937086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.940068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.940068 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:43:32.942067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:32.945065 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:43:32.945065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.946065 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:43:32.948676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:32.950693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:43:32.951692 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:43:32.957992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:32.960008 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.960008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:43:32.960993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFE4CD0>]}
[0m02:43:32.961992 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.16s]
[0m02:43:32.963467 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:43:32.964470 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:43:32.965472 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:43:32.966470 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:32.967470 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:43:32.968468 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:43:32.975463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:32.978463 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:32.980464 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:43:33.056419 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.057419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.058416 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:43:33.058416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:33.101144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:43:33.102154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.103143 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:43:33.695474 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.59 seconds
[0m02:43:33.700473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.701471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:43:33.702470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:33.708466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.709466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:43:33.710477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:33.714465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:43:33.715462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.715462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:43:33.718465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:33.722461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:43:33.722461 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:43:33.729454 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:43:33.731456 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:33.731456 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:43:33.733452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A70140520>]}
[0m02:43:33.734452 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.77s]
[0m02:43:33.737450 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:43:33.739449 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:43:33.741448 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:43:33.744447 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.745450 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:43:33.746445 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:43:33.754440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.756439 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:33.756439 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:43:33.768436 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.770432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.771430 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:43:33.772431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:43:33.832396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:43:33.833397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.833397 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:43:33.849575 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:43:33.853574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.854573 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:43:33.855573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:33.858570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.858570 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:43:33.859570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:33.863567 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:43:33.863567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.863567 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:43:33.866112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:43:33.869114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:43:33.870113 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:43:33.874846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:33.876844 [debug] [Thread-1 (]: finished collecting timing info
[0m02:43:33.877843 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:43:33.878843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4658dd46-a51c-49c7-a34a-4d9fc7d9f4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A7010C100>]}
[0m02:43:33.879842 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.13s]
[0m02:43:33.880842 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:43:33.882840 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:43:33.882840 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:33.883840 [debug] [MainThread]: On master: BEGIN
[0m02:43:33.884839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:33.935811 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:43:33.937816 [debug] [MainThread]: On master: COMMIT
[0m02:43:33.939809 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:33.940809 [debug] [MainThread]: On master: COMMIT
[0m02:43:33.941808 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:43:33.942808 [debug] [MainThread]: On master: Close
[0m02:43:33.943806 [info ] [MainThread]: 
[0m02:43:33.944807 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m02:43:33.945805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:33.946806 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:43:33.946806 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m02:43:33.947803 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:43:33.965795 [info ] [MainThread]: 
[0m02:43:33.966793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:43:33.967793 [info ] [MainThread]: 
[0m02:43:33.971790 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:43:33.975789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFB3D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFB1C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A6FFB3970>]}


============================== 2022-11-23 02:44:52.776469 | 15958b4f-65ba-43ac-bfa5-402962a80eaf ==============================
[0m02:44:52.776469 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:44:52.777449 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:52.777449 [debug] [MainThread]: Tracking: tracking
[0m02:44:52.799437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F410730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F4109D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F4107F0>]}
[0m02:44:52.895400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:44:52.896379 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:44:52.910392 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:44:52.936359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:44:52.948370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F59E080>]}
[0m02:44:52.966340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F53BFA0>]}
[0m02:44:52.966340 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:44:52.968138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F539360>]}
[0m02:44:52.973139 [info ] [MainThread]: 
[0m02:44:52.975140 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:44:52.982138 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:44:53.001140 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:44:53.001140 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:44:53.002124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:53.058151 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:44:53.061151 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:44:53.062150 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:44:53.064149 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:44:53.065149 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:44:53.065149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:53.106124 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:44:53.108124 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:44:53.109122 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:44:53.113121 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:44:53.113121 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:44:53.114120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:53.152098 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:44:53.155097 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:44:53.158094 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:44:53.165090 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:44:53.166090 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:44:53.166090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:53.206996 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:44:53.206996 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:44:53.207994 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:44:53.214990 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:44:53.217989 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:44:53.217989 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:44:53.218987 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:44:53.222988 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:44:53.222988 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:44:53.223985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:53.262604 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:44:53.262604 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:44:53.263604 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:44:53.270600 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:44:53.273613 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:44:53.273613 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:44:53.274600 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:44:53.279596 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:44:53.280595 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:44:53.281593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:53.320578 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:44:53.321572 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:44:53.321572 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:44:53.329566 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:44:53.331565 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:44:53.331565 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:44:53.340561 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.341561 [debug] [MainThread]: On master: BEGIN
[0m02:44:53.342559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:53.379538 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:44:53.380538 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.381536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:53.434507 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:44:53.436506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F3D87C0>]}
[0m02:44:53.437506 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:53.437506 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.438504 [debug] [MainThread]: On master: BEGIN
[0m02:44:53.439505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:53.439505 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.440502 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:53.440502 [debug] [MainThread]: On master: COMMIT
[0m02:44:53.441502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:53.442501 [debug] [MainThread]: On master: Close
[0m02:44:53.443501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:53.444501 [info ] [MainThread]: 
[0m02:44:53.458494 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:44:53.459494 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:44:53.461491 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.462491 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:44:53.463490 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:44:53.472486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.474485 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:53.475484 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:44:53.563432 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.565431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.565431 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:44:53.566444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:44:53.609406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:44:53.610406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.611405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:44:53.671372 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.06 seconds
[0m02:44:53.686362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.687362 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:44:53.688361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:53.695358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.695358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:44:53.697356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:53.745328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:44:53.745328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.746328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:44:53.748328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:53.756322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:44:53.757321 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:44:53.761330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:53.763329 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:53.763329 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:44:53.764328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F6A6140>]}
[0m02:44:53.765329 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.30s]
[0m02:44:53.766329 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:44:53.767329 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:44:53.768326 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:44:53.769325 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.770327 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:44:53.771325 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:44:53.778322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.779319 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:53.779319 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:44:53.785316 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.787317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.788315 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:44:53.789315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:53.848281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:53.848281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.849281 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:44:53.861306 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:44:53.865304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.866303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:44:53.867303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:53.871302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.872299 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:44:53.873299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:53.876298 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:44:53.876298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.877297 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:44:53.878296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:53.881295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:44:53.881295 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:44:53.885771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:53.887771 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:53.888770 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:44:53.889770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F696260>]}
[0m02:44:53.889770 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m02:44:53.891768 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:44:53.892768 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:44:53.893767 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:44:53.894767 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:53.895767 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:44:53.895767 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:44:53.904761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:44:53.906759 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:53.906759 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:44:53.919754 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:44:53.922751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:53.922751 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:44:53.923751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:53.975721 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:44:53.976720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:53.976720 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:44:53.997707 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:44:54.003705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:54.003705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:44:54.005704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.008701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:54.008701 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:44:54.009701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.013698 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:44:54.013698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:54.013698 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:44:54.016845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:54.018847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:44:54.019846 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:44:54.025222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:54.027222 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.028220 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:44:54.029219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F6F5180>]}
[0m02:44:54.030220 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.14s]
[0m02:44:54.032218 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:44:54.033217 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:44:54.033217 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:44:54.035217 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.037215 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:44:54.037215 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:44:54.046209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.047209 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.047209 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:44:54.058203 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.060202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.060202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:44:54.061202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.117170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:54.117170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.118169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=g.artist and y.song=g.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=y.artist and ss.song=y.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (ss.artist=p.artist and ss.song=p.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=p.artist and ri.song=p.song)
)

select * from profiled_data
  );
[0m02:44:54.210131 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.09 seconds
[0m02:44:54.214114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.214114 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:44:54.215113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.219125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.219125 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:44:54.220112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.224108 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:44:54.224108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.225123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:44:54.227286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:54.229287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:44:54.230286 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:44:54.236491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:54.237489 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.238488 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:44:54.239487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F545D50>]}
[0m02:44:54.240487 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m02:44:54.242485 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:44:54.243500 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:44:54.243500 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:44:54.245484 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.246483 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:44:54.246483 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:44:54.253481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.255481 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.256478 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:44:54.269473 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.272469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.273468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:44:54.273468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.326438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:44:54.327438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.327438 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:44:54.352611 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:44:54.356609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.356609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:44:54.357608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.362606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.362606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:44:54.364605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.367603 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:44:54.367603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.368602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:44:54.407739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m02:44:54.410754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:44:54.410754 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:44:54.417200 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:54.419217 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.419217 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:44:54.420201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F727FA0>]}
[0m02:44:54.421201 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.18s]
[0m02:44:54.423006 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:44:54.424010 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:44:54.425008 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:44:54.426007 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.427022 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:44:54.428007 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:44:54.434005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.435002 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.436004 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:44:54.447999 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.450994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.451993 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:44:54.453992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.518956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:54.520954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.520954 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:44:54.550938 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:44:54.555934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.555934 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:44:54.557932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.560931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.561931 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:44:54.562932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.566929 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:44:54.566929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.567926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:44:54.569927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:54.572925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:44:54.573923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:44:54.578800 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:54.580800 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.581800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:44:54.582798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F60F7F0>]}
[0m02:44:54.583797 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.16s]
[0m02:44:54.585797 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:44:54.586796 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:44:54.587795 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:44:54.589796 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.590793 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:44:54.591794 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:44:54.596790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.598790 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.598790 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:44:54.609782 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.611783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.612781 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:44:54.613782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.668749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:44:54.669748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.670747 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:44:54.696480 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:44:54.700478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.700478 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:44:54.701477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.707474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.708472 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:44:54.709473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.712471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:44:54.713469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.713469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:44:54.735060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:44:54.738060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:44:54.738060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:44:54.743634 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:54.745634 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.746633 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:44:54.747633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F747EE0>]}
[0m02:44:54.747633 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.16s]
[0m02:44:54.749631 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:44:54.750631 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:44:54.751630 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:44:54.752630 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.753629 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:44:54.753629 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:44:54.758627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.759626 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.760625 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:44:54.765622 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.766621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.766621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:44:54.767621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:54.837583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m02:44:54.838583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.839580 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:44:54.874559 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:44:54.880556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.880556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:44:54.881556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.887553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.888552 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:44:54.889552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:54.892550 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:44:54.893549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.893549 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:44:54.895550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:54.900546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:44:54.901544 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:44:54.908540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:54.910539 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.911539 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:44:54.912538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F75C550>]}
[0m02:44:54.913538 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.16s]
[0m02:44:54.915536 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:44:54.916537 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:44:54.917537 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:44:54.920535 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:54.922542 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:44:54.923533 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:44:54.931527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:54.932527 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:54.933527 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:44:54.942521 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:54.943521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:54.944520 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:44:54.945519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.003487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:55.004494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:55.005486 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:44:55.028473 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:44:55.032471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:55.032471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:44:55.033470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.038468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:55.039467 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:44:55.040465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.044464 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:44:55.044464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:55.045462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:44:55.046463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:55.053459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:44:55.054458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:44:55.060455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:55.062454 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.062454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:44:55.063452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F763D30>]}
[0m02:44:55.064452 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:44:55.068449 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:44:55.069448 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:44:55.070448 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:44:55.074447 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.077449 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:44:55.078444 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:44:55.082441 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.084440 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.084440 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:44:55.092436 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.094434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.094434 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:44:55.095434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.157398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:55.158399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.159397 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:44:55.183383 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:44:55.187381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.187381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:44:55.188380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.192379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.192379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:44:55.193379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.196376 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:44:55.197375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.197375 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:44:55.199673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:55.202675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:44:55.202675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:44:55.209231 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:55.211229 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.211229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:44:55.212228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F77AD70>]}
[0m02:44:55.213227 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.14s]
[0m02:44:55.216226 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:44:55.216226 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:44:55.217225 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:44:55.220224 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.224223 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:44:55.225222 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:44:55.230219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.231218 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.231218 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:44:55.240213 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.242212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.243210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:44:55.243210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.297182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:44:55.298179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.299179 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:44:55.357066 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.06 seconds
[0m02:44:55.361067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.362064 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:44:55.362064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.366076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.366076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:44:55.367061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.371061 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:44:55.372059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.372059 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:44:55.374506 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:55.378521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:44:55.379520 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:44:55.385433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:55.387446 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.387446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:44:55.389433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F74A0B0>]}
[0m02:44:55.390435 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.17s]
[0m02:44:55.391421 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:44:55.392424 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:44:55.393423 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:44:55.394432 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.395422 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:44:55.396422 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:44:55.471386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.472377 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.473379 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:44:55.478374 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.479375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.480375 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:44:55.480375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.520035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:44:55.520035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.521037 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:44:55.557047 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:44:55.560062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.561060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:44:55.562047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.565057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.565057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:44:55.566049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:55.570041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:44:55.570041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.571041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:44:55.573194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:55.576210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:44:55.576210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:44:55.582341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:55.584357 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.584357 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:44:55.585341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F794C40>]}
[0m02:44:55.586341 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.19s]
[0m02:44:55.588342 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:44:55.589339 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:44:55.590339 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:44:55.591339 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:55.592338 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:44:55.593340 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:44:55.599334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:55.600333 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:55.601333 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:44:55.614328 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:55.615337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:55.616340 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:44:55.617323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:55.677289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:44:55.677289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:55.678291 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:44:56.230975 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.55 seconds
[0m02:44:56.234970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:56.234970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:44:56.236969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:56.239969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:56.240970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:44:56.241966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:56.245966 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:44:56.245966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:56.246964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:44:56.294938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.05 seconds
[0m02:44:56.297937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:44:56.298933 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:44:56.304930 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:44:56.306931 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:56.307931 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:44:56.308930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F36BF70>]}
[0m02:44:56.309928 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.72s]
[0m02:44:56.311926 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:44:56.312926 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:44:56.313928 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:44:56.315925 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.316924 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:44:56.317932 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:44:56.331916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.334914 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:56.335915 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:44:56.347918 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.349905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.349905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:44:56.350908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:44:56.402877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:44:56.403874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.404877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:44:56.425861 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:44:56.431857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.432857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:44:56.433857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:56.437856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.438856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:44:56.439854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:44:56.442855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:44:56.443853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.443853 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:44:56.445853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:44:56.450847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:44:56.450847 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:44:56.456844 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:44:56.458845 [debug] [Thread-1 (]: finished collecting timing info
[0m02:44:56.459842 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:44:56.460841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15958b4f-65ba-43ac-bfa5-402962a80eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F75CD60>]}
[0m02:44:56.461841 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.14s]
[0m02:44:56.464839 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:44:56.466838 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:44:56.467838 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:56.468836 [debug] [MainThread]: On master: BEGIN
[0m02:44:56.469837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:56.533808 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m02:44:56.533808 [debug] [MainThread]: On master: COMMIT
[0m02:44:56.534799 [debug] [MainThread]: Using postgres connection "master"
[0m02:44:56.534799 [debug] [MainThread]: On master: COMMIT
[0m02:44:56.535800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:56.536799 [debug] [MainThread]: On master: Close
[0m02:44:56.539801 [info ] [MainThread]: 
[0m02:44:56.541796 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m02:44:56.542795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:56.543794 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:44:56.543794 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m02:44:56.544794 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:44:56.563784 [info ] [MainThread]: 
[0m02:44:56.564783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:56.566781 [info ] [MainThread]: 
[0m02:44:56.567782 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:44:56.569782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F2AD060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F2AF730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC3F57F820>]}


============================== 2022-11-23 02:45:33.780052 | 3183b6e9-de65-4117-a9ba-802d847d88de ==============================
[0m02:45:33.780052 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:45:33.781038 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:45:33.781038 [debug] [MainThread]: Tracking: tracking
[0m02:45:33.801036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0090EF6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009110970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009110700>]}
[0m02:45:33.908963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:45:33.909962 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:45:33.925953 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:45:33.949884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:45:33.965886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00929E020>]}
[0m02:45:33.982865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00923BF10>]}
[0m02:45:33.983865 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:45:33.984866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0090EF6A0>]}
[0m02:45:33.991861 [info ] [MainThread]: 
[0m02:45:33.993490 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:45:33.996493 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:34.014483 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:34.015491 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:34.016484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:34.073448 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:45:34.076446 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:34.077445 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:34.079445 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:34.080444 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:34.080444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:34.123419 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:45:34.125420 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:34.126417 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:34.130415 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:34.130415 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:34.131415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:34.175389 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:45:34.177389 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:34.182385 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:34.190382 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:34.191382 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:45:34.191382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:34.229504 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:34.229504 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:34.230504 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:45:34.237501 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:45:34.240500 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:45:34.240500 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:45:34.241498 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:34.244496 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:34.245495 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:45:34.245495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:34.287471 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:34.287471 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:34.288471 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:45:34.296477 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:45:34.298465 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:45:34.299464 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:45:34.300465 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:34.302462 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:34.303462 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:45:34.303462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:34.342440 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:34.343440 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:34.343440 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:45:34.351435 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:45:34.353434 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:45:34.354433 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:45:34.360429 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.361429 [debug] [MainThread]: On master: BEGIN
[0m02:45:34.361429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:34.402406 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:45:34.403406 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.404404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:45:34.454391 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:45:34.456378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0090D8AC0>]}
[0m02:45:34.456378 [debug] [MainThread]: On master: ROLLBACK
[0m02:45:34.457390 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.457390 [debug] [MainThread]: On master: BEGIN
[0m02:45:34.458374 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:34.459373 [debug] [MainThread]: On master: COMMIT
[0m02:45:34.459373 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:34.460373 [debug] [MainThread]: On master: COMMIT
[0m02:45:34.460373 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:34.461373 [debug] [MainThread]: On master: Close
[0m02:45:34.462371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:34.464371 [info ] [MainThread]: 
[0m02:45:34.473368 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:45:34.474365 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:45:34.481374 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.483361 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:45:34.484360 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:45:34.493354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.494353 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:34.495355 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:45:34.575308 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.577309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.577309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:45:34.578305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:45:34.623281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:45:34.624279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.625278 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:45:34.642268 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.02 seconds
[0m02:45:34.652265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.653263 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:45:34.654262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:34.660260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.661260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:45:34.662257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:34.703236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:45:34.704235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.705233 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:45:34.706233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:34.718225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:34.718225 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:45:34.723223 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:34.725223 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:34.725223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:45:34.726221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0093A1F30>]}
[0m02:45:34.727220 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.25s]
[0m02:45:34.729219 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:45:34.730219 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:45:34.731219 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:45:34.732218 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.733218 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:45:34.734218 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:45:34.744210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.746210 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:34.747209 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:45:34.761202 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.763201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.764200 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:45:34.764200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:34.825166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:34.826165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.826165 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:45:34.858899 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.03 seconds
[0m02:45:34.861896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.862895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:45:34.863898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:34.866893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.867892 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:45:34.868893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:34.871890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:45:34.871890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.872890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:45:34.873889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:34.876887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:34.877888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:45:34.881886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:34.883885 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:34.884884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:45:34.885885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009395BA0>]}
[0m02:45:34.886883 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.15s]
[0m02:45:34.887882 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:45:34.888881 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:45:34.889881 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:45:34.890881 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:34.891880 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:45:34.892879 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:45:34.901873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:45:34.902874 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:34.904872 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:45:34.916865 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:45:34.918864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:34.920866 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:45:34.921862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:34.974832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:34.974832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:34.975831 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:45:34.994107 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:35.000105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:35.000105 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:45:35.001103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.006101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:35.006101 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:45:35.007100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.011099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:45:35.012097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:35.012097 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:45:35.014405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.016406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:35.017405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:45:35.021403 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:35.023402 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.024401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:45:35.024401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0093F5180>]}
[0m02:45:35.025401 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:45:35.026985 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:45:35.027988 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:45:35.028988 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:45:35.029987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:35.030987 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:45:35.030987 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:45:35.042980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:45:35.045978 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.046979 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:45:35.061969 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:45:35.064969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:35.064969 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:45:35.065967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.112942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:35.113939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:35.114938 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)*/
)

select * from profiled_data
  );
[0m02:45:35.114938 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «)»
LINE 34: )
         ^

[0m02:45:35.115938 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m02:45:35.116939 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.116939 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:45:35.117937 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  error de sintaxis en o cerca de «)»
  LINE 34: )
           ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:45:35.118938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009303E20>]}
[0m02:45:35.119936 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.09s]
[0m02:45:35.120935 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:45:35.121934 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:35.122934 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:45:35.123934 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.124934 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:35.124934 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:35.129929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.130929 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.130929 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:35.136926 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.138925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.138925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:45:35.139924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.195892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:35.195892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.196894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:45:35.219879 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:45:35.223876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.224875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:45:35.225875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.228873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.229872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:45:35.230873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.233872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:45:35.234871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.234871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:45:35.236869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.239867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:35.239867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:45:35.244263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:35.246261 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.246261 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:45:35.247260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0093005E0>]}
[0m02:45:35.248259 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.12s]
[0m02:45:35.250258 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:35.251259 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:35.251259 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:45:35.252257 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.253257 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:35.254256 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:35.259253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.261252 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.261252 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:35.268247 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.271251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.272247 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:45:35.273245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.330212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:35.330212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.331213 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:45:35.359052 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:45:35.363049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.363049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:45:35.364050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.367047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.368046 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:45:35.369047 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.372045 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:45:35.373044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.373044 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:45:35.375827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.378827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:35.378827 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:45:35.383022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:35.385022 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.386021 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:45:35.387023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009311480>]}
[0m02:45:35.388022 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.13s]
[0m02:45:35.390019 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:35.390019 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:35.391018 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:45:35.393018 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.394017 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:35.394017 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:35.401015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.402014 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.404017 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:35.414033 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.416010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.417005 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:45:35.417005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.473971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:35.474972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.475971 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:45:35.499969 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:35.504967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.504967 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:45:35.505967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.509963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.509963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:45:35.510962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.514961 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:45:35.514961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.515960 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:45:35.558149 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m02:45:35.565163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:35.566163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:45:35.577092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:35.581077 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.583076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:45:35.585075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009433FD0>]}
[0m02:45:35.587074 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.19s]
[0m02:45:35.591906 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:35.593905 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:45:35.595904 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:45:35.599900 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.612891 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:45:35.612891 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:45:35.619887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.622887 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.622887 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:45:35.637885 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.639876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.640876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:45:35.642875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.697842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:35.698842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.698842 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:45:35.721724 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:35.724723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.725722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:45:35.726723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.730720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.730720 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:45:35.731719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.734718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:45:35.735717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.735717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:45:35.738402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.741405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:35.741405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:45:35.746074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:35.748073 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.749072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:45:35.750071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00945C130>]}
[0m02:45:35.751071 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.15s]
[0m02:45:35.753070 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:45:35.754069 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:35.755067 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:45:35.756068 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.757067 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:35.758069 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:45:35.764064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.766063 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.766063 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:35.774057 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.776059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.777057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:45:35.777057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.833023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:35.833023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.834023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:45:35.862564 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:45:35.868561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.868561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:45:35.870560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.873558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.874557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:45:35.875558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:35.879556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:45:35.879556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.880554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:45:35.882553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:35.885552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:35.886553 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:45:35.892547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:35.895546 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.895546 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:45:35.897545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0092EE980>]}
[0m02:45:35.898546 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:45:35.899543 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:35.900543 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:45:35.901543 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:45:35.903542 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:35.904540 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:45:35.904540 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:45:35.911538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:35.913537 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:35.913537 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:45:35.926530 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:35.928527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:35.929528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:45:35.929528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:35.987495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:35.988493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:35.988493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:45:36.013479 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:36.017475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:36.017475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:45:36.018476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.024472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:36.024472 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:45:36.025471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.030468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:45:36.030468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:36.031469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:45:36.033466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:36.035465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:36.036465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:45:36.041463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:36.043462 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.044460 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:45:36.046460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0093110C0>]}
[0m02:45:36.047461 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.14s]
[0m02:45:36.049459 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:45:36.049459 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:45:36.050457 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:45:36.052456 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.053456 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:45:36.053456 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:45:36.062452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.064449 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.064449 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:45:36.076442 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.078443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.079441 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:45:36.079441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:36.134409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:36.135409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.135409 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:45:36.196373 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.06 seconds
[0m02:45:36.200372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.201371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:45:36.202370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.207368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.208368 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:45:36.209366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.213365 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:45:36.214365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.215364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:45:36.217206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:36.220207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:36.220207 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:45:36.224241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:36.226239 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.226239 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:45:36.227238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009310FD0>]}
[0m02:45:36.228238 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.18s]
[0m02:45:36.230237 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:45:36.231236 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:45:36.231236 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:45:36.233236 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.234235 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:45:36.234235 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:45:36.250227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.252224 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.255229 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:45:36.265219 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.267216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.267216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:45:36.268216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:36.316187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:36.316187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.317187 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:45:36.356388 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:45:36.363384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.363384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:45:36.364382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.410371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.411371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:45:36.412371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:36.416355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:45:36.416355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.417355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:45:36.419353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:36.422351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:36.422351 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:45:36.426474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:36.428477 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.428477 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:45:36.429461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0090DE530>]}
[0m02:45:36.430463 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.20s]
[0m02:45:36.432459 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:45:36.433459 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:45:36.433459 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:45:36.435458 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:36.436458 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:45:36.437457 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:45:36.443463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:36.445452 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:36.445452 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:45:36.450464 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:36.452448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:36.453448 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:45:36.454458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:36.514412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:36.514412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:36.515413 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:45:37.094101 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.58 seconds
[0m02:45:37.097100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:37.097100 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:45:37.098099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:37.101098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:37.102097 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:45:37.103076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:37.106095 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:45:37.107073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:37.107073 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:45:37.108981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:37.110991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:37.111969 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:45:37.116093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:37.118114 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:37.118114 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:45:37.119094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0094935B0>]}
[0m02:45:37.120094 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.68s]
[0m02:45:37.122092 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:45:37.123094 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:45:37.123094 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:45:37.125092 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.126092 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:45:37.126092 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:45:37.130109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.131089 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:37.131089 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:45:37.137086 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.138083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.139082 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:45:37.140082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:37.196062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:37.197060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.197060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:45:37.213215 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:45:37.218210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.218210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:45:37.220210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:37.224207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.224207 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:45:37.225207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:37.228205 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:45:37.229204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.229204 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:45:37.231203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:37.234203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:37.235201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:45:37.240197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:37.242198 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:37.242198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:45:37.243196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3183b6e9-de65-4117-a9ba-802d847d88de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0093F75E0>]}
[0m02:45:37.245196 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.12s]
[0m02:45:37.247195 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:45:37.249195 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:45:37.250195 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:37.251192 [debug] [MainThread]: On master: BEGIN
[0m02:45:37.251192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:37.315155 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m02:45:37.316155 [debug] [MainThread]: On master: COMMIT
[0m02:45:37.317155 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:37.317155 [debug] [MainThread]: On master: COMMIT
[0m02:45:37.318154 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:37.319153 [debug] [MainThread]: On master: Close
[0m02:45:37.321153 [info ] [MainThread]: 
[0m02:45:37.322152 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m02:45:37.324150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:37.325150 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:45:37.326149 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m02:45:37.326149 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:45:37.348137 [info ] [MainThread]: 
[0m02:45:37.349139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:45:37.351135 [info ] [MainThread]: 
[0m02:45:37.353134 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m02:45:37.356133 [error] [MainThread]:   error de sintaxis en o cerca de «)»
[0m02:45:37.358131 [error] [MainThread]:   LINE 34: )
[0m02:45:37.360130 [error] [MainThread]:            ^
[0m02:45:37.361130 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:45:37.363129 [info ] [MainThread]: 
[0m02:45:37.364127 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m02:45:37.367132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00944AE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00944A800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E009418DC0>]}


============================== 2022-11-23 02:45:50.957245 | 4d394781-8aa5-48d5-acfe-d117051291ca ==============================
[0m02:45:50.957245 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:45:50.958496 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:45:50.958496 [debug] [MainThread]: Tracking: tracking
[0m02:45:50.973493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECA54E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECA7C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECA7C790>]}
[0m02:45:51.079376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:45:51.080376 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:45:51.095374 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:45:51.117094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:45:51.128115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECC0E050>]}
[0m02:45:51.143083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECBABFD0>]}
[0m02:45:51.144092 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:45:51.145090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECA54E20>]}
[0m02:45:51.148077 [info ] [MainThread]: 
[0m02:45:51.150093 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:45:51.154095 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:51.174097 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:51.175084 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:51.176081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:51.240551 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:45:51.242550 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:51.243534 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:51.245548 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:51.246548 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:51.246548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:51.289507 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:45:51.291518 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:51.292516 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:45:51.296519 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:45:51.296519 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:45:51.296519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:51.337480 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:45:51.338481 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:45:51.341480 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:51.349474 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:51.349474 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:45:51.350473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:51.389451 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:51.389451 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:45:51.390452 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:45:51.397457 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:45:51.399456 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:45:51.400459 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:45:51.401443 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:51.405442 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:51.405442 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:45:51.406441 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:51.444419 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:51.445419 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:45:51.445419 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:45:51.452415 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:45:51.454414 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:45:51.455413 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:45:51.456412 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:51.459412 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:51.459412 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:45:51.460411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:45:51.498837 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:45:51.499846 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:45:51.500837 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:45:51.508831 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:45:51.510831 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:45:51.511829 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:45:51.518841 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:51.519826 [debug] [MainThread]: On master: BEGIN
[0m02:45:51.519826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:51.559804 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:45:51.560801 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:51.561801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:45:51.636758 [debug] [MainThread]: SQL status: SELECT 0 in 0.07 seconds
[0m02:45:51.638758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECA15630>]}
[0m02:45:51.639757 [debug] [MainThread]: On master: ROLLBACK
[0m02:45:51.640756 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:51.640756 [debug] [MainThread]: On master: BEGIN
[0m02:45:51.641755 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:51.641755 [debug] [MainThread]: On master: COMMIT
[0m02:45:51.642755 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:51.642755 [debug] [MainThread]: On master: COMMIT
[0m02:45:51.643754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:51.643754 [debug] [MainThread]: On master: Close
[0m02:45:51.644754 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:51.646757 [info ] [MainThread]: 
[0m02:45:51.656748 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:45:51.658747 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:45:51.662746 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.663744 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:45:51.664742 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:45:51.673739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.675738 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:51.676736 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:45:51.774681 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.776678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.776678 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:45:51.777677 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:45:51.825650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:51.826653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.826653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:45:51.845640 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.02 seconds
[0m02:45:51.857632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.858631 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:45:51.859632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:51.866626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.866626 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:45:51.867626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:51.899607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:45:51.900607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.900607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:45:51.902608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:51.911601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:45:51.911601 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:45:51.915887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:51.917887 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:51.917887 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:45:51.918886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECD12110>]}
[0m02:45:51.919884 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.26s]
[0m02:45:51.921884 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:45:51.921884 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:45:51.922883 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:45:51.923882 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:51.924883 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:45:51.925881 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:45:51.931877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:45:51.933876 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:51.934875 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:45:51.942871 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:45:51.944870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:51.945871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:45:51.946878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:51.996841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:51.997839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:51.997839 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:45:52.008595 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:45:52.012593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:52.013592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:45:52.014591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.018589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:52.018589 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:45:52.019589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.022587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:45:52.023586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:52.023586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:45:52.025586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.027585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:45:52.028584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:45:52.032439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:52.034437 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.034437 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:45:52.035437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECD05D80>]}
[0m02:45:52.036435 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m02:45:52.038434 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:45:52.039435 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:45:52.040434 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:45:52.041432 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.042432 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:45:52.042432 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:45:52.047443 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:45:52.048428 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.049430 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:45:52.057438 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:45:52.060422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.060422 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:45:52.061421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.116391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:52.117389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.117389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:45:52.137184 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:52.143181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.143181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:45:52.144180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.147180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.148180 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:45:52.149178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.152176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:45:52.153175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.154176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:45:52.156561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.159563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:45:52.159563 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:45:52.166029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:52.168028 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.168028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:45:52.169026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECD65180>]}
[0m02:45:52.170026 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:45:52.172025 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:45:52.172025 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:45:52.173024 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:45:52.175024 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.176024 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:45:52.177023 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:45:52.188028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.190016 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.191015 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:45:52.200010 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.202008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.202008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:45:52.202008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.248982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:52.248982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.249981 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
)

select * from profiled_data
  );
[0m02:45:52.370661 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m02:45:52.373661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.374679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:45:52.375657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.379658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.379658 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:45:52.380655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.384653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:45:52.385652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.385652 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:45:52.389360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.392360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:45:52.392360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:45:52.398566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:52.399582 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.400585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:45:52.401564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECBB62F0>]}
[0m02:45:52.402565 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.23s]
[0m02:45:52.404562 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:45:52.404562 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:52.405582 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:45:52.406581 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.407560 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:52.408559 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:52.414577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.415576 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.416576 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:52.425552 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.426550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.427548 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:45:52.428548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.484533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:52.485515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.485515 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:45:52.516224 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.03 seconds
[0m02:45:52.519238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.520237 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:45:52.521237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.525234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.526233 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:45:52.527218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.531218 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:45:52.531218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.532215 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:45:52.533866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.536867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:45:52.536867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:45:52.541801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:52.543816 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.544815 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:45:52.545799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECD97F70>]}
[0m02:45:52.545799 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.14s]
[0m02:45:52.547798 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:45:52.548798 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:52.548798 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:45:52.550797 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.551797 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:52.552796 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:52.559806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.560792 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.561791 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:52.568788 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.571793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.571793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:45:52.572801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.626764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:52.627768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.627768 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:45:52.655747 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:45:52.659734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.659734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:45:52.660734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.663732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.664731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:45:52.665732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.668729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:45:52.669728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.670728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:45:52.672818 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.675819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:45:52.675819 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:45:52.683671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:52.685661 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.685661 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:45:52.687658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECC7C850>]}
[0m02:45:52.688660 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.14s]
[0m02:45:52.690045 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:45:52.691048 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:52.692049 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:45:52.693046 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.694062 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:52.694062 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:52.699045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.701043 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.704043 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:52.714045 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.715034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.716034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:45:52.716034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.768194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:52.768194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.769191 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:45:52.795973 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:45:52.799971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.800971 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:45:52.801971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.807967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.807967 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:45:52.808968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.812964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:45:52.812964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.813963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:45:52.845258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:45:52.848274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:45:52.848274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:45:52.853500 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:52.856501 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.856501 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:45:52.857498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECDB7EB0>]}
[0m02:45:52.858497 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.16s]
[0m02:45:52.860496 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:45:52.860496 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:45:52.861511 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:45:52.862495 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.863496 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:45:52.864495 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:45:52.868491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.870491 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:52.871492 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:45:52.883485 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.884495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.885482 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:45:52.885482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:52.947453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:52.948447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.948447 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:45:52.975432 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:45:52.979427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.979427 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:45:52.980427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.986424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.986424 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:45:52.987426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:52.992420 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:45:52.993420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.993420 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:45:52.995421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:52.998417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:45:52.998417 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:45:53.006413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:53.008414 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.009411 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:45:53.010411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECDC8520>]}
[0m02:45:53.011410 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.15s]
[0m02:45:53.015408 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:45:53.017407 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:53.021407 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:45:53.024403 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.025402 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:53.026404 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:45:53.031401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.032397 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.033398 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:53.041393 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.043391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.043391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:45:53.044391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:53.102359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:53.103358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.104358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:45:53.133339 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:45:53.138337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.139337 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:45:53.140338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.144334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.145333 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:45:53.146332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.150330 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:45:53.150330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.151331 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:45:53.153329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:53.158327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:45:53.158327 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:45:53.165322 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:53.167321 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.168320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:45:53.169321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECDD3D00>]}
[0m02:45:53.170319 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:45:53.172318 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:45:53.173318 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:45:53.174317 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:45:53.176317 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.177316 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:45:53.177316 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:45:53.186310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.188309 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.189308 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:45:53.201304 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.203301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.204307 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:45:53.205300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:53.262267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:53.262267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.263268 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:45:53.328795 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.07 seconds
[0m02:45:53.332792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.333791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:45:53.334791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.337789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.337789 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:45:53.338789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.342787 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:45:53.342787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.342787 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:45:53.345155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:53.348156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:45:53.348156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:45:53.353844 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:53.355843 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.355843 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:45:53.356843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECDE6D40>]}
[0m02:45:53.357842 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.18s]
[0m02:45:53.359840 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:45:53.359840 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:45:53.360841 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:45:53.361839 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.362839 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:45:53.362839 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:45:53.371841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.375832 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.376830 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:45:53.384825 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.387832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.389829 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:45:53.390823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:53.442793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:53.443793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.443793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:45:53.466778 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:45:53.470778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.471776 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:45:53.472776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.476772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.476772 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:45:53.477772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.483769 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:45:53.483769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.484769 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:45:53.486768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:53.490765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:45:53.491764 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:45:53.497763 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:53.499760 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.499760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:45:53.500760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECE152A0>]}
[0m02:45:53.501760 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.14s]
[0m02:45:53.503759 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:45:53.504758 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:45:53.505757 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:45:53.507756 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.508756 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:45:53.509755 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:45:53.589709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.590709 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.591707 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:45:53.596705 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.597706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.597706 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:45:53.598705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:53.638683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:45:53.638683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.639682 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:45:53.673660 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:45:53.678658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.679657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:45:53.679657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.684655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.685654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:45:53.686653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:53.690651 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:45:53.690651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.691651 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:45:53.693649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:53.697647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:45:53.698646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:45:53.705643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:53.707644 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.708641 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:45:53.710640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECE06D70>]}
[0m02:45:53.711641 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.20s]
[0m02:45:53.713639 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:45:53.713639 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:45:53.714639 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:45:53.716637 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:53.717639 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:45:53.718636 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:45:53.728629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:53.730630 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:53.731629 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:45:53.738624 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:53.740623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:53.740623 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:45:53.741622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:53.789595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:45:53.789595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:53.790594 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:45:54.328422 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.54 seconds
[0m02:45:54.332420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:54.333420 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:45:54.334419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:54.337417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:54.338417 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:45:54.339417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:54.342415 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:45:54.343414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:54.343414 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:45:54.345413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:54.349413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:45:54.349413 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:45:54.357406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:54.360404 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:54.360404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:45:54.361404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4EC9DBDF0>]}
[0m02:45:54.362404 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.64s]
[0m02:45:54.364402 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:45:54.365402 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:45:54.366401 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:45:54.368402 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.368402 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:45:54.369400 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:45:54.379396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.380393 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:54.381393 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:45:54.390388 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.391387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.392386 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:45:54.392386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:45:54.454357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:45:54.455353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.456350 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:45:54.478339 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:45:54.485335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.486333 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:45:54.487333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:54.494328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.495328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:45:54.496328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:54.502324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:45:54.503323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.503323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:45:54.505322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:45:54.509321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:45:54.509321 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:45:54.517317 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:45:54.520313 [debug] [Thread-1 (]: finished collecting timing info
[0m02:45:54.521313 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:45:54.522312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d394781-8aa5-48d5-acfe-d117051291ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECDCB1F0>]}
[0m02:45:54.524311 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.15s]
[0m02:45:54.527310 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:45:54.530308 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:45:54.530308 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:54.531307 [debug] [MainThread]: On master: BEGIN
[0m02:45:54.531307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:54.605271 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m02:45:54.606265 [debug] [MainThread]: On master: COMMIT
[0m02:45:54.606265 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:54.607264 [debug] [MainThread]: On master: COMMIT
[0m02:45:54.608264 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:54.608264 [debug] [MainThread]: On master: Close
[0m02:45:54.610263 [info ] [MainThread]: 
[0m02:45:54.611265 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m02:45:54.612262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:54.613261 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:45:54.614260 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m02:45:54.614260 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:45:54.635248 [info ] [MainThread]: 
[0m02:45:54.637248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:45:54.640246 [info ] [MainThread]: 
[0m02:45:54.645243 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:45:54.647243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4EC91C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4EC91C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D4ECBEAF20>]}


============================== 2022-11-23 02:46:46.022886 | 4275d403-e467-4956-a483-dd77ae778ef5 ==============================
[0m02:46:46.022886 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:46:46.023885 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m02:46:46.023885 [debug] [MainThread]: Tracking: tracking
[0m02:46:46.049873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4D4F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4D4C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4D4F490>]}
[0m02:46:46.183795 [debug] [MainThread]: Executing "git --help"
[0m02:46:46.258669 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:46:46.259667 [debug] [MainThread]: STDERR: "b''"
[0m02:46:46.264673 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m02:46:46.265667 [debug] [MainThread]: Using postgres connection "debug"
[0m02:46:46.265667 [debug] [MainThread]: On debug: select 1 as id
[0m02:46:46.266663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:46:46.345618 [debug] [MainThread]: SQL status: SELECT 1 in 0.08 seconds
[0m02:46:46.347620 [debug] [MainThread]: On debug: Close
[0m02:46:46.349616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4E94700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4EBC460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219B4EBC910>]}
[0m02:46:47.012648 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-23 02:46:54.301687 | f76c13e5-c223-4db3-84c7-cce2af74d08c ==============================
[0m02:46:54.301687 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:46:54.302687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:46:54.303666 [debug] [MainThread]: Tracking: tracking
[0m02:46:54.321656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983670520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983670A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199836707F0>]}
[0m02:46:54.421615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:46:54.422599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:46:54.423597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:46:54.437561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199837DFEE0>]}
[0m02:46:54.455553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998372AB90>]}
[0m02:46:54.456544 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:46:54.458543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998372AAD0>]}
[0m02:46:54.463541 [info ] [MainThread]: 
[0m02:46:54.467538 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:46:54.474535 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:46:54.501519 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:46:54.502518 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:46:54.504520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:46:54.574478 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.07 seconds
[0m02:46:54.576477 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:46:54.577476 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:46:54.580474 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:46:54.581472 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:46:54.581472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:54.619452 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:46:54.621450 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:46:54.622449 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:46:54.625447 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:46:54.626448 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:46:54.626448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:54.665426 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:46:54.667425 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:46:54.670422 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:46:54.679417 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:46:54.680416 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:46:54.680416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:46:54.720395 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:46:54.721394 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:46:54.721394 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:46:54.728390 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:46:54.731387 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:46:54.731387 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:46:54.733386 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:46:54.738382 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:46:54.738382 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:46:54.739383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:54.777361 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:46:54.777361 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:46:54.778360 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:46:54.787355 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:46:54.789354 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:46:54.790353 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:46:54.791353 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:46:54.795352 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:46:54.795352 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:46:54.796350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:46:54.973095 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m02:46:54.974094 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:46:54.974094 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:46:54.985900 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:46:54.987918 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:46:54.988916 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:46:54.996894 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:54.997893 [debug] [MainThread]: On master: BEGIN
[0m02:46:54.998895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:46:55.041029 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:46:55.041029 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:55.042030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:46:55.090192 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:46:55.093191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998379B7C0>]}
[0m02:46:55.093191 [debug] [MainThread]: On master: ROLLBACK
[0m02:46:55.094191 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:55.095190 [debug] [MainThread]: On master: BEGIN
[0m02:46:55.095190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:46:55.096190 [debug] [MainThread]: On master: COMMIT
[0m02:46:55.096190 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:55.097189 [debug] [MainThread]: On master: COMMIT
[0m02:46:55.097189 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:46:55.098188 [debug] [MainThread]: On master: Close
[0m02:46:55.098188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:46:55.100112 [info ] [MainThread]: 
[0m02:46:55.109111 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:46:55.110110 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:46:55.112110 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.113109 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:46:55.114109 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:46:55.119125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.121106 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.121106 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:46:55.209054 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.211052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.211052 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:46:55.212052 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:46:55.260023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:55.261024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.262024 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:46:55.279012 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.02 seconds
[0m02:46:55.291006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.291006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:46:55.292007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.296004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.297004 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:46:55.298003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.330983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:46:55.331982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.331982 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:46:55.352972 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:46:55.363964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:46:55.363964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:46:55.368962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:55.370961 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.370961 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:46:55.372960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998381E380>]}
[0m02:46:55.373960 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.26s]
[0m02:46:55.374958 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:46:55.375959 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:46:55.376958 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:46:55.377956 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.378957 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:46:55.379955 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:46:55.386952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.388950 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.389950 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:46:55.400944 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.404944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.405942 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:46:55.406943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:55.466906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:46:55.466906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.467905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:46:55.481897 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:46:55.485894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.486894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:46:55.487895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.495889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.495889 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:46:55.496890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.501886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:46:55.502885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.503884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:46:55.504884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:55.509880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:46:55.509880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:46:55.514877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:55.516876 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.516876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:46:55.517876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199838E8970>]}
[0m02:46:55.518876 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.14s]
[0m02:46:55.520874 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:46:55.521874 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:46:55.522875 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:46:55.523875 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.523875 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:46:55.524873 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:46:55.529870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:46:55.531868 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.531868 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:46:55.537866 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:46:55.539864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.539864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:46:55.540865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:55.594833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:55.595832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.595832 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:46:55.614810 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:46:55.619809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.620806 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:46:55.621814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.625805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.625805 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:46:55.626805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.629802 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:46:55.630800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.630800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:46:55.633510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:55.636511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:46:55.637510 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:46:55.642913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:55.644914 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.645913 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:46:55.646913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199838F8910>]}
[0m02:46:55.647911 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.12s]
[0m02:46:55.648911 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:46:55.649910 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:46:55.649910 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:46:55.651910 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.651910 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:46:55.652908 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:46:55.660903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.661903 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.662902 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:46:55.668899 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.673896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.673896 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:46:55.674895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:55.744855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m02:46:55.745855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.745855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
)

select * from profiled_data
  );
[0m02:46:55.837403 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.09 seconds
[0m02:46:55.841415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.841415 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:46:55.842400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.845412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.846396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:46:55.847396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.850394 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:46:55.850394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.851393 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:46:55.853393 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:55.858404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:46:55.858404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:46:55.864641 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:55.866643 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.867642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:46:55.868639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983920A30>]}
[0m02:46:55.869640 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.22s]
[0m02:46:55.871638 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:46:55.871638 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:46:55.872640 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:46:55.873636 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.874651 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:46:55.874651 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:46:55.880632 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.881633 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:55.883631 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:46:55.895624 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.896623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.896623 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:46:55.897622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:55.950595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:55.950595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.951592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:46:55.976431 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:46:55.980428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.981428 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:46:55.981428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.985426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.985426 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:46:55.987424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:55.990423 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:46:55.991422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:55.991422 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:46:56.012845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:46:56.015842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:46:56.015842 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:46:56.022214 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:56.024229 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.024229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:46:56.025215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998393EA40>]}
[0m02:46:56.026213 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.15s]
[0m02:46:56.028214 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:46:56.028214 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:46:56.029227 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:46:56.030226 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.031210 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:46:56.031210 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:46:56.037207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.041209 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.042205 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:46:56.057208 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.059195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.060194 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:46:56.060194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.111164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:56.112165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.112165 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:46:56.138720 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:46:56.142717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.143718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:46:56.143718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.147714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.147714 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:46:56.148713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.152711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:46:56.153710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.154710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:46:56.156988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:56.160987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:46:56.161987 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:46:56.167537 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:56.169526 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.170525 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:46:56.171540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983833520>]}
[0m02:46:56.172539 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.14s]
[0m02:46:56.173525 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:46:56.174534 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:46:56.175522 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:46:56.177523 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.178521 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:46:56.178521 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:46:56.184519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.186517 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.188515 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:46:56.197512 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.199513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.200508 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:46:56.200508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.250479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:56.251479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.251479 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:46:56.276202 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:46:56.280202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.280202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:46:56.281200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.285198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.286197 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:46:56.287197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.290194 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:46:56.290194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.291195 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:46:56.293309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:56.295310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:46:56.296309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:46:56.301458 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:56.303457 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.304455 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:46:56.305456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998383F2B0>]}
[0m02:46:56.306455 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.13s]
[0m02:46:56.307454 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:46:56.308453 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:46:56.309454 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:46:56.310454 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.311452 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:46:56.312453 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:46:56.318448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.319463 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.320446 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:46:56.330444 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.333451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.333451 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:46:56.334451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.390408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:46:56.391407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.391407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:46:56.414417 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:46:56.417415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.418415 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:46:56.419416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.422413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.423412 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:46:56.424413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.427410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:46:56.427410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.428410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:46:56.449412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:46:56.452085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:46:56.453084 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:46:56.457799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:56.459798 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.460797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:46:56.461797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983865060>]}
[0m02:46:56.462797 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.15s]
[0m02:46:56.463796 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:46:56.464811 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:46:56.465796 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:46:56.467795 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.468793 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:46:56.468793 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:46:56.478803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.479786 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.480787 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:46:56.488783 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.489781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.490781 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:46:56.491780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.543750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:56.544749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.544749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:46:56.568736 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:46:56.572733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.573734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:46:56.574732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.579729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.580729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:46:56.581732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.584727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:46:56.585726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.585726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:46:56.587725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:56.592722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:46:56.592722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:46:56.598718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:56.600717 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.601716 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:46:56.602716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983970CA0>]}
[0m02:46:56.603716 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:46:56.605715 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:46:56.605715 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:46:56.606715 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:46:56.608713 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.609712 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:46:56.609712 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:46:56.616708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.617707 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.618707 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:46:56.630702 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.632700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.633700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:46:56.634699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.695666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:46:56.696664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.697662 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:46:56.724647 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:46:56.728644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.729644 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:46:56.730644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.733641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.734641 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:46:56.735640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.739639 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:46:56.740637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.740637 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:46:56.742636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:56.746635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:46:56.746635 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:46:56.752630 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:56.755628 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.755628 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:46:56.757627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983815AB0>]}
[0m02:46:56.758627 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.15s]
[0m02:46:56.760626 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:46:56.761625 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:46:56.762625 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:46:56.764624 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.765625 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:46:56.766623 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:46:56.778615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.780614 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.781615 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:46:56.794607 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.798606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.799605 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:46:56.800603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:56.871563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m02:46:56.872562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.872562 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:46:56.896547 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:46:56.901546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.902544 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:46:56.903544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.906542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.907541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:46:56.908541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:56.912539 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:46:56.912539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.913540 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:46:56.915538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:56.918535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:46:56.918535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:46:56.924325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:56.926323 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.927322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:46:56.927322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019983864DC0>]}
[0m02:46:56.928322 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.16s]
[0m02:46:56.930320 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:46:56.931322 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:46:56.931322 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:46:56.933320 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:56.933320 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:46:56.934318 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:46:56.946312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:46:56.948312 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:56.948312 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:46:56.956308 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:46:56.957306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:56.958304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:46:56.958304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:57.011274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:46:57.011274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:57.012274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:46:57.049087 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:46:57.053085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:57.053085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:46:57.054086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:57.058083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:57.058083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:46:57.060081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:57.064080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:46:57.065081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:57.066079 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:46:57.087668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:46:57.089669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:46:57.090668 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:46:57.095455 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:46:57.097455 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:57.098454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:46:57.098454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199838EACB0>]}
[0m02:46:57.099454 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.17s]
[0m02:46:57.101454 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:46:57.101454 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:46:57.102453 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:46:57.104452 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:57.104452 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:46:57.105451 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:46:57.109449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:57.110449 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:57.111447 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:46:57.180409 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:57.181509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:57.181509 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:46:57.182527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:57.221501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:46:57.221501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:57.222491 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:46:58.140568 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.92 seconds
[0m02:46:58.147565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:58.148565 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:46:58.149563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:58.157560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:58.158560 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:46:58.160557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:58.165554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:46:58.166552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:58.166552 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:46:58.169551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:58.175547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:46:58.176549 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:46:58.184543 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:58.187542 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:58.188541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:46:58.189540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199839C4670>]}
[0m02:46:58.190539 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 1.09s]
[0m02:46:58.193538 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:46:58.194537 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:46:58.195536 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:46:58.197536 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.198536 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:46:58.199534 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:46:58.207531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.209528 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:58.210528 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:46:58.225519 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.227518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.228517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:46:58.228517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:46:58.328461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m02:46:58.329461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.330460 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:46:58.395423 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.06 seconds
[0m02:46:58.404418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.405417 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:46:58.407415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:58.413412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.414412 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:46:58.415411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:46:58.422408 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:46:58.423411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.424406 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:46:58.427405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:46:58.434401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:46:58.435400 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:46:58.447393 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:46:58.450390 [debug] [Thread-1 (]: finished collecting timing info
[0m02:46:58.451390 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:46:58.453396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76c13e5-c223-4db3-84c7-cce2af74d08c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001998398B5E0>]}
[0m02:46:58.456387 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.25s]
[0m02:46:58.459386 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:46:58.462386 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:46:58.463384 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:58.464383 [debug] [MainThread]: On master: BEGIN
[0m02:46:58.465382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:46:58.644282 [debug] [MainThread]: SQL status: BEGIN in 0.18 seconds
[0m02:46:58.645279 [debug] [MainThread]: On master: COMMIT
[0m02:46:58.646279 [debug] [MainThread]: Using postgres connection "master"
[0m02:46:58.647278 [debug] [MainThread]: On master: COMMIT
[0m02:46:58.648277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:46:58.648277 [debug] [MainThread]: On master: Close
[0m02:46:58.650276 [info ] [MainThread]: 
[0m02:46:58.651276 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m02:46:58.655275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:46:58.656274 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:46:58.656274 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m02:46:58.657272 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:46:58.682258 [info ] [MainThread]: 
[0m02:46:58.684257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:46:58.701247 [info ] [MainThread]: 
[0m02:46:58.745223 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:46:58.757216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199839BEC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199839BF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199839BF790>]}


============================== 2022-11-23 02:47:35.612091 | 207ac617-d86a-47d0-8967-b277324ec91c ==============================
[0m02:47:35.612091 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:47:35.614089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:47:35.615089 [debug] [MainThread]: Tracking: tracking
[0m02:47:35.641075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14F20520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14F20A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14F20790>]}
[0m02:47:35.763006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:47:35.764005 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:47:35.781994 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:47:35.815974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:47:35.831966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E150AE0B0>]}
[0m02:47:35.852953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E1504BEE0>]}
[0m02:47:35.853957 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:47:35.856952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15049390>]}
[0m02:47:35.860951 [info ] [MainThread]: 
[0m02:47:35.862950 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:47:35.865945 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:47:35.884936 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:47:35.884936 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:47:35.885935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:35.946900 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:47:35.948898 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:47:35.949897 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:47:35.952896 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:47:35.952896 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:47:35.953896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:35.994872 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:47:35.996871 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:47:35.997871 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:47:36.001868 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:47:36.001868 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:47:36.001868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:36.044846 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:47:36.045845 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:47:36.048841 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:47:36.056837 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:47:36.057838 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:47:36.057838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:36.096817 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:47:36.097813 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:47:36.097813 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:47:36.105810 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:47:36.107807 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:47:36.108806 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:47:36.109806 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:47:36.112807 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:47:36.113806 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:47:36.113806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:36.153786 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:47:36.153786 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:47:36.154782 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:47:36.161780 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:47:36.163777 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:47:36.164775 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:47:36.165775 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:47:36.168775 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:47:36.168775 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:47:36.169772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:36.209749 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:47:36.210748 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:47:36.210748 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:47:36.218744 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:47:36.221743 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:47:36.221743 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:47:36.228739 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:36.229740 [debug] [MainThread]: On master: BEGIN
[0m02:47:36.229740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:36.269717 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:47:36.270717 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:36.271714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:36.323699 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:47:36.325685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15069780>]}
[0m02:47:36.326685 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:36.327681 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:36.327681 [debug] [MainThread]: On master: BEGIN
[0m02:47:36.328682 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:36.328682 [debug] [MainThread]: On master: COMMIT
[0m02:47:36.329680 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:36.329680 [debug] [MainThread]: On master: COMMIT
[0m02:47:36.330682 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:36.330682 [debug] [MainThread]: On master: Close
[0m02:47:36.331682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:36.332679 [info ] [MainThread]: 
[0m02:47:36.340677 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:47:36.340677 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:47:36.342675 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.343672 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:47:36.343672 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:47:36.352667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.354668 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.355671 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:47:36.417630 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.419629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.419629 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:47:36.420628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:47:36.460974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:47:36.460974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.461977 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:47:36.476157 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:47:36.485151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.486150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:47:36.487152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.492148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.492148 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:47:36.493147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.522129 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:47:36.522129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.523129 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:47:36.524568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:36.529588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:47:36.530588 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:47:36.534565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:36.536584 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.537563 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:47:36.538562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E151B1FC0>]}
[0m02:47:36.538562 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.19s]
[0m02:47:36.540561 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:47:36.541582 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:47:36.542560 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:47:36.543560 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.544560 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:47:36.545560 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:47:36.551576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.553554 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.554554 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:47:36.565550 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.568545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.569545 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:47:36.570546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:36.618516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:36.619518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.619518 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:47:36.630509 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:47:36.634508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.634508 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:47:36.635507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.639505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.639505 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:47:36.640504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.644502 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:47:36.644502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.645501 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:47:36.646777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:36.649779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:47:36.649779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:47:36.653924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:36.655924 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.656922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:47:36.657922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E151A5C30>]}
[0m02:47:36.658922 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m02:47:36.660921 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:47:36.661920 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:47:36.661920 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:47:36.663921 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.664919 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:47:36.665918 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:47:36.675911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:47:36.677910 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.678910 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:47:36.690904 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:47:36.692902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.692902 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:47:36.693902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:36.744872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:36.745871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.745871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:47:36.764627 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:36.770624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.771624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:47:36.772623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.775621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.776620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:47:36.777620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.780618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:47:36.780618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.781618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:47:36.783641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:36.786642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:47:36.786642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:47:36.790814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:36.792814 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.792814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:47:36.793813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15205180>]}
[0m02:47:36.794813 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:47:36.796811 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:47:36.797811 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:47:36.798810 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:47:36.800809 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.800809 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:47:36.801808 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:47:36.811803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.812803 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:36.813803 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:47:36.818799 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.821803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.822796 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:47:36.822796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:36.878765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:47:36.878765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.879765 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:47:36.981707 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m02:47:36.985703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.985703 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:47:36.986704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.990701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.990701 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:47:36.992700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:36.996697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:47:36.996697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:36.997696 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:47:37.030680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:47:37.033676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:47:37.034675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:47:37.039672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.041671 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.041671 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:47:37.042671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E151E3E20>]}
[0m02:47:37.044670 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.24s]
[0m02:47:37.045670 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:47:37.046670 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:47:37.047668 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:47:37.049668 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.049668 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:47:37.050667 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:47:37.057663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.059662 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.060661 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:47:37.073656 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.075653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.075653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:47:37.076651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.131622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.132620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.133619 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:47:37.163601 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.03 seconds
[0m02:47:37.167599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.168599 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:47:37.169599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.175595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.175595 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:47:37.176594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.180591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:47:37.180591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.181592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:47:37.183157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:37.186158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:47:37.186158 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:47:37.191155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.193155 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.194153 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:47:37.195154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15237FD0>]}
[0m02:47:37.195154 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.15s]
[0m02:47:37.197152 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:47:37.198151 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:47:37.199151 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:47:37.201150 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.201150 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:47:37.202149 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:47:37.211145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.213142 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.213142 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:47:37.220139 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.225140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.226135 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:47:37.227136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.282106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.283102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.284102 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:47:37.315083 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:47:37.320083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.321082 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:47:37.322081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.325080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.326079 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:47:37.327077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.330077 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:47:37.331076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.331076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:47:37.333718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:37.335720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:47:37.336719 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:47:37.340930 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.342930 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.343927 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:47:37.344928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15119000>]}
[0m02:47:37.344928 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.14s]
[0m02:47:37.346927 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:47:37.347926 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:47:37.347926 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:47:37.349925 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.350925 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:47:37.350925 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:47:37.358920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.361918 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.393752 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:47:37.399751 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.401750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.401750 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:47:37.402750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.450725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.450725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.451721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:47:37.474765 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:37.478765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.478765 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:47:37.479762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.485760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.485760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:47:37.486760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.490756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:47:37.490756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.491756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:47:37.493492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:37.495494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:47:37.496493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:47:37.500403 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.502403 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.502403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:47:37.504403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15257F10>]}
[0m02:47:37.505402 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.16s]
[0m02:47:37.507400 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:47:37.507400 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:47:37.508399 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:47:37.510398 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.510398 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:47:37.511398 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:47:37.515395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.517394 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.517394 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:47:37.526388 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.528389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.529389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:47:37.530388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.582356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.583357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.584355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:47:37.606684 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:37.610682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.610682 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:47:37.611682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.615680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.615680 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:47:37.616679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.619679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:47:37.620678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.621676 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:47:37.622676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:37.626675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:47:37.626675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:47:37.631671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.633670 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.633670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:47:37.634669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15268580>]}
[0m02:47:37.635668 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.13s]
[0m02:47:37.638667 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:47:37.639668 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:47:37.640667 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:47:37.642665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.643664 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:47:37.644664 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:47:37.650661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.651659 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.652661 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:47:37.661653 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.662653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.663653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:47:37.664652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.714623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.715624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.715624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:47:37.738610 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:37.742607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.743607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:47:37.743607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.747604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.747604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:47:37.748603 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.751602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:47:37.752601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.752601 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:47:37.755011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:37.759010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:47:37.760009 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:47:37.763997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.765996 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.765996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:47:37.766995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15273D60>]}
[0m02:47:37.767996 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.12s]
[0m02:47:37.769993 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:47:37.770993 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:47:37.771992 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:47:37.773992 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.774991 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:47:37.775991 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:47:37.781987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.782986 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.783986 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:47:37.793982 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.794980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.795978 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:47:37.795978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:37.845950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:37.846950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.846950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:47:37.868984 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:37.872982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.873981 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:47:37.873981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.877979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.877979 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:47:37.878978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:37.881977 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:47:37.882976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.882976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:47:37.918261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:47:37.921277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:47:37.922260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:47:37.926514 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:37.928524 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.928524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:47:37.929528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15288040>]}
[0m02:47:37.931511 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.16s]
[0m02:47:37.933510 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:47:37.934510 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:47:37.934510 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:47:37.936509 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:37.937509 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:47:37.938508 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:47:37.946518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:47:37.947503 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:37.948501 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:47:37.955498 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:47:37.957498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:37.957498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:47:37.958508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:38.002308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:47:38.002308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:38.003307 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:47:38.025884 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:47:38.029868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:38.029868 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:47:38.030867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:38.034865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:38.034865 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:47:38.035865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:38.041862 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:47:38.042859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:38.042859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:47:38.045436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:38.049454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:47:38.050452 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:47:38.054984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:38.056997 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:38.056997 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:47:38.058001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E1525B430>]}
[0m02:47:38.058984 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.12s]
[0m02:47:38.060984 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:47:38.061983 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:47:38.062998 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:47:38.065981 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.067980 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:47:38.070980 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:47:38.130958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.131943 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:38.132958 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:47:38.139940 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.141952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.141952 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:47:38.142936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:38.282676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.14 seconds
[0m02:47:38.283676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.283676 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:47:38.324651 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:47:38.328646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.328646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:47:38.329646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:38.333644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.333644 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:47:38.335643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:38.339644 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:47:38.339644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.340640 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:47:38.367624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:47:38.371622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:47:38.371622 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:47:38.376622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:38.378619 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:38.379618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:47:38.380618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E152A6710>]}
[0m02:47:38.381617 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.32s]
[0m02:47:38.383615 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:47:38.384615 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:47:38.385614 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:47:38.386625 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:38.387614 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:47:38.388613 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:47:38.396608 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:38.397608 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:38.398607 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:47:38.410602 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:38.411600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:38.412599 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:47:38.413598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:38.460579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:47:38.461571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:38.461571 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:47:39.001859 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.54 seconds
[0m02:47:39.005858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:39.005858 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:47:39.006856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.009855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:39.010855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:47:39.011854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.014851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:47:39.014851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:39.015851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:47:39.017319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.020322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:47:39.020322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:47:39.024437 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.026422 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:39.027421 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:47:39.028420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14E77E20>]}
[0m02:47:39.029438 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.64s]
[0m02:47:39.030416 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:47:39.031418 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:47:39.032415 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:47:39.034417 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.034417 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:47:39.035417 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:47:39.047407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.048409 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:39.049408 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:47:39.057402 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.059403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.059403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:47:39.060400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:47:39.103379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:47:39.104376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.105374 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:47:39.121820 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:47:39.125831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.125831 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:47:39.126830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.129828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.130828 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:47:39.131812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.134825 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:47:39.135811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.135811 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:47:39.138057 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.140079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:47:39.141078 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:47:39.145019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.147024 [debug] [Thread-1 (]: finished collecting timing info
[0m02:47:39.147024 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:47:39.148003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '207ac617-d86a-47d0-8967-b277324ec91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E1526B850>]}
[0m02:47:39.149001 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.11s]
[0m02:47:39.151000 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:47:39.152000 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:47:39.153001 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.153999 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.154998 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:39.199971 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:47:39.200971 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.200971 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.201972 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.201972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.202972 [debug] [MainThread]: On master: Close
[0m02:47:39.205977 [info ] [MainThread]: 
[0m02:47:39.207967 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m02:47:39.208967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:39.209966 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:47:39.210966 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m02:47:39.211965 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:47:39.226965 [info ] [MainThread]: 
[0m02:47:39.228956 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:47:39.229955 [info ] [MainThread]: 
[0m02:47:39.231953 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:47:39.232953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14DBE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E14DBFA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E15089090>]}


============================== 2022-11-23 02:48:58.791223 | 6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33 ==============================
[0m02:48:58.791223 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:48:58.792203 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:48:58.793201 [debug] [MainThread]: Tracking: tracking
[0m02:48:58.812206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261E0C730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261E0C9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261E0C7F0>]}
[0m02:48:58.925126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:48:58.926125 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:48:58.942116 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:48:58.971101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:48:58.989090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261F9E080>]}
[0m02:48:59.020072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261F3BFA0>]}
[0m02:48:59.023071 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:48:59.025070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261F39360>]}
[0m02:48:59.031066 [info ] [MainThread]: 
[0m02:48:59.035065 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:48:59.042061 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:48:59.069045 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:48:59.070045 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:48:59.071044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:59.140005 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.07 seconds
[0m02:48:59.142002 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:48:59.143002 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:48:59.146000 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:48:59.146000 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:48:59.146999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:59.194973 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:48:59.196971 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:48:59.198969 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:48:59.202968 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:48:59.202968 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:48:59.203966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:59.246942 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:48:59.248942 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:48:59.251939 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:48:59.258935 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:48:59.259934 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:48:59.259934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:59.298913 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.299912 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:48:59.299912 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:48:59.307907 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:48:59.309906 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:48:59.310907 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:48:59.311905 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:48:59.314903 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:48:59.314903 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:48:59.314903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:59.357879 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.358880 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:48:59.359878 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:48:59.366874 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:48:59.368874 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:48:59.369872 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:48:59.370871 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:48:59.374869 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:48:59.374869 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:48:59.375868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:59.415846 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.415846 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:48:59.416847 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:48:59.423844 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:48:59.426840 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:48:59.426840 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:48:59.433837 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:59.433837 [debug] [MainThread]: On master: BEGIN
[0m02:48:59.434836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:48:59.476803 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.476803 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:59.477805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:48:59.532785 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:48:59.534785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261DDBF40>]}
[0m02:48:59.535770 [debug] [MainThread]: On master: ROLLBACK
[0m02:48:59.535770 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:59.536769 [debug] [MainThread]: On master: BEGIN
[0m02:48:59.536769 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:48:59.537768 [debug] [MainThread]: On master: COMMIT
[0m02:48:59.537768 [debug] [MainThread]: Using postgres connection "master"
[0m02:48:59.538768 [debug] [MainThread]: On master: COMMIT
[0m02:48:59.538768 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:48:59.539766 [debug] [MainThread]: On master: Close
[0m02:48:59.539766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:48:59.540766 [info ] [MainThread]: 
[0m02:48:59.549762 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:48:59.550760 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:48:59.552009 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.553033 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:48:59.554012 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:48:59.561008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.563006 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.563006 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:48:59.622974 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.623971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.624970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:48:59.624970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:48:59.665950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.666964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.666964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:48:59.682886 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:48:59.691896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.691896 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:48:59.692883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.697878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.697878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:48:59.698877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.732872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:48:59.733872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.734859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:48:59.736555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:48:59.742568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:48:59.743568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:48:59.747794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:48:59.749806 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.750795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:48:59.750795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172620A1F90>]}
[0m02:48:59.751795 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.20s]
[0m02:48:59.753791 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:48:59.754791 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:48:59.755796 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:48:59.757792 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.757792 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:48:59.758800 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:48:59.762801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.763802 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.764787 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:48:59.774779 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.777581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.778584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:48:59.778584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:48:59.823557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:48:59.823557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.824559 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:48:59.835817 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:48:59.840828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.840828 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:48:59.841813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.845826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.845826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:48:59.846812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.849824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:48:59.850810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.850810 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:48:59.852686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:48:59.855686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:48:59.855686 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:48:59.860937 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:48:59.863946 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.863946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:48:59.864934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262095C00>]}
[0m02:48:59.865935 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m02:48:59.867935 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:48:59.867935 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:48:59.868933 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:48:59.870932 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.871933 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:48:59.871933 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:48:59.878926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:48:59.879926 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.880925 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:48:59.886937 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:48:59.887921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.887921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:48:59.888937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:48:59.940892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:48:59.941891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.942890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:48:59.960843 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:48:59.966840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.966840 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:48:59.967839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.972836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.972836 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:48:59.974834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:48:59.977833 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:48:59.977833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.978834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:48:59.980640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:48:59.982657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:48:59.983656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:48:59.990161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:48:59.992164 [debug] [Thread-1 (]: finished collecting timing info
[0m02:48:59.992164 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:48:59.993160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172620F5330>]}
[0m02:48:59.994159 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.12s]
[0m02:48:59.996158 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:48:59.997158 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:48:59.998157 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:49:00.000156 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:00.001159 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:49:00.002155 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:49:00.017147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:49:00.019145 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.020144 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:49:00.032138 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:49:00.034136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:00.034136 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:49:00.035136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.083109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:00.083109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:00.084109 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms,
    from "Summer_Song"."SummerSong"."duration" as d
)


profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from unduplicated_duration as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:49:00.084109 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «from»
LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
             ^

[0m02:49:00.085109 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m02:49:00.086107 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.086107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:49:00.087108 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  error de sintaxis en o cerca de «from»
  LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
               ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:49:00.088107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262003B80>]}
[0m02:49:00.089107 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.09s]
[0m02:49:00.091104 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:49:00.091104 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:00.092103 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:49:00.093103 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.094103 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:00.094103 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:00.099100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.100099 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.100099 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:00.108101 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.110093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.111094 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:49:00.112092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.260510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m02:49:00.261511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.261511 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:49:00.318477 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.06 seconds
[0m02:49:00.322478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.323475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:49:00.324475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.327474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.328473 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:49:00.329472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.334469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:49:00.335468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.335468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:49:00.337469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:00.340465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:00.341465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:49:00.348463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:00.350460 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.351459 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:49:00.352461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262000520>]}
[0m02:49:00.353458 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.26s]
[0m02:49:00.355456 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:00.356458 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:00.356458 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:49:00.358456 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.359455 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:00.360454 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:00.366453 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.367450 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.368449 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:00.384443 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.386439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.386439 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:49:00.387439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.441408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:00.442408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.443408 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:49:00.473389 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:49:00.477388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.478388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:49:00.479386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.482384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.483383 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:49:00.484384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.489379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:49:00.490379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.490379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:49:00.493377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:00.497375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:00.497375 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:49:00.503371 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:00.505371 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.506370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:49:00.507371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172620154B0>]}
[0m02:49:00.508369 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.15s]
[0m02:49:00.510368 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:00.510368 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:00.511368 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:49:00.513368 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.513368 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:00.514367 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:00.523362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.526366 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.527359 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:00.534354 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.536353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.536353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:49:00.537353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.584326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:00.585326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.585326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:49:00.611116 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:49:00.614114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.615113 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:49:00.616114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.619110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.620111 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:49:00.621110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.624110 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:49:00.624110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.625110 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:49:00.627107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:00.630107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:00.630107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:49:00.636211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:00.638211 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.639211 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:49:00.640209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262132D10>]}
[0m02:49:00.641208 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.13s]
[0m02:49:00.643207 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:00.644207 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:49:00.644207 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:49:00.646207 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.647205 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:49:00.648205 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:49:00.654201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.657200 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.658200 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:49:00.672197 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.674190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.675189 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:49:00.676189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.719163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:00.720164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.721163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:49:00.741675 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:00.745674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.746672 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:49:00.746672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.750671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.751670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:49:00.752669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.757667 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:49:00.758666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.758666 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:49:00.793466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:49:00.798471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:00.800468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:49:00.812004 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:00.814990 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.815990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:49:00.817989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172621580D0>]}
[0m02:49:00.819987 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.17s]
[0m02:49:00.822984 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:49:00.823987 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:00.824983 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:49:00.826434 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.827437 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:00.827437 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:49:00.833437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.834436 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.835432 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:00.847426 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.849427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.850424 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:49:00.850424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:00.900696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:00.900696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.901697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:49:00.923912 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:00.927926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.927926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:49:00.928927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.931924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.932924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:49:00.933909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:00.937907 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:49:00.937907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.938906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:49:00.940681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:00.942682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:00.943681 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:49:00.949072 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:00.951060 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.952061 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:49:00.953074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261FFBA90>]}
[0m02:49:00.954059 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.13s]
[0m02:49:00.955058 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:00.956058 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:49:00.957057 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:49:00.959056 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:00.959056 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:49:00.960055 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:49:00.966066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:00.967066 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:00.968050 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:49:00.982042 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:00.984041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:00.984041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:49:00.984041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:01.031014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:01.031014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:01.032015 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:49:01.053372 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:01.057370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:01.058370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:49:01.059370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.062369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:01.063368 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:49:01.064368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.068365 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:49:01.068365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:01.069364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:49:01.071334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:01.074338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:01.074338 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:49:01.080333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:01.082331 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.082331 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:49:01.083331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172620150C0>]}
[0m02:49:01.084329 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.13s]
[0m02:49:01.086329 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:49:01.087329 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:49:01.088329 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:49:01.091326 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.091326 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:49:01.092326 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:49:01.098329 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.099321 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.100320 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:49:01.108318 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.110316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.111316 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:49:01.111316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:01.157289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:01.158288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.158288 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:49:01.180627 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:01.184626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.184626 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:49:01.185625 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.190623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.191621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:49:01.192620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.199617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:49:01.199617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.200616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:49:01.203615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:01.208613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:01.209611 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:49:01.217606 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:01.220604 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.221604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:49:01.223603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262015000>]}
[0m02:49:01.224603 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:49:01.227601 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:49:01.228600 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:49:01.229600 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:49:01.231599 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.232598 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:49:01.232598 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:49:01.251587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.252586 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.254586 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:49:01.279571 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.292564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.292564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:49:01.293563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:01.388509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.09 seconds
[0m02:49:01.389509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.390507 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:49:01.471463 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.08 seconds
[0m02:49:01.478458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.478458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:49:01.479457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.529442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.530429 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:49:01.530429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:01.535424 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:49:01.536424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.536424 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:49:01.538438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:01.543419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:01.543419 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:49:01.550418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:01.553415 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.554413 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:49:01.555414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017261DDE590>]}
[0m02:49:01.556413 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.32s]
[0m02:49:01.558411 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:49:01.559410 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:49:01.559410 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:49:01.561412 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:01.562409 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:49:01.562409 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:49:01.568406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:01.569405 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:01.570404 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:49:01.582398 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:01.584396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:01.585396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:49:01.585396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:01.641364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:49:01.641364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:01.642364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:49:02.291994 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.65 seconds
[0m02:49:02.295991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:02.295991 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:49:02.296991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:02.300988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:02.300988 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:49:02.302986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:02.306985 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:49:02.307983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:02.307983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:49:02.309985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:02.314979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:02.314979 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:49:02.321974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:02.323974 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:02.324973 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:49:02.325972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726218DCC0>]}
[0m02:49:02.326972 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.76s]
[0m02:49:02.329970 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:49:02.330970 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:49:02.331970 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:49:02.333968 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.334968 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:49:02.336967 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:49:02.343964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.344963 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:02.345961 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:49:02.351959 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.353956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.355956 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:49:02.355956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:02.407928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:02.408925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.408925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:49:02.427914 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:49:02.436908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.437909 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:49:02.438908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:02.443905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.444904 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:49:02.445903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:02.449901 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:49:02.450901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.450901 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:49:02.452901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:02.455899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:02.456897 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:49:02.462895 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:02.464893 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:02.464893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:49:02.466893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf43c76-e6fe-4bc3-b7b5-8efe0cb64a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172620F7AC0>]}
[0m02:49:02.467893 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.13s]
[0m02:49:02.468890 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:49:02.471889 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:49:02.471889 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:02.472888 [debug] [MainThread]: On master: BEGIN
[0m02:49:02.473888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:02.528857 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:49:02.529856 [debug] [MainThread]: On master: COMMIT
[0m02:49:02.529856 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:02.530856 [debug] [MainThread]: On master: COMMIT
[0m02:49:02.531856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:02.531856 [debug] [MainThread]: On master: Close
[0m02:49:02.532855 [info ] [MainThread]: 
[0m02:49:02.534853 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m02:49:02.535853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:02.536853 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:49:02.537852 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m02:49:02.538851 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:49:02.555842 [info ] [MainThread]: 
[0m02:49:02.557841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:02.560839 [info ] [MainThread]: 
[0m02:49:02.561838 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m02:49:02.563839 [error] [MainThread]:   error de sintaxis en o cerca de «from»
[0m02:49:02.564837 [error] [MainThread]:   LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
[0m02:49:02.565836 [error] [MainThread]:                ^
[0m02:49:02.567836 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:49:02.568834 [info ] [MainThread]: 
[0m02:49:02.570834 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m02:49:02.572831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001726214AC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262148DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017262119180>]}


============================== 2022-11-23 02:49:53.242143 | dd1338c3-f4ca-4504-a777-8fe3afeeb5e6 ==============================
[0m02:49:53.242143 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:49:53.243768 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:53.244772 [debug] [MainThread]: Tracking: tracking
[0m02:49:53.263762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB15F0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB15F09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB15F07F0>]}
[0m02:49:53.360704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:53.361706 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:49:53.377694 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:49:53.400291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:49:53.412265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1782080>]}
[0m02:49:53.427273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB171BFA0>]}
[0m02:49:53.428270 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:49:53.429459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1719360>]}
[0m02:49:53.432480 [info ] [MainThread]: 
[0m02:49:53.434030 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:49:53.437031 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:49:53.452022 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:49:53.453021 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:49:53.453021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:53.513742 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:49:53.515753 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:49:53.516742 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:49:53.519741 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:49:53.519741 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:49:53.520740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:53.559682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:49:53.560682 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:49:53.562680 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:49:53.566676 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:49:53.567677 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:49:53.567677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:53.605512 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:49:53.607495 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:49:53.610494 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:49:53.617505 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:49:53.617505 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:49:53.618491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:53.656479 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:49:53.656479 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:49:53.657468 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:49:53.666461 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:49:53.668472 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:49:53.669461 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:49:53.670459 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:49:53.673472 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:49:53.673472 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:49:53.674459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:53.716433 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:49:53.716433 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:49:53.717434 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:49:53.725427 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:49:53.728427 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:49:53.729425 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:49:53.730425 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:49:53.734422 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:49:53.735422 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:49:53.735422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:53.781396 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:49:53.781396 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:49:53.782396 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:49:53.790392 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:49:53.793388 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:49:53.794390 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:49:53.800384 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:53.801385 [debug] [MainThread]: On master: BEGIN
[0m02:49:53.802384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:53.851356 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:49:53.851356 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:53.852355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:53.924317 [debug] [MainThread]: SQL status: SELECT 0 in 0.07 seconds
[0m02:49:53.926315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB15BA770>]}
[0m02:49:53.927315 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:53.927315 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:53.928312 [debug] [MainThread]: On master: BEGIN
[0m02:49:53.929312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:53.929312 [debug] [MainThread]: On master: COMMIT
[0m02:49:53.930310 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:53.930310 [debug] [MainThread]: On master: COMMIT
[0m02:49:53.931310 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:53.932309 [debug] [MainThread]: On master: Close
[0m02:49:53.932309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:53.934309 [info ] [MainThread]: 
[0m02:49:53.942304 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:49:53.943304 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:49:53.945305 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:53.945305 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:49:53.946302 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:49:53.950299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:49:53.951298 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:53.952299 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:49:54.026256 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.028255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.028255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:49:54.028255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:49:54.066233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:54.067234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.067234 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:49:54.084346 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.02 seconds
[0m02:49:54.092340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.093340 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:49:54.094340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.098337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.099336 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:49:54.100337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.128334 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:49:54.128334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.129318 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:49:54.130320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.138316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:49:54.138316 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:49:54.142418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:54.144417 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.144417 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:49:54.145416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1885F90>]}
[0m02:49:54.146417 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.20s]
[0m02:49:54.147415 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:49:54.148415 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:49:54.149414 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:49:54.150415 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.151414 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:49:54.152413 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:49:54.160409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.161408 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.161408 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:49:54.169402 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.173401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.173401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:49:54.174401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.219374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:54.220375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.221374 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:49:54.233268 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:49:54.238264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.238264 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:49:54.239264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.242262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.243261 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:49:54.244261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.247259 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:49:54.248258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.248258 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:49:54.250102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.252120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:49:54.253104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:49:54.257111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:54.259116 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.260099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:49:54.261099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1879C00>]}
[0m02:49:54.262101 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m02:49:54.263099 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:49:54.264099 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:49:54.265098 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:49:54.266108 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.267098 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:49:54.267098 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:49:54.274094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:49:54.278090 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.279101 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:49:54.288084 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:49:54.290082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.291085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:49:54.292083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.337055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:54.338055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.339056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:49:54.360057 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:54.365069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.366054 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:49:54.367054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.370067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.370067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:49:54.371051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.374065 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:49:54.375064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.375064 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:49:54.377802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.379818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:49:54.380817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:49:54.385877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:54.387890 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.387890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:49:54.388890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB18D5180>]}
[0m02:49:54.389874 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.12s]
[0m02:49:54.391875 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:49:54.392874 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:49:54.392874 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:49:54.394872 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:54.395871 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:49:54.396870 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:49:54.411873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:49:54.412862 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.413871 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:49:54.419871 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:49:54.421866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:54.422855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:49:54.423857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.467829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:54.467829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:49:54.468828 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms,
    from "Summer_Song"."SummerSong"."duration" as d
),


profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from unduplicated_duration as d
    left join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    left join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    left join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    left join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    left join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:49:54.469827 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «from»
LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
             ^

[0m02:49:54.469827 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m02:49:54.470828 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.471827 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:49:54.472827 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  error de sintaxis en o cerca de «from»
  LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
               ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:49:54.472827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17E6590>]}
[0m02:49:54.473827 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.08s]
[0m02:49:54.475824 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:49:54.476824 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:54.476824 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:49:54.477823 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.478823 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:54.479822 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:54.483820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.484819 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.485818 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:54.493815 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.494813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.495813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:49:54.495813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.644790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m02:49:54.644790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.645804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:49:54.667868 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:49:54.670869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.671881 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:49:54.672874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.675878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.675878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:49:54.676879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.679876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:49:54.680876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.680876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:49:54.683523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.685539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:49:54.686523 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:49:54.692341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:54.694357 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.694357 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:49:54.695344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17E4880>]}
[0m02:49:54.696341 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.22s]
[0m02:49:54.697835 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:49:54.698838 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:54.699837 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:49:54.700836 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.701836 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:54.702835 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:54.712830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.714829 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.715828 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:54.726822 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.728824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.728824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:49:54.729821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.772234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:54.772234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.773250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:49:54.798549 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:49:54.801547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.802531 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:49:54.803531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.806543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.807528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:49:54.808528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.811542 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:49:54.811542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.812526 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:49:54.814483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.817498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:49:54.817498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:49:54.823488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:54.825487 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.826489 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:49:54.826489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17F54B0>]}
[0m02:49:54.827487 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.13s]
[0m02:49:54.829484 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:49:54.830485 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:54.831483 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:49:54.832485 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.833482 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:54.833482 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:54.838481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.841478 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.842480 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:54.850473 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.851472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.851472 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:49:54.852471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:54.899444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:54.899444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.900446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:49:54.922786 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:54.927763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.928762 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:49:54.929782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.932760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.932760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:49:54.933759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:54.937758 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:49:54.937758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.938772 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:49:54.940947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:54.942948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:49:54.943947 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:49:54.948809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:54.950791 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.951790 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:49:54.952792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17D93C0>]}
[0m02:49:54.952792 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.12s]
[0m02:49:54.954791 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:49:54.955788 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:49:54.955788 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:49:54.957790 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:54.958788 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:49:54.958788 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:49:54.964804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:54.965803 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:54.966782 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:49:54.979776 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:54.980774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:54.981773 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:49:54.981773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.023752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:55.023752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:55.024749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:49:55.050736 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:49:55.056731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:55.056731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:49:55.057730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.061728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:55.061728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:49:55.062727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.066727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:49:55.067727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:55.068724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:49:55.069723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:55.073723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:49:55.073723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:49:55.080719 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:55.082716 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.083715 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:49:55.084714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB193CC10>]}
[0m02:49:55.085714 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.13s]
[0m02:49:55.087713 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:49:55.088712 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:55.089712 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:49:55.090712 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.091711 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:55.092711 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:49:55.098707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.099706 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.100709 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:55.113710 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.114698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.115699 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:49:55.115699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.169666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:55.171665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.171665 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:49:55.194651 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:55.198651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.199650 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:49:55.200648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.204646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.204646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:49:55.206645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.209644 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:49:55.210644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.211642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:49:55.212643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:55.216639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:49:55.217640 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:49:55.223635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:55.225635 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.226633 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:49:55.227633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17EFD60>]}
[0m02:49:55.228633 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:49:55.230631 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:49:55.231631 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:49:55.231631 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:49:55.233632 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.234630 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:49:55.235629 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:49:55.244623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.246622 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.246622 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:49:55.261615 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.262613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.263612 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:49:55.264612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.314584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:55.314584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.315584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:49:55.342567 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:49:55.346565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.347564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:49:55.348564 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.351562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.352561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:49:55.353561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.358558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:49:55.358558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.359557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:49:55.382321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:49:55.385323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:49:55.385323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:49:55.390320 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:55.392319 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.393317 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:49:55.394317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17F50C0>]}
[0m02:49:55.395317 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.16s]
[0m02:49:55.396316 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:49:55.397315 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:49:55.398314 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:49:55.399313 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.400314 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:49:55.400314 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:49:55.410307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.412307 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.413306 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:49:55.418317 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.419306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.421305 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:49:55.422303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.466843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:55.467841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.467841 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:49:55.491258 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:49:55.495257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.496256 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:49:55.496256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.500255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.500255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:49:55.501253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.505252 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:49:55.506250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.506250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:49:55.508356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:55.510371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:49:55.511371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:49:55.516353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:49:55.518364 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.518364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:49:55.519368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB17F5000>]}
[0m02:49:55.520351 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.12s]
[0m02:49:55.522350 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:49:55.523352 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:49:55.523352 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:49:55.524351 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.525348 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:49:55.526348 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:49:55.535343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.536342 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.536342 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:49:55.547336 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.549334 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.549334 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:49:55.550334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.595308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:55.596309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.596309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:49:55.630107 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:49:55.635104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.636104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:49:55.637103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.683077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.684076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:49:55.685076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:55.688074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:49:55.689073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.689073 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:49:55.691923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:55.693938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:49:55.694925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:49:55.699932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:55.701930 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.701930 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:49:55.702918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB15BE590>]}
[0m02:49:55.703918 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.18s]
[0m02:49:55.705917 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:49:55.705917 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:49:55.706919 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:49:55.707915 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:55.708932 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:49:55.709916 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:49:55.718910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:55.720909 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:55.721912 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:49:55.729905 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:55.731902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:55.731902 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:49:55.732902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:55.776876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:49:55.776876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:55.777887 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:49:56.360558 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.58 seconds
[0m02:49:56.363541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:56.364540 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:49:56.365556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:56.368538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:56.368538 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:49:56.369537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:56.373535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:49:56.374534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:56.374534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:49:56.376534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:56.379534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:49:56.380534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:49:56.386527 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:56.388538 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:56.389542 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:49:56.390527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1972440>]}
[0m02:49:56.391525 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.68s]
[0m02:49:56.393524 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:49:56.394524 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:49:56.396523 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:49:56.398522 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.399521 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:49:56.401526 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:49:56.411515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.412514 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:56.413513 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:49:56.424507 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.426506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.427504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:49:56.427504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:56.476480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:49:56.476480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.477476 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:49:56.493468 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.01 seconds
[0m02:49:56.501463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.502462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:49:56.503461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:56.508459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.509458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:49:56.510458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:56.515454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:49:56.516455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.516455 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:49:56.518452 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:49:56.521453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:49:56.522450 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:49:56.529449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:49:56.531447 [debug] [Thread-1 (]: finished collecting timing info
[0m02:49:56.532444 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:49:56.533444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1338c3-f4ca-4504-a777-8fe3afeeb5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1908730>]}
[0m02:49:56.534444 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.13s]
[0m02:49:56.538442 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:49:56.540440 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:49:56.541439 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.542439 [debug] [MainThread]: On master: BEGIN
[0m02:49:56.543439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:56.595409 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:49:56.596408 [debug] [MainThread]: On master: COMMIT
[0m02:49:56.596408 [debug] [MainThread]: Using postgres connection "master"
[0m02:49:56.597407 [debug] [MainThread]: On master: COMMIT
[0m02:49:56.597407 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:56.598408 [debug] [MainThread]: On master: Close
[0m02:49:56.599406 [info ] [MainThread]: 
[0m02:49:56.600406 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m02:49:56.601406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:56.602405 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:49:56.603406 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m02:49:56.603406 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:49:56.625392 [info ] [MainThread]: 
[0m02:49:56.626392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:56.629391 [info ] [MainThread]: 
[0m02:49:56.631389 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m02:49:56.633387 [error] [MainThread]:   error de sintaxis en o cerca de «from»
[0m02:49:56.635386 [error] [MainThread]:   LINE 13:     from "Summer_Song"."SummerSong"."duration" as d
[0m02:49:56.636386 [error] [MainThread]:                ^
[0m02:49:56.642384 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:49:56.644385 [info ] [MainThread]: 
[0m02:49:56.646380 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m02:49:56.648380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB1928DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB192A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AEB18F8670>]}


============================== 2022-11-23 02:50:24.915981 | 93091280-2af5-4edb-b7e8-bc9ac5a136b9 ==============================
[0m02:50:24.915981 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:50:24.916980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:50:24.916980 [debug] [MainThread]: Tracking: tracking
[0m02:50:24.934975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131E70520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131E70A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131E707F0>]}
[0m02:50:25.035914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:50:25.036914 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:50:25.051903 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:50:25.074890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:50:25.086102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131FFE0B0>]}
[0m02:50:25.103073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131F9BEE0>]}
[0m02:50:25.104072 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:50:25.109067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131F99390>]}
[0m02:50:25.113081 [info ] [MainThread]: 
[0m02:50:25.115064 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:50:25.118069 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:50:25.136072 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:50:25.137071 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:50:25.139058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:50:25.193020 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:50:25.195039 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:50:25.196019 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:50:25.199016 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:50:25.200015 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:50:25.200015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:25.239995 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:50:25.241991 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:50:25.242991 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:50:25.245989 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:50:25.246988 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:50:25.246988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:25.284968 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:50:25.286968 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:50:25.289978 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:50:25.298961 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:50:25.298961 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:50:25.299958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:50:25.338936 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:50:25.338936 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:50:25.339947 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:50:25.349930 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:50:25.351928 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:50:25.352928 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:50:25.354927 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:50:25.357925 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:50:25.358924 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:50:25.358924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:25.421890 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m02:50:25.422888 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:50:25.422888 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:50:25.430884 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:50:25.433884 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:50:25.433884 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:50:25.434882 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:50:25.438879 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:50:25.439878 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:50:25.439878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:50:25.478505 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:50:25.478505 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:50:25.479507 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:50:25.486500 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:50:25.489505 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:50:25.490499 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:50:25.497496 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:25.498497 [debug] [MainThread]: On master: BEGIN
[0m02:50:25.498497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:50:25.537475 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:50:25.538472 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:25.538472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:50:25.589441 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:50:25.591441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131FB95D0>]}
[0m02:50:25.591441 [debug] [MainThread]: On master: ROLLBACK
[0m02:50:25.592441 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:25.592441 [debug] [MainThread]: On master: BEGIN
[0m02:50:25.593441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:50:25.594439 [debug] [MainThread]: On master: COMMIT
[0m02:50:25.594439 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:25.595438 [debug] [MainThread]: On master: COMMIT
[0m02:50:25.595438 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:50:25.596438 [debug] [MainThread]: On master: Close
[0m02:50:25.596438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:50:25.598437 [info ] [MainThread]: 
[0m02:50:25.606433 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:50:25.607432 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:50:25.608432 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.609431 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:50:25.609431 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:50:25.618425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.621425 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:25.622430 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:50:25.692383 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.693382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.694381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:50:25.694381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:50:25.733360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:50:25.733360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.734360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:50:25.747352 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:50:25.755347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.755347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:50:25.756347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:25.761344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.762344 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:50:25.762344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:25.791326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:50:25.791326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.792328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:50:25.793762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:25.799761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:50:25.799761 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:50:25.803759 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:25.805758 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:25.806757 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:50:25.807757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022132105FC0>]}
[0m02:50:25.807757 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.20s]
[0m02:50:25.809373 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:50:25.810379 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:50:25.811375 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:50:25.812375 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.813377 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:50:25.814389 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:50:25.824368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.825367 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:25.826367 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:50:25.836372 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.838361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.839366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:50:25.840359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:25.898326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:50:25.898326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.899325 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:50:25.912318 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:50:25.917315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.918315 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:50:25.919314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:25.922315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.923313 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:50:25.924313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:25.928311 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:50:25.929308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.929308 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:50:25.931307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:25.935305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:50:25.936304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:50:25.941301 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:25.944300 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:25.945299 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:50:25.946299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221320F63E0>]}
[0m02:50:25.947298 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.13s]
[0m02:50:25.949297 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:50:25.950296 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:50:25.951295 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:50:25.953296 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:25.954295 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:50:25.955294 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:50:25.967287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:50:25.968286 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:25.969285 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:50:25.983277 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:50:25.984279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:25.985276 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:50:25.985276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.038247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:26.039246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:26.039246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:50:26.086218 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.05 seconds
[0m02:50:26.092215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:26.092215 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:50:26.094214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.097213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:26.098211 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:50:26.099212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.104208 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:50:26.105208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:26.105208 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:50:26.107207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:26.111204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:50:26.112204 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:50:26.116203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:26.118201 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.119201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:50:26.120199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022132155180>]}
[0m02:50:26.121198 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.17s]
[0m02:50:26.123197 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:50:26.124198 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:50:26.125198 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:50:26.126196 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.127195 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:50:26.128195 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:50:26.142187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.144186 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.145190 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:50:26.152182 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.153180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.155180 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:50:26.155180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.205152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:26.206150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.207150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration" as d
),


profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from unduplicated_duration as d
    left join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    left join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    left join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    left join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    left join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:50:26.243142 [debug] [Thread-1 (]: SQL status: SELECT 2008 in 0.04 seconds
[0m02:50:26.247140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.248139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:50:26.249140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.252138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.253137 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:50:26.253137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.257134 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:50:26.258134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.258134 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:50:26.260770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:26.262772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:50:26.263772 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:50:26.269712 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:50:26.271710 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.272709 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:50:26.273709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022132128F70>]}
[0m02:50:26.274708 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2008[0m in 0.15s]
[0m02:50:26.276707 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:50:26.277707 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:50:26.278706 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:50:26.281704 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.281704 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:50:26.282704 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:50:26.290699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.292700 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.294697 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:50:26.300693 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.301694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.301694 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:50:26.302693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.348665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:26.349666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.349666 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:50:26.371608 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:50:26.375603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.376604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:50:26.377605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.382599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.382599 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:50:26.383599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.387596 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:50:26.388597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.388597 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:50:26.391040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:26.393042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:50:26.394040 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:50:26.397848 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:26.399848 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.400846 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:50:26.400846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022132187FD0>]}
[0m02:50:26.401846 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.12s]
[0m02:50:26.404844 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:50:26.405843 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:50:26.406843 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:50:26.408842 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.409844 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:50:26.410841 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:50:26.416837 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.418836 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.418836 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:50:26.428831 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.429830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.430830 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:50:26.430830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.473805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:50:26.474805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.474805 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:50:26.499967 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.02 seconds
[0m02:50:26.502966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.503964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:50:26.504964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.507962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.508962 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:50:26.509977 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.512975 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:50:26.513974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.513974 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:50:26.547427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:50:26.550428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:50:26.550428 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:50:26.555424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:26.557440 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.557440 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:50:26.558444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002213206BAC0>]}
[0m02:50:26.559422 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.15s]
[0m02:50:26.561421 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:50:26.562421 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:50:26.563441 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:50:26.564419 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.565419 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:50:26.566419 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:50:26.574434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.576414 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.577412 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:50:26.585407 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.587406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.589406 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:50:26.590406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.635379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:50:26.635379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.636378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:50:26.659380 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:50:26.663363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.663363 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:50:26.664362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.669359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.670358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:50:26.671365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.674359 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:50:26.675358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.675358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:50:26.677666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:26.680667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:50:26.681668 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:50:26.686146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:26.688125 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.689123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:50:26.690124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321A7F10>]}
[0m02:50:26.691123 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.13s]
[0m02:50:26.692122 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:50:26.693121 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:50:26.694121 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:50:26.696120 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.697119 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:50:26.697119 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:50:26.704136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.706115 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.707114 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:50:26.715129 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.717110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.717110 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:50:26.717110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:26.888999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m02:50:26.890020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.891020 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:50:26.920440 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:50:26.924419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.924419 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:50:26.925419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.929417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.930415 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:50:26.931414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:26.936432 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:50:26.937431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.938410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:50:26.940411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:26.945406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:50:26.946406 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:50:26.953402 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:50:26.956400 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.957400 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:50:26.959399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321B8580>]}
[0m02:50:26.961399 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.26s]
[0m02:50:26.964396 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:50:26.965396 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:50:26.966395 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:50:26.968394 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:26.969393 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:50:26.971392 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:50:26.981386 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:26.982385 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:26.983384 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:50:26.996381 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:26.997376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:26.998376 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:50:26.999375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:27.047583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:27.048584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:27.049582 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:50:27.070132 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:50:27.074131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:27.074131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:50:27.075130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.081126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:27.082126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:50:27.083126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.087123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:50:27.087123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:27.088123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:50:27.115993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:50:27.120992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:50:27.121992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:50:27.125785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:27.127784 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.127784 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:50:27.128783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321C3D60>]}
[0m02:50:27.129781 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.16s]
[0m02:50:27.131781 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:50:27.132779 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:50:27.132779 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:50:27.134779 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.135778 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:50:27.135778 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:50:27.143785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.144788 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.145772 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:50:27.150784 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.152768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.154767 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:50:27.155771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:27.209735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:27.210736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.210736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:50:27.246729 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:50:27.252710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.253710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:50:27.254712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.259721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.259721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:50:27.261708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.264704 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:50:27.265703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.265703 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:50:27.267702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:27.271700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:50:27.271700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:50:27.276699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:27.278712 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.279711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:50:27.280694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131E3A770>]}
[0m02:50:27.281694 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.15s]
[0m02:50:27.283693 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:50:27.284693 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:50:27.285692 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:50:27.287691 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.288691 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:50:27.289691 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:50:27.297686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.298686 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.299684 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:50:27.308678 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.310677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.311677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:50:27.311677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:27.372642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:50:27.373642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.374641 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:50:27.400627 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:50:27.405625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.406624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:50:27.407622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.412619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.413618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:50:27.414618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.418617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:50:27.418617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.419615 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:50:27.421615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:27.426613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:50:27.426613 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:50:27.431610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:27.434607 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.435607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:50:27.436606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321AAB00>]}
[0m02:50:27.437606 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.15s]
[0m02:50:27.439604 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:50:27.440604 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:50:27.441605 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:50:27.443604 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.444602 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:50:27.444602 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:50:27.510564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.512564 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.512564 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:50:27.521557 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.523557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.523557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:50:27.524555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:27.570529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:50:27.570529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.571529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:50:27.639020 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.07 seconds
[0m02:50:27.643017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.643017 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:50:27.644016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.648015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.648015 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:50:27.649013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:27.653010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:50:27.653010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.654010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:50:27.655983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:27.658983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:50:27.658983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:50:27.663090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:27.666101 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.667085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:50:27.668085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321F6650>]}
[0m02:50:27.669084 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.23s]
[0m02:50:27.671083 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:50:27.672087 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:50:27.673082 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:50:27.675084 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:27.675084 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:50:27.676083 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:50:27.683077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:27.685075 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:27.686075 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:50:27.698071 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:27.701066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:27.701066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:50:27.702066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:27.765031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:50:27.766030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:27.767028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:50:28.484617 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.72 seconds
[0m02:50:28.489618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:28.489618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:50:28.490617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:28.494627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:28.494627 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:50:28.495614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:28.499609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:50:28.499609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:28.499609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:50:28.502289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:50:28.505290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:50:28.506289 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:50:28.510548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:28.512570 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:28.512570 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:50:28.513551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131DCBE20>]}
[0m02:50:28.514551 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.84s]
[0m02:50:28.516549 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:50:28.517550 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:50:28.518548 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:50:28.520546 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.521545 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:50:28.522544 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:50:28.529560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.531538 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:28.532538 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:50:28.541534 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.543532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.543532 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:50:28.544531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:50:28.606496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:50:28.607496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.608501 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:50:28.635482 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:50:28.643475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.644479 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:50:28.645474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:28.651471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.652472 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:50:28.654471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:50:28.661466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:50:28.661466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.662466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:50:28.669460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m02:50:28.676457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:50:28.677456 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:50:28.683453 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:50:28.686450 [debug] [Thread-1 (]: finished collecting timing info
[0m02:50:28.688450 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:50:28.690449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93091280-2af5-4edb-b7e8-bc9ac5a136b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131FDBB20>]}
[0m02:50:28.692448 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.17s]
[0m02:50:28.695447 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:50:28.698445 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:50:28.699444 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:28.700444 [debug] [MainThread]: On master: BEGIN
[0m02:50:28.700444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:50:28.779400 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m02:50:28.780397 [debug] [MainThread]: On master: COMMIT
[0m02:50:28.780397 [debug] [MainThread]: Using postgres connection "master"
[0m02:50:28.781396 [debug] [MainThread]: On master: COMMIT
[0m02:50:28.781396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:50:28.782395 [debug] [MainThread]: On master: Close
[0m02:50:28.783398 [info ] [MainThread]: 
[0m02:50:28.785393 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m02:50:28.786393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:50:28.787393 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:50:28.788393 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m02:50:28.789394 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:50:28.812379 [info ] [MainThread]: 
[0m02:50:28.813378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:50:28.816377 [info ] [MainThread]: 
[0m02:50:28.818377 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:50:28.820375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022132184280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221321845E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022131D0CC10>]}


============================== 2022-11-23 02:51:05.378473 | 72f5cd40-1d9e-4d30-90e2-a0f558697de2 ==============================
[0m02:51:05.378473 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:51:05.379467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:05.379467 [debug] [MainThread]: Tracking: tracking
[0m02:51:05.402444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECACACE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECACCC9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECACCC730>]}
[0m02:51:05.502398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:05.503398 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:51:05.520367 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:51:05.543538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:51:05.555539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAE5E050>]}
[0m02:51:05.570525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECADFBFD0>]}
[0m02:51:05.571522 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:51:05.573542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECACACE80>]}
[0m02:51:05.580518 [info ] [MainThread]: 
[0m02:51:05.603505 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:51:05.616497 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:51:05.651477 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:51:05.652477 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:51:05.653476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:05.762413 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.11 seconds
[0m02:51:05.765413 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:51:05.767410 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:51:05.772408 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:51:05.773408 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:51:05.773408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:05.822378 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:51:05.824379 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:51:05.826377 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:51:05.831376 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:51:05.832373 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:51:05.832373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:05.892341 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:51:05.895338 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:51:05.898335 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:51:05.908330 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:51:05.909329 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:51:05.909329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:05.959302 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:51:05.960301 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:51:05.960301 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:51:05.969297 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:51:05.972295 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:51:05.972295 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:51:05.974293 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:51:05.977291 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:51:05.977291 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:51:05.978291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:06.023266 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:51:06.024263 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:51:06.025263 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:51:06.033258 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:51:06.035258 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:51:06.036257 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:51:06.038256 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:51:06.042253 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:51:06.043254 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:51:06.043254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:06.085228 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:51:06.086229 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:51:06.086229 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:51:06.094226 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:51:06.096223 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:51:06.097223 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:51:06.103219 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:06.104218 [debug] [MainThread]: On master: BEGIN
[0m02:51:06.104218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:06.144195 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m02:51:06.145196 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:06.146194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:51:06.203162 [debug] [MainThread]: SQL status: SELECT 0 in 0.06 seconds
[0m02:51:06.206160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAC98B20>]}
[0m02:51:06.206160 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:06.207159 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:06.207159 [debug] [MainThread]: On master: BEGIN
[0m02:51:06.208159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:51:06.209159 [debug] [MainThread]: On master: COMMIT
[0m02:51:06.209159 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:06.210157 [debug] [MainThread]: On master: COMMIT
[0m02:51:06.210157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.211159 [debug] [MainThread]: On master: Close
[0m02:51:06.211159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:06.212159 [info ] [MainThread]: 
[0m02:51:06.222152 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:51:06.223150 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:51:06.225150 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.226150 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:51:06.228150 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:51:06.232147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.233144 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.234144 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:51:06.297108 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.298107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.299107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:51:06.299107 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:51:06.337087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:51:06.338088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.338088 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:51:06.352994 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:51:06.362990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.362990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:51:06.363987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.368999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.369984 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:51:06.370983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.397983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:51:06.397983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.398970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:51:06.399973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.407965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:51:06.408963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:51:06.414962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:06.416960 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.417959 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:51:06.417959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAF61F60>]}
[0m02:51:06.418957 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.19s]
[0m02:51:06.420954 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:51:06.421957 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:51:06.422954 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:51:06.424954 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.425953 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:51:06.426952 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:51:06.433950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.434947 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.435946 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:51:06.449941 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.450941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.451940 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:51:06.451940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:06.508905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:51:06.509905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.509905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:51:06.522897 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:51:06.528893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.528893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:51:06.529894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.534891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.534891 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:51:06.535891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.540887 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:51:06.540887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.541886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:51:06.542885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.546883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:51:06.546883 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:51:06.551269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:06.553266 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.553266 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:51:06.554265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAF55BD0>]}
[0m02:51:06.555266 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.13s]
[0m02:51:06.557264 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:51:06.557264 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:51:06.558264 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:51:06.561262 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.562262 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:51:06.564269 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:51:06.570257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:51:06.572261 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.573255 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:51:06.591246 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:51:06.593244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.595246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:51:06.595246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:06.639217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:51:06.640217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.640217 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:51:06.657206 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:51:06.663204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.663204 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:51:06.664204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.667201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.668200 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:51:06.669200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.672201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:51:06.673200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.673200 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:51:06.675431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.680259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:51:06.680259 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:51:06.685257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:06.687255 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.688255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:51:06.689254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAFB5180>]}
[0m02:51:06.689254 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:51:06.691255 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:51:06.692253 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:51:06.692253 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:51:06.694252 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.695250 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:51:06.695250 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:51:06.703246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.706244 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.706244 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:51:06.717238 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.718237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.719236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:51:06.719236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:06.766209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:06.766209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.767209 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration" as d
),


profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from unduplicated_duration as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:51:06.841033 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.07 seconds
[0m02:51:06.845029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.845029 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:51:06.846014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.849013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.850014 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:51:06.851012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.854024 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:51:06.854024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.855025 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:51:06.857592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.859593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:51:06.860592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:51:06.866213 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:06.868229 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.868229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:51:06.869214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAF93D30>]}
[0m02:51:06.870213 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.18s]
[0m02:51:06.871644 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:51:06.872648 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:51:06.873646 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:51:06.874646 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.875649 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:51:06.876646 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:51:06.882641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.883840 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.883840 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:51:06.894837 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.897835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.898835 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:51:06.899833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:06.947806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:06.947806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.948808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:51:06.969409 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:51:06.973407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.974407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:51:06.974407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.980410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.980410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:51:06.981408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:06.985388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:51:06.985388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.986385 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:51:06.987384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:06.990383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:51:06.991382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:51:06.996382 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:06.998381 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:06.999380 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:51:07.000377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAFE7F70>]}
[0m02:51:07.001379 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.13s]
[0m02:51:07.002384 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:51:07.003378 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:51:07.004375 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:51:07.006374 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.007374 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:51:07.008373 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:51:07.013391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.015368 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.015368 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:51:07.022402 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.024363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.025364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:51:07.027363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.078335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.079332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.079332 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:51:07.109315 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:51:07.113315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.114312 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:51:07.115311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.120309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.121308 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:51:07.122307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.126305 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:51:07.127304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.127304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:51:07.156290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:51:07.159286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:51:07.160286 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:51:07.165285 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:07.167282 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.168281 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:51:07.169281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAECAE90>]}
[0m02:51:07.170281 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.16s]
[0m02:51:07.172279 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:51:07.173280 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:51:07.173280 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:51:07.175277 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.176277 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:51:07.176277 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:51:07.184272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.186271 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.187270 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:51:07.198264 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.199263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.200263 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:51:07.200263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.251234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.252236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.252236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:51:07.286213 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:51:07.291211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.292210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:51:07.293211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.300206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.301206 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:51:07.302204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.307202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:51:07.307202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.308201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:51:07.309201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:07.314197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:51:07.314197 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:51:07.321194 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:07.323194 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.324192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:51:07.325191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB007EB0>]}
[0m02:51:07.326191 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.15s]
[0m02:51:07.328190 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:51:07.329189 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:51:07.329189 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:51:07.331189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.332189 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:51:07.332189 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:51:07.341183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.344181 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.345180 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:51:07.354176 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.356175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.357174 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:51:07.357174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.408147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.408147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.409145 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:51:07.429131 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:51:07.433131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.434130 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:51:07.435129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.438127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.439126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:51:07.440126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.443124 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:51:07.443124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.444123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:51:07.445676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:07.448678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:51:07.448678 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:51:07.454733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:07.456730 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.457729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:51:07.458729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB01C520>]}
[0m02:51:07.458729 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.13s]
[0m02:51:07.460727 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:51:07.461728 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:51:07.462726 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:51:07.465725 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.465725 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:51:07.466724 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:51:07.471724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.472720 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.473721 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:51:07.481716 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.483715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.483715 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:51:07.484715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.533686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.534686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.535685 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:51:07.586518 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.05 seconds
[0m02:51:07.589530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.590529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:51:07.591515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.594513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.595514 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:51:07.595514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.599524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:51:07.599524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.600525 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:51:07.602593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:07.606581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:51:07.607581 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:51:07.613729 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:07.615733 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.615733 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:51:07.616729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB023D00>]}
[0m02:51:07.617731 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.15s]
[0m02:51:07.619731 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:51:07.620728 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:51:07.621727 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:51:07.623726 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.624726 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:51:07.625726 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:51:07.631722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.633720 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.633720 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:51:07.642716 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.645727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.646730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:51:07.646730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.692703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.693703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.693703 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:51:07.715970 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:51:07.718969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.719969 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:51:07.720968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.723966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.724965 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:51:07.725965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.728964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:51:07.729963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.729963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:51:07.732032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:07.734033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:51:07.735032 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:51:07.740038 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:07.742036 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.743036 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:51:07.744036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB03AD40>]}
[0m02:51:07.745035 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.12s]
[0m02:51:07.747034 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:51:07.748033 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:51:07.748033 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:51:07.750032 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.751031 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:51:07.752031 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:51:07.761026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.763027 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.764026 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:51:07.773020 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.775020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.776018 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:51:07.777017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:07.826987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:07.826987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.827988 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:51:07.859925 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:51:07.866921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.867920 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:51:07.868920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.875916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.876915 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:51:07.877914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:07.884910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:51:07.884910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.885910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:51:07.888908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:07.897903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:51:07.898903 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:51:07.907897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:07.910895 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:07.911895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:51:07.912894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB0652A0>]}
[0m02:51:07.913894 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.16s]
[0m02:51:07.916892 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:51:07.916892 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:51:07.917892 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:51:07.919891 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:07.920891 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:51:07.921890 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:51:08.019834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.025830 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:08.026829 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:51:08.040821 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.051815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.052814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:51:08.052814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:08.120776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m02:51:08.121776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.121776 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:51:08.189591 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.07 seconds
[0m02:51:08.197586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.198585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:51:08.199586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:08.207582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.208582 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:51:08.209580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:08.214578 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:51:08.214578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.215576 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:51:08.218574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:08.222573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:51:08.223572 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:51:08.229568 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:51:08.231567 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:08.232567 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:51:08.233566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB055720>]}
[0m02:51:08.233566 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.31s]
[0m02:51:08.235567 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:51:08.236565 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:51:08.236565 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:51:08.238564 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.239564 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:51:08.240563 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:51:08.246558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.248557 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:08.249557 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:51:08.257552 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.258553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.259552 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:51:08.259552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:08.306524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:08.306524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.307524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:51:08.939990 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.63 seconds
[0m02:51:08.942987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.943987 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:51:08.943987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:08.947999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.947999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:51:08.948983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:08.951983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:51:08.952983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.952983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:51:08.955346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:51:08.957367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:51:08.958367 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:51:08.964041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:08.966059 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:08.966059 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:51:08.967044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAC2BDF0>]}
[0m02:51:08.968041 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.73s]
[0m02:51:08.970040 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:51:08.971045 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:51:08.972042 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:51:08.973055 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:08.974038 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:51:08.974038 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:51:08.983033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:08.984796 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:08.984796 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:51:08.991797 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:08.993793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:08.994793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:51:08.995793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:51:09.047912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:51:09.047912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:09.048911 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:51:09.063150 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.01 seconds
[0m02:51:09.067132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:09.068132 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:51:09.069133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:09.074128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:09.075127 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:51:09.076127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:51:09.081126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:51:09.081126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:09.082126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:51:09.104184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:51:09.107200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:51:09.107200 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:51:09.113692 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:51:09.115682 [debug] [Thread-1 (]: finished collecting timing info
[0m02:51:09.115682 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:51:09.117679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f5cd40-1d9e-4d30-90e2-a0f558697de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECB01FF40>]}
[0m02:51:09.118680 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.14s]
[0m02:51:09.120677 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:51:09.123676 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:51:09.124676 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:09.124676 [debug] [MainThread]: On master: BEGIN
[0m02:51:09.125675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:09.173659 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:51:09.174647 [debug] [MainThread]: On master: COMMIT
[0m02:51:09.174647 [debug] [MainThread]: Using postgres connection "master"
[0m02:51:09.175646 [debug] [MainThread]: On master: COMMIT
[0m02:51:09.176646 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:09.176646 [debug] [MainThread]: On master: Close
[0m02:51:09.177646 [info ] [MainThread]: 
[0m02:51:09.178644 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m02:51:09.180648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:09.180648 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:51:09.181643 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m02:51:09.181643 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:51:09.198637 [info ] [MainThread]: 
[0m02:51:09.199633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:51:09.201632 [info ] [MainThread]: 
[0m02:51:09.203630 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:51:09.205636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAB6DCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAB6E0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014ECAE3A2F0>]}


============================== 2022-11-23 02:52:41.130800 | f3dddc25-1564-44a0-be83-10bddcc95efd ==============================
[0m02:52:41.130800 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:52:41.131800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:52:41.132781 [debug] [MainThread]: Tracking: tracking
[0m02:52:41.152767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AABCE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AAE0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AAE0730>]}
[0m02:52:41.248715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:41.249714 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:52:41.268702 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:52:41.293688 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:52:41.305683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AC4B3A0>]}
[0m02:52:41.319680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AC0BFD0>]}
[0m02:52:41.319680 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:52:41.322673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AABCE80>]}
[0m02:52:41.327668 [info ] [MainThread]: 
[0m02:52:41.328679 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:52:41.332234 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:52:41.349229 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:52:41.350229 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:52:41.350229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:41.410213 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m02:52:41.412213 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:52:41.413195 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:52:41.416193 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:52:41.416193 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:52:41.417192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:41.455172 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:52:41.457171 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:52:41.458169 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:52:41.461167 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:52:41.462167 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:52:41.462167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:41.504154 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:52:41.506144 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:52:41.510155 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:52:41.517150 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:52:41.517150 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:52:41.518137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:41.565698 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:52:41.565698 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:52:41.566700 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:52:41.575692 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:52:41.577692 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:52:41.578690 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:52:41.579691 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:52:41.582689 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:52:41.583687 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:52:41.583687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:41.767671 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m02:52:41.768666 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:52:41.769670 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:52:41.779661 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:52:41.782673 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:52:41.783656 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:52:41.784656 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:52:41.787654 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:52:41.787654 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:52:41.788654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:41.835629 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:52:41.836626 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:52:41.836626 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:52:41.845621 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:52:41.848620 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:52:41.849619 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:52:41.857617 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:41.858616 [debug] [MainThread]: On master: BEGIN
[0m02:52:41.858616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:41.910584 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:52:41.910584 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:41.911585 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:41.975549 [debug] [MainThread]: SQL status: SELECT 0 in 0.06 seconds
[0m02:52:41.977547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AAAA590>]}
[0m02:52:41.978547 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:41.978547 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:41.979545 [debug] [MainThread]: On master: BEGIN
[0m02:52:41.980545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:41.980545 [debug] [MainThread]: On master: COMMIT
[0m02:52:41.980545 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:41.981545 [debug] [MainThread]: On master: COMMIT
[0m02:52:41.982544 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:41.982544 [debug] [MainThread]: On master: Close
[0m02:52:41.983542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:41.985542 [info ] [MainThread]: 
[0m02:52:41.994537 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:52:41.995539 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:52:41.996538 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:41.997535 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:52:41.997535 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:52:42.002535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.004531 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.005530 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:52:42.077488 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.079488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.079488 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:52:42.080488 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:52:42.118465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:52:42.119466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.119466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:52:42.135257 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:52:42.144251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.144251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:52:42.145252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.150264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.151263 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:52:42.152250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.181245 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:52:42.182245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.182245 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:52:42.184524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:42.190523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:52:42.191523 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:52:42.195995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:42.197895 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.198894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:52:42.198894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACE0970>]}
[0m02:52:42.199894 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.20s]
[0m02:52:42.201645 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:52:42.202664 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:52:42.203647 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:52:42.205649 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.206646 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:52:42.206646 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:52:42.212642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.213657 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.214653 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:52:42.219653 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.220637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.221638 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:52:42.222650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:42.275608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:42.275608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.276606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:52:42.286712 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:52:42.291708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.292708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:52:42.293709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.296706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.296706 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:52:42.297706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.300719 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:52:42.301718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.301718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:52:42.332689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m02:52:42.335306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:52:42.336305 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:52:42.340318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:42.342302 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.343301 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:52:42.343301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACE0490>]}
[0m02:52:42.344300 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.14s]
[0m02:52:42.346299 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:52:42.347299 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:52:42.347299 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:52:42.349298 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.350297 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:52:42.350297 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:52:42.359292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:52:42.361309 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.362290 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:52:42.368287 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:52:42.370286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.370286 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:52:42.370286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:42.554019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.18 seconds
[0m02:52:42.555018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.556017 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:52:42.573098 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:52:42.578096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.579074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:52:42.580074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.583093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.584072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:52:42.585072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.590069 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:52:42.591070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.591070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:52:42.595067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:42.599064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:52:42.601073 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:52:42.610057 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:42.612058 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.613058 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:52:42.614055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ADC5180>]}
[0m02:52:42.615054 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.27s]
[0m02:52:42.617053 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:52:42.617053 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:52:42.618055 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:52:42.619054 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:52:42.620054 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:52:42.620054 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:52:42.631062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:52:42.633044 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.633044 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:52:42.640039 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:52:42.642040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:52:42.643039 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:52:42.643039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:42.691021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:42.692021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:52:42.693010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    
/*
with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration" as d
),*/

profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:52:42.694011 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «profiled_data»
LINE 16: profiled_data as (
         ^

[0m02:52:42.694011 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m02:52:42.695008 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.695008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:52:42.696007 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  error de sintaxis en o cerca de «profiled_data»
  LINE 16: profiled_data as (
           ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:52:42.697007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACBDD20>]}
[0m02:52:42.698007 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.08s]
[0m02:52:42.700007 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:52:42.701005 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:52:42.702014 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:52:42.703006 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.704003 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:52:42.705003 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:52:42.712001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.712998 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.713999 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:52:42.719994 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.720996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.721993 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:52:42.722993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:42.769966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:42.769966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.770965 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:52:42.792290 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:52:42.796273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.796273 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:52:42.797274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.801270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.801270 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:52:42.802269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.807267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:52:42.807267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.808266 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:52:42.810013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:42.813013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:52:42.813013 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:52:42.818973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:42.820972 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.821972 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:52:42.822973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACBF8B0>]}
[0m02:52:42.823971 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.12s]
[0m02:52:42.826969 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:52:42.827969 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:52:42.827969 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:52:42.830967 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.831967 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:52:42.832967 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:52:42.843961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.846959 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.847959 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:52:42.864948 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.867946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.867946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:52:42.868945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:42.917922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:42.918916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.918916 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:52:42.950898 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:52:42.954898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.954898 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:52:42.955895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.959893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.959893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:52:42.960892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:42.965890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:52:42.965890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.966889 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:52:42.968888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:42.972886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:52:42.973886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:52:42.979882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:42.981880 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.981880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:52:42.982880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACE1450>]}
[0m02:52:42.983880 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.15s]
[0m02:52:42.985878 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:52:42.986879 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:52:42.987877 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:52:42.988878 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:42.989876 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:52:42.990876 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:52:42.997872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:42.998872 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:42.999870 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:52:43.008865 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.010865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.011863 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:52:43.012863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.077825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m02:52:43.078826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.078826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:52:43.180766 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.1 seconds
[0m02:52:43.186763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.186763 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:52:43.187764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.193759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.193759 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:52:43.194759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.199755 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:52:43.200755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.200755 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:52:43.202755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:43.206752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:52:43.207751 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:52:43.213748 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:43.215747 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.215747 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:52:43.216746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AE01390>]}
[0m02:52:43.217747 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.23s]
[0m02:52:43.219745 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:52:43.221743 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:52:43.221743 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:52:43.223742 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.224743 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:52:43.225741 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:52:43.231738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.234737 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.235736 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:52:43.249727 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.250728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.251727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:52:43.251727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.391647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.14 seconds
[0m02:52:43.391647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.392646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:52:43.420629 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:52:43.424628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.425628 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:52:43.426626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.431624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.432623 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:52:43.433623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.437621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:52:43.438619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.438619 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:52:43.440620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:43.445615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:52:43.445615 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:52:43.451612 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:43.453611 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.454610 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:52:43.455610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AE2C6A0>]}
[0m02:52:43.456609 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.23s]
[0m02:52:43.458608 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:52:43.459608 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:52:43.460607 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:52:43.462606 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.462606 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:52:43.463605 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:52:43.469603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.471601 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.472604 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:52:43.481595 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.482594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.483594 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:52:43.484593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.538564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:43.540565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.541562 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:52:43.564549 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:52:43.568545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.569545 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:52:43.570544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.575541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.575541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:52:43.576542 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.579539 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:52:43.580538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.580538 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:52:43.582623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:43.584624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:52:43.585623 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:52:43.591403 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:43.593403 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.593403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:52:43.594401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AD1DA50>]}
[0m02:52:43.595400 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.13s]
[0m02:52:43.597400 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:52:43.598399 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:52:43.599398 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:52:43.600397 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.601397 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:52:43.602397 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:52:43.608393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.610391 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.610391 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:52:43.624383 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.626383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.627383 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:52:43.627383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.674355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:43.674355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.675355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:52:43.727799 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.05 seconds
[0m02:52:43.731782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.731782 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:52:43.732783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.735780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.736779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:52:43.737780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.740792 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:52:43.741791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.741791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:52:43.744177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:43.746193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:52:43.747192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:52:43.752872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:43.754874 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.754874 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:52:43.755875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACE1060>]}
[0m02:52:43.756872 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.16s]
[0m02:52:43.758871 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:52:43.759872 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:52:43.759872 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:52:43.760869 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.761871 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:52:43.762869 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:52:43.768877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.770864 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.771864 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:52:43.781858 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.783857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.785856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:52:43.785856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.837827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:43.838826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.839825 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:52:43.860812 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:52:43.863810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.864810 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:52:43.864810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.868808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.868808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:52:43.869808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:43.873805 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:52:43.873805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.874804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:52:43.876510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:43.879511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:52:43.879511 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:52:43.885266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:43.887268 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.888265 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:52:43.889265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ACE0FA0>]}
[0m02:52:43.890280 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:52:43.892263 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:52:43.893262 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:52:43.894261 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:52:43.896261 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:43.897260 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:52:43.898260 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:52:43.909264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:52:43.910252 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:43.911252 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:52:43.920249 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:52:43.922247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:43.923245 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:52:43.924244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:43.971217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:43.972219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:43.973216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:52:43.997190 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:52:44.003172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:44.003172 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:52:44.005172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.051144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:44.051144 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:52:44.052143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.056142 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:52:44.056142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:44.057141 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:52:44.058583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:44.060600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:52:44.060600 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:52:44.066052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:44.069054 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:44.069054 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:52:44.070041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AAAE380>]}
[0m02:52:44.071038 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.17s]
[0m02:52:44.073037 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:52:44.073037 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:52:44.074039 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:52:44.075038 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.076036 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:52:44.076036 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:52:44.084032 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.085030 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:44.087029 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:52:44.096027 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.098023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.099023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:52:44.100021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:44.148993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:44.148993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.149993 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:52:44.813003 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.66 seconds
[0m02:52:44.817016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.817016 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:52:44.818017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.820999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.821998 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:52:44.822999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.825996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:52:44.825996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.826998 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:52:44.828859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:44.831861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:52:44.832859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:52:44.838757 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:52:44.840759 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:44.840759 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:52:44.841756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AE51750>]}
[0m02:52:44.842756 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.77s]
[0m02:52:44.844757 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:52:44.845757 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:52:44.846765 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:52:44.847754 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.848753 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:52:44.849752 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:52:44.857748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.859746 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:44.859746 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:52:44.869741 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.872744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.873738 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:52:44.874737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:44.923870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:52:44.924857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.924857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:52:44.940202 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.01 seconds
[0m02:52:44.946184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.947779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:52:44.948780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.951778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.952777 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:52:44.953780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:52:44.956777 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:52:44.957777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.957777 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:52:44.959887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:52:44.961889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:52:44.962888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:52:44.967887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:52:44.969884 [debug] [Thread-1 (]: finished collecting timing info
[0m02:52:44.970884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:52:44.971883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3dddc25-1564-44a0-be83-10bddcc95efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AE1B700>]}
[0m02:52:44.972883 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.12s]
[0m02:52:44.973882 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:52:44.975881 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:52:44.976882 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:44.976882 [debug] [MainThread]: On master: BEGIN
[0m02:52:44.977880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:45.031850 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:52:45.031850 [debug] [MainThread]: On master: COMMIT
[0m02:52:45.032849 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:45.032849 [debug] [MainThread]: On master: COMMIT
[0m02:52:45.033848 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:45.033848 [debug] [MainThread]: On master: Close
[0m02:52:45.034848 [info ] [MainThread]: 
[0m02:52:45.035847 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m02:52:45.036846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:45.037846 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:52:45.038845 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m02:52:45.039845 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:52:45.057834 [info ] [MainThread]: 
[0m02:52:45.058834 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:52:45.060835 [info ] [MainThread]: 
[0m02:52:45.063833 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m02:52:45.064832 [error] [MainThread]:   error de sintaxis en o cerca de «profiled_data»
[0m02:52:45.066830 [error] [MainThread]:   LINE 16: profiled_data as (
[0m02:52:45.067829 [error] [MainThread]:            ^
[0m02:52:45.069828 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:52:45.071827 [info ] [MainThread]: 
[0m02:52:45.074825 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m02:52:45.075829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ADEBCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611AE190F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611ADFEF80>]}


============================== 2022-11-23 02:53:17.538446 | 6245cce4-20c2-41e8-9c43-581a8527e375 ==============================
[0m02:53:17.538446 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:53:17.539446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:17.540443 [debug] [MainThread]: Tracking: tracking
[0m02:53:17.557350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAB3DCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAB549A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAB54730>]}
[0m02:53:17.649669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:17.650668 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:53:17.665661 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:53:17.689131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:53:17.700143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFACEE050>]}
[0m02:53:17.715116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAC8BFD0>]}
[0m02:53:17.715116 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:53:17.716988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAB3DCF0>]}
[0m02:53:17.720009 [info ] [MainThread]: 
[0m02:53:17.721989 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:53:17.726985 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:53:17.784952 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:53:17.785951 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:53:17.793946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:17.877898 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.08 seconds
[0m02:53:17.878909 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:53:17.880897 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:53:17.882896 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:53:17.883894 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:53:17.883894 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:17.929870 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:53:17.931867 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:53:17.932867 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:53:17.939863 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:53:17.940862 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:53:17.940862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:17.995831 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:53:17.997830 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:53:18.000828 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:53:18.009823 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:53:18.010822 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:53:18.011822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:18.057795 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:53:18.058797 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:53:18.058797 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:53:18.067791 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:53:18.069790 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:53:18.070789 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:53:18.071787 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:53:18.077784 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:53:18.077784 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:53:18.078784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:18.120759 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:53:18.121759 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:53:18.122761 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:53:18.131753 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:53:18.133754 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:53:18.134752 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:53:18.135751 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:53:18.140748 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:53:18.140748 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:53:18.141747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:18.190720 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m02:53:18.190720 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:53:18.191719 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:53:18.199714 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:53:18.201715 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:53:18.202713 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:53:18.209710 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:18.210710 [debug] [MainThread]: On master: BEGIN
[0m02:53:18.210710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:18.257684 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:53:18.258681 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:18.258681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:18.303654 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m02:53:18.305656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAB2BE50>]}
[0m02:53:18.306654 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:18.307652 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:18.307652 [debug] [MainThread]: On master: BEGIN
[0m02:53:18.308653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:18.309652 [debug] [MainThread]: On master: COMMIT
[0m02:53:18.309652 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:18.310651 [debug] [MainThread]: On master: COMMIT
[0m02:53:18.310651 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:18.311651 [debug] [MainThread]: On master: Close
[0m02:53:18.311651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:18.313561 [info ] [MainThread]: 
[0m02:53:18.322560 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:53:18.323559 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:53:18.328557 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.329555 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:53:18.330558 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:53:18.334554 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.335555 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.336551 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:53:18.398515 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.400516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.400516 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:53:18.401515 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:53:18.440491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:53:18.441491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.441491 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:53:18.455248 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m02:53:18.463244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.464244 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:53:18.465243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.471254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.471254 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:53:18.472240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.528206 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:53:18.528206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.529207 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:53:18.531100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:18.538099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:53:18.538099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:53:18.543096 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:18.546094 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.547093 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:53:18.548093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFADF1F60>]}
[0m02:53:18.549092 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.22s]
[0m02:53:18.551092 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:53:18.551092 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:53:18.552091 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:53:18.554090 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.555089 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:53:18.555089 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:53:18.560086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.562086 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.563085 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:53:18.576078 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.577077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.578077 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:53:18.579077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:18.630047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:18.631046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.631046 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:53:18.641959 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:53:18.645956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.646956 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:53:18.647956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.650955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.651954 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:53:18.651954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.656950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:53:18.656950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.657950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:53:18.659949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:18.662947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:53:18.662947 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:53:18.667944 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:18.669943 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.670942 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:53:18.671941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFADE5BD0>]}
[0m02:53:18.672943 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m02:53:18.674940 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:53:18.675940 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:53:18.676939 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:53:18.678939 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.679938 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:53:18.679938 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:53:18.694930 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:53:18.696928 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.697927 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:53:18.708922 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:53:18.710919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.710919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:53:18.711919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:18.754894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:53:18.755894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.756893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:53:18.798520 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:53:18.804517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.804517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:53:18.805518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.809513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.809513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:53:18.810514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:18.814512 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:53:18.814512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.815511 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:53:18.817624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:18.819641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:53:18.820640 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:53:18.825896 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:53:18.827911 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.827911 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:53:18.828897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAE45180>]}
[0m02:53:18.829894 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.15s]
[0m02:53:18.831893 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:53:18.831893 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:53:18.832894 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:53:18.834892 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.834892 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:53:18.835891 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:53:18.847895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.848898 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:18.849884 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:53:18.855879 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.857878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.858878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:53:18.858878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:18.902852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:53:18.903854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.904851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    
/*
with unduplicated_duration as (
    select distinct
    d.artist,
    d.song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration" as d
),*/

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select * from profiled_data
  );
[0m02:53:18.993244 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.09 seconds
[0m02:53:18.997260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:18.997260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m02:53:18.998260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.002257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:19.002257 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m02:53:19.003239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.007236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:53:19.008233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:19.008233 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m02:53:19.011231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:19.013231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:53:19.014230 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m02:53:19.020226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:53:19.022232 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.022232 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:53:19.024225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAC940D0>]}
[0m02:53:19.025224 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.19s]
[0m02:53:19.027225 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:53:19.027225 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:53:19.028238 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:53:19.030222 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.031221 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:53:19.032221 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:53:19.038217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.040216 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.041215 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:53:19.049212 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.051209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.052211 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:53:19.053210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.099181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.100181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.100181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:53:19.121471 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m02:53:19.125468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.125468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:53:19.127467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.132465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.132465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:53:19.134463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.137462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:53:19.137462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.138477 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:53:19.160778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:53:19.163779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:53:19.163779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:53:19.168965 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.170967 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.171966 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:53:19.172963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAE77D30>]}
[0m02:53:19.173963 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.14s]
[0m02:53:19.175962 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:53:19.175962 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:53:19.176961 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:53:19.178960 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.178960 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:53:19.179960 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:53:19.185971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.186958 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.187955 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:53:19.198959 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.199963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.200948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:53:19.200948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.250921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.251918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.251918 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:53:19.280901 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.03 seconds
[0m02:53:19.284900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.285900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:53:19.286898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.289896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.290895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:53:19.291895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.294894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:53:19.295893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.295893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:53:19.298891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:19.301891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:53:19.302890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:53:19.306886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.308887 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.309886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:53:19.310885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAD5BD60>]}
[0m02:53:19.311884 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.13s]
[0m02:53:19.313883 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:53:19.314883 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:53:19.315881 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:53:19.317881 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.318880 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:53:19.319880 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:53:19.328875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.330874 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.331873 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:53:19.341866 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.342866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.343867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:53:19.344865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.397836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.397836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.398836 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:53:19.426818 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:53:19.430817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.431815 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:53:19.432814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.437812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.438813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:53:19.439810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.444808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:53:19.444808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.445808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:53:19.446807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:19.449805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:53:19.450804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:53:19.454802 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.456803 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.457801 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:53:19.458801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAE97E50>]}
[0m02:53:19.459799 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.14s]
[0m02:53:19.461799 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:53:19.462799 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:53:19.463798 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:53:19.465796 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.466796 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:53:19.467796 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:53:19.476791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.478796 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.479789 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:53:19.487783 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.490791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.491781 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:53:19.491781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.545752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.546750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.547750 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:53:19.573736 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:53:19.577733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.578732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:53:19.579731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.585728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.585728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:53:19.586726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.591724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:53:19.592723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.592723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:53:19.615673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:53:19.618675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:53:19.619675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:53:19.623672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.625671 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.626670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:53:19.626670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAEAC4C0>]}
[0m02:53:19.627670 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.16s]
[0m02:53:19.629668 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:53:19.630667 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:53:19.631667 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:53:19.633666 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.634666 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:53:19.635665 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:53:19.644662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.646660 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.647657 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:53:19.652656 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.653655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.655655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:53:19.656653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.718618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:53:19.719619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.720616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:53:19.741887 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:53:19.745886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.745886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:53:19.746885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.750882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.750882 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:53:19.751883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.755880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:53:19.755880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.756879 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:53:19.759597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:19.764597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:53:19.764597 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:53:19.769594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.771593 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.772594 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:53:19.773592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAEB3D00>]}
[0m02:53:19.774591 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.14s]
[0m02:53:19.775591 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:53:19.776590 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:53:19.777590 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:53:19.778590 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.779589 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:53:19.780588 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:53:19.785585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.786584 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.787584 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:53:19.796579 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.798577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.799577 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:53:19.799577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.848549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.849548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.849548 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:53:19.871535 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:53:19.876533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.876533 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:53:19.877533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.881531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.882531 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:53:19.883529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:19.886527 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:53:19.887527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.887527 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:53:19.889928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:19.892931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:53:19.893928 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:53:19.897562 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:19.899562 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.899562 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:53:19.900561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAECAD40>]}
[0m02:53:19.901560 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.12s]
[0m02:53:19.903559 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:53:19.904559 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:53:19.904559 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:53:19.906558 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:19.907557 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:53:19.908557 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:53:19.913553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:53:19.915552 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:19.915552 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:53:19.922553 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:53:19.924547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:19.925547 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:53:19.925547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:19.973946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:19.974942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:19.974942 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:53:20.007508 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:53:20.014504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:20.015504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:53:20.016503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:20.022500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:20.023500 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:53:20.024499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:20.030495 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:53:20.031494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:20.032496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:53:20.034493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:20.042489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:53:20.043487 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:53:20.049485 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:53:20.052483 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:20.053483 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:53:20.054481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAEF45B0>]}
[0m02:53:20.056481 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.15s]
[0m02:53:20.058480 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:53:20.059479 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:53:20.059479 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:53:20.061478 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.062478 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:53:20.063477 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:53:20.163420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.164419 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:20.165418 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:53:20.176412 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.178411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.178411 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:53:20.179410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:20.256367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m02:53:20.256367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.257366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:53:20.330001 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.07 seconds
[0m02:53:20.335997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.336995 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:53:20.337995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:20.342992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.343991 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:53:20.344991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:20.347989 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:53:20.348988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.348988 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:53:20.351497 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:20.355498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:53:20.356496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:53:20.360219 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:20.363216 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:20.364216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:53:20.365216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAEE54E0>]}
[0m02:53:20.366215 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.30s]
[0m02:53:20.369214 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:53:20.370213 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:53:20.371213 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:53:20.373212 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:20.374211 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:53:20.375210 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:53:20.382206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:20.384205 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:20.384205 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:53:20.390202 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:20.392201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:20.393200 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:53:20.393200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:20.447169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:20.448169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:20.448169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:53:21.125626 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.68 seconds
[0m02:53:21.128624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:21.129624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:53:21.130610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:21.133607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:21.133607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:53:21.134608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:21.137620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:53:21.138619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:21.138619 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:53:21.141112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:21.144133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:53:21.144133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:53:21.148829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:21.150852 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:21.150852 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:53:21.151831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAABBDF0>]}
[0m02:53:21.152830 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.78s]
[0m02:53:21.154829 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:53:21.155831 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:53:21.156828 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:53:21.157827 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.158828 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:53:21.158828 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:53:21.170823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.172831 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:21.173818 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:53:21.181814 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.182818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.183813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:53:21.185816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:21.233642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:53:21.233642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.234643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:53:21.249775 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:53:21.255772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.255772 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:53:21.256772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:21.260784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.260784 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:53:21.261784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:21.265768 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:53:21.265768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.266767 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:53:21.268624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:53:21.270641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:53:21.271627 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:53:21.276075 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:53:21.278093 [debug] [Thread-1 (]: finished collecting timing info
[0m02:53:21.278093 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:53:21.279092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6245cce4-20c2-41e8-9c43-581a8527e375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFAEAD3C0>]}
[0m02:53:21.280076 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.12s]
[0m02:53:21.282074 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:53:21.284073 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:53:21.285072 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:21.286073 [debug] [MainThread]: On master: BEGIN
[0m02:53:21.286073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:21.336400 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m02:53:21.336400 [debug] [MainThread]: On master: COMMIT
[0m02:53:21.337396 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:21.337396 [debug] [MainThread]: On master: COMMIT
[0m02:53:21.339396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:21.340398 [debug] [MainThread]: On master: Close
[0m02:53:21.341394 [info ] [MainThread]: 
[0m02:53:21.342396 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m02:53:21.343394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:21.344395 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:53:21.345394 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m02:53:21.345394 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:53:21.361384 [info ] [MainThread]: 
[0m02:53:21.363384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:21.364382 [info ] [MainThread]: 
[0m02:53:21.366384 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m02:53:21.368391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFA9FF8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFA9FD6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFACC8670>]}


============================== 2022-11-23 02:57:42.397311 | 4646bd73-80fd-4387-bb13-70677e737565 ==============================
[0m02:57:42.397311 [info ] [MainThread]: Running with dbt=1.2.0
[0m02:57:42.398311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:42.399311 [debug] [MainThread]: Tracking: tracking
[0m02:57:42.419298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248BFDEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248C209A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248C20730>]}
[0m02:57:42.516258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:42.517257 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m02:57:42.533235 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m02:57:42.558028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m02:57:42.569678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248DAE050>]}
[0m02:57:42.584673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248D4BFD0>]}
[0m02:57:42.585652 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m02:57:42.586918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248BFDEA0>]}
[0m02:57:42.590921 [info ] [MainThread]: 
[0m02:57:42.592919 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:57:42.597824 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:57:42.613832 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:57:42.614831 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:57:42.614831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:42.667536 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:57:42.669535 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:57:42.671534 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:57:42.676534 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:57:42.676534 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:57:42.677530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:42.729500 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m02:57:42.730501 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:57:42.731499 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m02:57:42.734498 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m02:57:42.735496 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m02:57:42.735496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:42.779472 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m02:57:42.781471 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m02:57:42.784469 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:57:42.791464 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:57:42.792464 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m02:57:42.792464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:42.834441 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:57:42.835441 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m02:57:42.835441 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m02:57:42.848433 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m02:57:42.850433 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m02:57:42.851432 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m02:57:42.852430 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:57:42.856430 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:57:42.858427 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m02:57:42.858427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:42.899403 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:57:42.900403 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m02:57:42.900403 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m02:57:42.908398 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m02:57:42.910397 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m02:57:42.911397 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m02:57:42.912396 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:57:42.915395 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:57:42.915395 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m02:57:42.916393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:42.956371 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m02:57:42.956371 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m02:57:42.957372 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m02:57:42.966365 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m02:57:42.970363 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m02:57:42.971362 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m02:57:42.982358 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:42.983358 [debug] [MainThread]: On master: BEGIN
[0m02:57:42.983358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:43.145282 [debug] [MainThread]: SQL status: BEGIN in 0.16 seconds
[0m02:57:43.145282 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:43.146284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:43.192750 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m02:57:43.194752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248BEA5F0>]}
[0m02:57:43.195749 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:43.195749 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:43.196749 [debug] [MainThread]: On master: BEGIN
[0m02:57:43.197748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:43.197748 [debug] [MainThread]: On master: COMMIT
[0m02:57:43.198748 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:43.198748 [debug] [MainThread]: On master: COMMIT
[0m02:57:43.199747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:43.199747 [debug] [MainThread]: On master: Close
[0m02:57:43.200746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:43.202464 [info ] [MainThread]: 
[0m02:57:43.210463 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m02:57:43.212464 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m02:57:43.214460 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.215460 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m02:57:43.216460 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m02:57:43.219478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.221459 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.221459 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m02:57:43.295418 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.297413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.297413 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m02:57:43.298415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:57:43.341388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:57:43.342399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.342399 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m02:57:43.360379 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.02 seconds
[0m02:57:43.374369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.374369 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m02:57:43.376370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.383364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.383364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m02:57:43.384363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.431336 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:57:43.432336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.433336 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m02:57:43.434336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:43.444329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m02:57:43.444329 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m02:57:43.450326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:43.453325 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.454324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m02:57:43.455323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248EB2110>]}
[0m02:57:43.456323 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.24s]
[0m02:57:43.458322 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m02:57:43.459322 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m02:57:43.460321 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m02:57:43.464320 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.465318 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m02:57:43.466318 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m02:57:43.475318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.477311 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.478311 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m02:57:43.491303 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.493302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.494303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m02:57:43.495301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:43.553270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:57:43.553270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.554267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m02:57:43.566261 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m02:57:43.571257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.572260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m02:57:43.574255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.579252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.580251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m02:57:43.581251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.584251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:57:43.585250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.585250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m02:57:43.587248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:43.590247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m02:57:43.591246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m02:57:43.595243 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:43.597242 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.598241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m02:57:43.599242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248EA5D80>]}
[0m02:57:43.600241 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.14s]
[0m02:57:43.601239 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m02:57:43.602239 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m02:57:43.602239 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m02:57:43.604239 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.605238 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m02:57:43.606237 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m02:57:43.616231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:57:43.617230 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.618230 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m02:57:43.630223 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m02:57:43.631222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.632223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m02:57:43.632223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:43.680197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:43.681194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.682195 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m02:57:43.704181 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:57:43.710177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.711176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m02:57:43.712177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.715175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.716175 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m02:57:43.717173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.720171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:57:43.720171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.721170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m02:57:43.723171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:43.726167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m02:57:43.726167 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m02:57:43.732020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:43.734020 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.735018 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m02:57:43.736017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F05180>]}
[0m02:57:43.737019 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.13s]
[0m02:57:43.738016 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m02:57:43.739016 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m02:57:43.740017 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m02:57:43.741016 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:57:43.742016 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m02:57:43.743014 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m02:57:43.750009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:57:43.751009 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.752010 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m02:57:43.759005 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m02:57:43.762005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:57:43.763007 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m02:57:43.764003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:43.812973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:43.812973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m02:57:43.813974 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
)

select ROW_NUMBER() OVER(ORDER BY (pf.song)) AS pf.id_song, * from profiled_data as pf
  );
[0m02:57:43.814972 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «.»
LINE 36: select ROW_NUMBER() OVER(ORDER BY (pf.song)) AS pf.id_song, ...
                                                           ^

[0m02:57:43.814972 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m02:57:43.815972 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.815972 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m02:57:43.816972 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  error de sintaxis en o cerca de «.»
  LINE 36: select ROW_NUMBER() OVER(ORDER BY (pf.song)) AS pf.id_song, ...
                                                             ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:57:43.817972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248E12500>]}
[0m02:57:43.817972 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.08s]
[0m02:57:43.819970 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m02:57:43.819970 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:57:43.820970 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m02:57:43.822969 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.823968 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m02:57:43.824968 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m02:57:43.831964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.832962 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.833963 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m02:57:43.842957 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.843956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.844957 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m02:57:43.845955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:43.894929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:43.895927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.895927 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m02:57:43.936976 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.04 seconds
[0m02:57:43.940975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.941975 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m02:57:43.942974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.945971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.946970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m02:57:43.946970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:43.950968 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:57:43.950968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.951967 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m02:57:43.953635 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:43.955636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m02:57:43.956635 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m02:57:43.961516 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:43.963515 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.963515 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m02:57:43.964514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248EB34F0>]}
[0m02:57:43.965514 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.14s]
[0m02:57:43.967514 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m02:57:43.967514 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:57:43.968513 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m02:57:43.969512 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:43.970512 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:57:43.971511 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m02:57:43.980507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:43.981506 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:43.982504 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:57:43.991500 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:43.993498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:43.994498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m02:57:43.994498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.038475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m02:57:44.039472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:44.040481 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m02:57:44.066141 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.02 seconds
[0m02:57:44.070140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:44.070140 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m02:57:44.071139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.075138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:44.075138 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m02:57:44.076136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.079150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:57:44.080149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:44.080149 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m02:57:44.082808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.084810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m02:57:44.085809 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m02:57:44.091816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:44.093804 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.093804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m02:57:44.094805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248E21510>]}
[0m02:57:44.096818 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.13s]
[0m02:57:44.098802 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m02:57:44.099801 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:57:44.099801 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m02:57:44.101800 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.101800 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m02:57:44.102802 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m02:57:44.110795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.111814 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.112793 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m02:57:44.119791 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.120791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.121788 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m02:57:44.121788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.168761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:44.169763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.170760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m02:57:44.195745 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m02:57:44.199743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.199743 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m02:57:44.200743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.204741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.204741 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m02:57:44.205739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.209737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:57:44.209737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.210737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m02:57:44.211897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.213899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m02:57:44.214898 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m02:57:44.219815 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:44.221825 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.222814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m02:57:44.223813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248EA4160>]}
[0m02:57:44.223813 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.12s]
[0m02:57:44.225815 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m02:57:44.226813 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m02:57:44.226813 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m02:57:44.228813 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.229810 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m02:57:44.229810 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m02:57:44.235810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.237804 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.237804 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m02:57:44.253798 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.254795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.255795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m02:57:44.255795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.308765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:44.309764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.310763 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m02:57:44.351740 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:57:44.358735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.359735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m02:57:44.360735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.367730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.368730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m02:57:44.369729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.375728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:57:44.375728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.376725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m02:57:44.397713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m02:57:44.403711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m02:57:44.403711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m02:57:44.412705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:44.415704 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.416703 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m02:57:44.417702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F6C640>]}
[0m02:57:44.418701 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.19s]
[0m02:57:44.420701 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m02:57:44.421700 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m02:57:44.422699 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m02:57:44.424698 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.425698 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m02:57:44.426697 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m02:57:44.436691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.437691 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.439690 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m02:57:44.460678 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.463677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.464675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m02:57:44.465675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.543630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m02:57:44.544629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.545629 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m02:57:44.574613 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m02:57:44.578610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.579609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m02:57:44.580610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.583607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.584606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m02:57:44.585607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.588605 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:57:44.589604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.590604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m02:57:44.592201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.595202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m02:57:44.595202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m02:57:44.600290 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:44.602288 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.603287 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m02:57:44.604287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248E19780>]}
[0m02:57:44.605286 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.18s]
[0m02:57:44.607285 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m02:57:44.608285 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m02:57:44.609284 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m02:57:44.611283 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.612285 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m02:57:44.613283 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m02:57:44.619280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.621279 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.622276 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m02:57:44.637271 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.641266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.642265 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m02:57:44.642265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.702232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:57:44.703232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.704230 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m02:57:44.746206 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:57:44.751203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.752203 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m02:57:44.753202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.758199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.759199 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m02:57:44.760197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.766195 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:57:44.767194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.767194 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m02:57:44.769193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.774190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m02:57:44.775189 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m02:57:44.783184 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:44.785184 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.786183 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m02:57:44.787182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248E21150>]}
[0m02:57:44.788182 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.18s]
[0m02:57:44.790181 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m02:57:44.791180 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m02:57:44.792180 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m02:57:44.793179 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.794179 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m02:57:44.795178 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m02:57:44.802174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.804172 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:44.805173 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m02:57:44.816166 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.817165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.818164 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m02:57:44.818164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:44.938096 [debug] [Thread-1 (]: SQL status: BEGIN in 0.12 seconds
[0m02:57:44.939096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.939096 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m02:57:44.976074 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m02:57:44.980071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.981071 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m02:57:44.982071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.988067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.988067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m02:57:44.990066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:44.994065 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:57:44.994065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:44.995063 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m02:57:44.997062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:45.001061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m02:57:45.001061 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m02:57:45.009055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:45.011054 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.012053 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m02:57:45.013053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248E21060>]}
[0m02:57:45.014053 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.22s]
[0m02:57:45.016051 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m02:57:45.017051 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m02:57:45.018051 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m02:57:45.019050 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.020049 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m02:57:45.021049 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m02:57:45.034043 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.035041 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.036040 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m02:57:45.047034 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.049037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.050034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m02:57:45.051035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:45.110999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m02:57:45.111998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.112996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m02:57:45.168591 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.06 seconds
[0m02:57:45.174588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.175587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m02:57:45.175587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:45.221563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.222561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m02:57:45.223560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:45.227557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:57:45.227557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.228568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m02:57:45.231692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:45.233708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m02:57:45.234693 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m02:57:45.239434 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:57:45.241444 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.242434 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m02:57:45.243432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248D56740>]}
[0m02:57:45.243432 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.22s]
[0m02:57:45.245430 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m02:57:45.246430 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m02:57:45.246430 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m02:57:45.247429 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.248445 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m02:57:45.249428 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m02:57:45.256427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.258424 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.259423 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m02:57:45.269419 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.272416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.273418 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m02:57:45.274415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:45.327385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m02:57:45.328384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.328384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m02:57:45.905055 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.58 seconds
[0m02:57:45.908066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.909067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m02:57:45.910066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:45.913049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.913049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m02:57:45.914064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:45.917062 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:57:45.918061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.918061 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m02:57:45.920307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:45.923323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m02:57:45.923323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m02:57:45.929685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:45.931688 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.931688 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m02:57:45.932686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248FA2980>]}
[0m02:57:45.933685 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.69s]
[0m02:57:45.935684 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m02:57:45.936683 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m02:57:45.937683 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m02:57:45.940681 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:45.941682 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m02:57:45.942681 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m02:57:45.949679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:45.950800 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:45.950800 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m02:57:45.959802 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:45.960798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:45.961797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m02:57:45.961797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:57:46.126010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m02:57:46.127010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:46.128010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m02:57:46.145617 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m02:57:46.153633 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:46.154612 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m02:57:46.155617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:46.158610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:46.159609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m02:57:46.160609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:46.164609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:57:46.165609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:46.165609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m02:57:46.167608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:57:46.172602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m02:57:46.172602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m02:57:46.179601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m02:57:46.181598 [debug] [Thread-1 (]: finished collecting timing info
[0m02:57:46.182597 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m02:57:46.183596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4646bd73-80fd-4387-bb13-70677e737565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F3CE20>]}
[0m02:57:46.184596 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.24s]
[0m02:57:46.186593 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m02:57:46.189593 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m02:57:46.189593 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:46.191591 [debug] [MainThread]: On master: BEGIN
[0m02:57:46.193592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:46.257561 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m02:57:46.258553 [debug] [MainThread]: On master: COMMIT
[0m02:57:46.259553 [debug] [MainThread]: Using postgres connection "master"
[0m02:57:46.260552 [debug] [MainThread]: On master: COMMIT
[0m02:57:46.261551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:46.261551 [debug] [MainThread]: On master: Close
[0m02:57:46.263550 [info ] [MainThread]: 
[0m02:57:46.264550 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m02:57:46.266549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:46.266549 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m02:57:46.267548 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m02:57:46.267548 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m02:57:46.282541 [info ] [MainThread]: 
[0m02:57:46.284538 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:57:46.286537 [info ] [MainThread]: 
[0m02:57:46.289538 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m02:57:46.291535 [error] [MainThread]:   error de sintaxis en o cerca de «.»
[0m02:57:46.292534 [error] [MainThread]:   LINE 36: select ROW_NUMBER() OVER(ORDER BY (pf.song)) AS pf.id_song, ...
[0m02:57:46.294533 [error] [MainThread]:                                                              ^
[0m02:57:46.295532 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m02:57:46.298531 [info ] [MainThread]: 
[0m02:57:46.301529 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m02:57:46.302528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F5AA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F59C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015248F285E0>]}


============================== 2022-11-23 03:00:14.577773 | 1cdf35e4-ead3-468e-a829-d75fc2b540d6 ==============================
[0m03:00:14.577773 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:00:14.578773 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:00:14.579772 [debug] [MainThread]: Tracking: tracking
[0m03:00:14.601760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA155E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA17C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA17C730>]}
[0m03:00:14.711695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:00:14.712695 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m03:00:14.727686 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m03:00:14.750675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:00:14.764665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA30E050>]}
[0m03:00:14.781658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA2ABFD0>]}
[0m03:00:14.782656 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 21 sources, 0 exposures, 0 metrics
[0m03:00:14.783290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA155E10>]}
[0m03:00:14.786294 [info ] [MainThread]: 
[0m03:00:14.789292 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:00:14.796286 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:00:14.816277 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:00:14.817277 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:00:14.817277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:14.867247 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:00:14.870246 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:00:14.871243 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:00:14.875241 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:00:14.876240 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:00:14.876240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:14.915221 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:00:14.917218 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:00:14.918218 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:00:14.921217 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:00:14.922216 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:00:14.922216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:14.963192 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:00:14.965192 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:00:14.968188 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:00:14.976184 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:00:14.977184 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:00:14.977184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:15.015207 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:00:15.015207 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:00:15.016222 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:00:15.024213 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.01 seconds
[0m03:00:15.027200 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:00:15.028200 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:00:15.029199 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:00:15.033197 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:00:15.034196 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:00:15.034196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:15.083168 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:00:15.083168 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:00:15.084168 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:00:15.092163 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:00:15.094162 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:00:15.094162 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:00:15.095162 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:00:15.098160 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:00:15.099159 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:00:15.099159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:15.138138 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:00:15.139138 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:00:15.139138 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:00:15.147133 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:00:15.149130 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:00:15.150131 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:00:15.157126 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:15.157126 [debug] [MainThread]: On master: BEGIN
[0m03:00:15.158125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:15.197105 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:00:15.198103 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:15.198103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:15.251072 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:00:15.253073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA148760>]}
[0m03:00:15.254072 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:15.255070 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:15.255070 [debug] [MainThread]: On master: BEGIN
[0m03:00:15.256069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:00:15.257070 [debug] [MainThread]: On master: COMMIT
[0m03:00:15.258070 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:15.258070 [debug] [MainThread]: On master: COMMIT
[0m03:00:15.259068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:00:15.259068 [debug] [MainThread]: On master: Close
[0m03:00:15.260067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:15.262009 [info ] [MainThread]: 
[0m03:00:15.271007 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:00:15.271007 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:00:15.275005 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.275005 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:00:15.276004 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:00:15.284999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.286999 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.287999 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:00:15.347964 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.348963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.349962 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:00:15.349962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:00:15.389362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:00:15.389362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.390365 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:00:15.405704 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.01 seconds
[0m03:00:15.413714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.414701 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:00:15.415701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.420697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.420697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:00:15.421697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.451680 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:00:15.452679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.453677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:00:15.455242 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:15.461255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:00:15.461255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:00:15.465785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:00:15.467800 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.467800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:00:15.468799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA412110>]}
[0m03:00:15.469786 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.20s]
[0m03:00:15.471039 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:00:15.472042 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:00:15.473041 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:00:15.474042 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.475041 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:00:15.476041 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:00:15.482056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.483037 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.483037 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:00:15.489052 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.492030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.492030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:00:15.493047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:15.544012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:00:15.545016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.545016 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:00:15.554991 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:00:15.560990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.560990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:00:15.561987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.565000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.565986 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:00:15.566985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.569997 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:00:15.569997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.570985 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:00:15.571996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:15.574995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:00:15.575978 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:00:15.579832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:00:15.581836 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.581836 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:00:15.583814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA405D80>]}
[0m03:00:15.583814 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:00:15.585819 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:00:15.586812 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:00:15.587814 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:00:15.589811 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.590810 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:00:15.590810 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:00:15.598805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:00:15.599804 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.600824 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:00:15.609798 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:00:15.611797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.612797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:00:15.613797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:15.863654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.25 seconds
[0m03:00:15.864655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.865653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:00:15.920621 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.05 seconds
[0m03:00:15.931614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.931614 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:00:15.933613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.939610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.940611 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:00:15.941609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:15.947605 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:00:15.948605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.949604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:00:15.954601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:15.960599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:00:15.961598 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:00:15.970593 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:15.973592 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.973592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:00:15.975590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA465180>]}
[0m03:00:15.976589 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.39s]
[0m03:00:15.978588 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:00:15.978588 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:00:15.979587 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:00:15.981588 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:15.982587 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:00:15.983586 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:00:15.994578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:00:15.996577 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:15.997577 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:00:16.017567 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.018566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.019565 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:00:16.020564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.072534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:00:16.072534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.073534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from profiled_data
  );
[0m03:00:16.184471 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.11 seconds
[0m03:00:16.187468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.187468 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:00:16.188469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.192465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.192465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:00:16.193465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.196463 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:00:16.197463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.197463 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:00:16.203079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:16.206082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:00:16.207079 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:00:16.214076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:16.216074 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.217074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:00:16.219077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA2B4550>]}
[0m03:00:16.221075 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.24s]
[0m03:00:16.221937 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:00:16.223947 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:00:16.224939 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:00:16.226939 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.227938 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:00:16.229939 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:00:16.236934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.238933 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.239931 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:00:16.252924 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.253923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.254922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:00:16.254922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.298900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:00:16.299897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.299897 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong"."popularity" as p
)

select * from song_popularity
  );
[0m03:00:16.323893 [debug] [Thread-1 (]: SQL status: SELECT 1996 in 0.02 seconds
[0m03:00:16.327880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.328881 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:00:16.329881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.333877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.334877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:00:16.335877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.338874 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:00:16.339874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.339874 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:00:16.342349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:16.344350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:00:16.345349 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:00:16.350915 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:16.352915 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.353914 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:00:16.354914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA497F70>]}
[0m03:00:16.354914 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 1996[0m in 0.13s]
[0m03:00:16.356913 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:00:16.357912 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:00:16.358911 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:00:16.359911 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.360912 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:00:16.361910 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:00:16.366907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.367906 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.368905 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:00:16.376901 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.378901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.379900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:00:16.381903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.549619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:00:16.549619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.550624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong"."genre" as psg
)

select * from publication_songgenres
  );
[0m03:00:16.595248 [debug] [Thread-1 (]: SQL status: SELECT 3701 in 0.04 seconds
[0m03:00:16.601260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.602260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:00:16.603245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.609240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.609240 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:00:16.611242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.615236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:00:16.615236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.616236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:00:16.618476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:16.620509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:00:16.621476 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:00:16.628739 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:16.630760 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.630760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:00:16.631741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA37D090>]}
[0m03:00:16.632739 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3701[0m in 0.27s]
[0m03:00:16.633739 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:00:16.634738 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:00:16.635738 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:00:16.636738 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.637740 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:00:16.637740 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:00:16.646734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.647731 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.648729 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:00:16.653726 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.655726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.655726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:00:16.657733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.714023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:00:16.715027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.716020 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong"."statistics" as s
)

select * from song_statistics
  );
[0m03:00:16.740041 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m03:00:16.743036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.744036 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:00:16.745036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.749033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.750032 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:00:16.751032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.754030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:00:16.754030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.755030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:00:16.757798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:16.760802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:00:16.760802 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:00:16.765965 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:16.767965 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.767965 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:00:16.768965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4B7EB0>]}
[0m03:00:16.769964 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 1997[0m in 0.13s]
[0m03:00:16.771962 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:00:16.772961 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:00:16.772961 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:00:16.774961 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.774961 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:00:16.775962 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:00:16.782957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.783955 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.783955 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:00:16.790966 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.792952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.793950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:00:16.795949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.845921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:00:16.845921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.846922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong"."duration"  as d
)

select * from song_duration
  );
[0m03:00:16.869926 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m03:00:16.872924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.873924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:00:16.874924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.877922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.877922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:00:16.879922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:16.883919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:00:16.883919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.884919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:00:16.906271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m03:00:16.909271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:00:16.909271 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:00:16.914616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:00:16.917616 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.917616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:00:16.918629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4C8520>]}
[0m03:00:16.919613 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 1997[0m in 0.14s]
[0m03:00:16.921614 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:00:16.922611 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:00:16.922611 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:00:16.924627 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:16.925610 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:00:16.926611 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:00:16.931621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:16.932608 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:16.933606 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:00:16.945602 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:16.947601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:16.948596 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:00:16.948596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:16.991886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:00:16.992884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:16.992884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong"."regulatory_information" as e
)

select * from song_explicit
  );
[0m03:00:17.013521 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m03:00:17.016519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:17.017519 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:00:17.018519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.021517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:17.021517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:00:17.022517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.026514 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:00:17.026514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:17.026514 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:00:17.028894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:17.032894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:00:17.033893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:00:17.038839 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:00:17.040839 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.041837 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:00:17.042837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4D3D00>]}
[0m03:00:17.042837 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 1997[0m in 0.12s]
[0m03:00:17.044836 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:00:17.045837 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:00:17.045837 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:00:17.046835 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.047834 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:00:17.048835 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:00:17.054831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.055830 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.058828 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:00:17.068822 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.069822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.069822 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:00:17.070822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:17.223690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:00:17.223690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.224693 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong"."statistics" as t
)

select * from song_traits
  );
[0m03:00:17.254672 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m03:00:17.260680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.260680 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:00:17.261668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.265666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.265666 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:00:17.267665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.272662 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:00:17.273662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.273662 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:00:17.276660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:17.279659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:00:17.280658 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:00:17.289655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:17.292651 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.293652 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:00:17.294650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4E6D40>]}
[0m03:00:17.296650 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 1997[0m in 0.25s]
[0m03:00:17.298648 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:00:17.299648 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:00:17.300646 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:00:17.302645 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.303645 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:00:17.303645 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:00:17.311643 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.313639 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.314638 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:00:17.324635 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.326632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.327631 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:00:17.328632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:17.379601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:00:17.380600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.380600 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong"."year" as y
)

select * from song_year
  );
[0m03:00:17.405587 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m03:00:17.409585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.410585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:00:17.411582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.415581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.415581 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:00:17.417580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.421576 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:00:17.421576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.422576 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:00:17.424576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:17.431571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:00:17.432571 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:00:17.440567 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:17.443564 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.443564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:00:17.444563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4BA470>]}
[0m03:00:17.445564 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 1997[0m in 0.14s]
[0m03:00:17.447562 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:00:17.448562 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:00:17.448562 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:00:17.450562 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.451560 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:00:17.452559 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:00:17.524519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.542927 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.542927 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:00:17.548923 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.549924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.549924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:00:17.550922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:17.586901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:00:17.587903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.587903 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:00:17.621289 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.03 seconds
[0m03:00:17.625289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.626286 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:00:17.627286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.630299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.630299 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:00:17.631286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:17.634283 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:00:17.635283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.635283 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:00:17.638019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:17.640999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:00:17.640999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:00:17.647312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:17.649299 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.649299 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:00:17.650300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA5048B0>]}
[0m03:00:17.651298 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.20s]
[0m03:00:17.652658 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:00:17.653662 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:00:17.654660 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:00:17.655660 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:17.656659 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:00:17.657658 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:00:17.661656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:17.663655 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:17.664654 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:00:17.673649 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:17.674648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:17.675649 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:00:17.676649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:17.734616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:00:17.735613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:17.735613 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:00:18.293044 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.56 seconds
[0m03:00:18.296027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:18.297026 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:00:18.298041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:18.301026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:18.301026 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:00:18.302025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:18.305021 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:00:18.305021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:18.306022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:00:18.308090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:18.311092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:00:18.312091 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:00:18.317614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:00:18.319618 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:18.319618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:00:18.321614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA0DBDF0>]}
[0m03:00:18.322614 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 1997[0m in 0.66s]
[0m03:00:18.324612 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:00:18.325612 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:00:18.326611 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:00:18.328610 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.328610 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:00:18.329609 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:00:18.334606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.335606 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:18.335606 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:00:18.341604 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.343602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.343602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:00:18.344617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:18.397314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:00:18.397314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.398315 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:00:18.415072 [debug] [Thread-1 (]: SQL status: SELECT 1279 in 0.02 seconds
[0m03:00:18.419085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.419085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:00:18.420069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:18.424069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.424069 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:00:18.426067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:00:18.429079 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:00:18.430072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.430072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:00:18.432078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:00:18.434077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:00:18.435076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:00:18.440059 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:00:18.442068 [debug] [Thread-1 (]: finished collecting timing info
[0m03:00:18.443072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:00:18.444056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1cdf35e4-ead3-468e-a829-d75fc2b540d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA4CB310>]}
[0m03:00:18.445058 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1279[0m in 0.12s]
[0m03:00:18.446056 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:00:18.448053 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:00:18.449053 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:18.449053 [debug] [MainThread]: On master: BEGIN
[0m03:00:18.450053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:18.507020 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:00:18.508027 [debug] [MainThread]: On master: COMMIT
[0m03:00:18.509021 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:18.509021 [debug] [MainThread]: On master: COMMIT
[0m03:00:18.510020 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:00:18.511017 [debug] [MainThread]: On master: Close
[0m03:00:18.512017 [info ] [MainThread]: 
[0m03:00:18.513017 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m03:00:18.515015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:18.516015 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:00:18.516015 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:00:18.517014 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:00:18.538004 [info ] [MainThread]: 
[0m03:00:18.539003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:18.542000 [info ] [MainThread]: 
[0m03:00:18.543999 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:00:18.545999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA01C0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA01F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024AEA2EABC0>]}


============================== 2022-11-23 03:04:55.030617 | ca9d7641-bd9d-42bf-8249-13301c172301 ==============================
[0m03:04:55.030617 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:04:55.031617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:04:55.032596 [debug] [MainThread]: Tracking: tracking
[0m03:04:55.051584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CAE0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CAE09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CAE07F0>]}
[0m03:04:55.149531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m03:04:55.150528 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.duration
[0m03:04:55.150528 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.genre
[0m03:04:55.151548 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.popularity
[0m03:04:55.151548 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.regulatory_information
[0m03:04:55.152547 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.statistics
[0m03:04:55.153528 [debug] [MainThread]: Partial parsing: deleted source source.dbt_summersong_etl.source_db.year
[0m03:04:55.153528 [debug] [MainThread]: Partial parsing: update schema file: dbt_summersong_etl://models\staging\staging.yml
[0m03:04:55.154526 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_popularity.sql
[0m03:04:55.154526 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:04:55.155525 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_duration.sql
[0m03:04:55.155525 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_explicit.sql
[0m03:04:55.155525 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_traits.sql
[0m03:04:55.156525 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_statistics.sql
[0m03:04:55.157525 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_year.sql
[0m03:04:55.170516 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_duration.sql
[0m03:04:55.186884 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:04:55.190861 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_1.sql
[0m03:04:55.195858 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:04:55.200855 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_popularity.sql
[0m03:04:55.204855 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_explicit.sql
[0m03:04:55.209852 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_statistics.sql
[0m03:04:55.212848 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_traits.sql
[0m03:04:55.216848 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_year.sql
[0m03:04:55.241852 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:04:55.253846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CCE00D0>]}
[0m03:04:55.282809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC876D0>]}
[0m03:04:55.283808 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:04:55.284808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC87850>]}
[0m03:04:55.289821 [info ] [MainThread]: 
[0m03:04:55.294811 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:04:55.300798 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:04:55.329782 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:04:55.329782 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:04:55.330782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:55.389747 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:04:55.392747 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:04:55.394745 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:04:55.400742 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:04:55.400742 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:04:55.401742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:55.452711 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:04:55.454710 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:04:55.456709 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:04:55.459707 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:04:55.459707 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:04:55.460707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:55.505681 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:04:55.507684 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:04:55.511678 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:04:55.525670 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:04:55.525670 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:04:55.526670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:04:55.589633 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:04:55.591632 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:04:55.591632 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:04:55.600628 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:04:55.602626 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:04:55.603625 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:04:55.604625 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:04:55.608625 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:04:55.609623 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:04:55.609623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:55.775962 [debug] [ThreadPool]: SQL status: BEGIN in 0.17 seconds
[0m03:04:55.776944 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:04:55.776944 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:04:55.786097 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:04:55.788097 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:04:55.788097 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:04:55.789110 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:04:55.792108 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:04:55.793094 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:04:55.793094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:04:55.832057 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:04:55.832057 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:04:55.833066 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:04:55.842186 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:04:55.844185 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:04:55.845184 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:04:55.851180 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:55.851180 [debug] [MainThread]: On master: BEGIN
[0m03:04:55.852195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:04:55.892900 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:04:55.892900 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:55.893899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:04:55.942205 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:04:55.944203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC86BC0>]}
[0m03:04:55.945187 [debug] [MainThread]: On master: ROLLBACK
[0m03:04:55.946189 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:55.946189 [debug] [MainThread]: On master: BEGIN
[0m03:04:55.947193 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:04:55.947193 [debug] [MainThread]: On master: COMMIT
[0m03:04:55.948188 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:55.948188 [debug] [MainThread]: On master: COMMIT
[0m03:04:55.949186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:04:55.949186 [debug] [MainThread]: On master: Close
[0m03:04:55.950185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:04:55.951184 [info ] [MainThread]: 
[0m03:04:55.961178 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:04:55.961178 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:04:55.965180 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:55.966179 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:04:55.967176 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:04:55.972187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:04:55.973188 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:55.974171 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:04:56.035136 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.036138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.037135 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:04:56.037135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:04:56.077290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:04:56.078278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.078278 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:04:56.125413 [debug] [Thread-1 (]: SQL status: SELECT 833 in 0.05 seconds
[0m03:04:56.133430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.134409 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:04:56.135407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.138426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.138426 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:04:56.139405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.169388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:04:56.169388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.170388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:04:56.171413 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:56.180385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:04:56.181381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:04:56.188379 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:04:56.192393 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.194378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:04:56.196373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CA9D900>]}
[0m03:04:56.197375 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 833[0m in 0.23s]
[0m03:04:56.199371 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:04:56.200373 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:04:56.201371 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:04:56.202374 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.202374 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:04:56.203389 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:04:56.209376 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.210365 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.211364 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:04:56.226356 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.228355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.229355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:04:56.230353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:56.282324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:56.282324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.283323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:04:56.293317 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:04:56.297316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.298316 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:04:56.299314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.302312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.303312 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:04:56.303312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.307309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:04:56.307309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.308309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:04:56.309773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:56.311775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:04:56.312774 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:04:56.316942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:56.318942 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.318942 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:04:56.319941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC34250>]}
[0m03:04:56.320941 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:04:56.322947 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:04:56.322947 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:04:56.323942 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:04:56.325938 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.325938 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:04:56.326937 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:04:56.335933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:04:56.336932 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.336932 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:04:56.345926 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:04:56.347926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.347926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:04:56.348924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:56.399895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:56.399895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.400895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:04:56.418497 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.02 seconds
[0m03:04:56.422495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.423495 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:04:56.424494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.428493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.428493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:04:56.429492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.432490 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:04:56.433489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.433489 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:04:56.436070 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:56.439070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:04:56.439070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:04:56.444541 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:56.446540 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.447539 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:04:56.448538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CD310F0>]}
[0m03:04:56.449538 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 1997[0m in 0.12s]
[0m03:04:56.450537 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:04:56.451537 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:04:56.452536 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:04:56.453536 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.454535 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:04:56.455534 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:04:56.466529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.467527 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.468528 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:04:56.477522 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.479521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.480522 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:04:56.481520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:56.530492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:56.531492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.531492 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from profiled_data
  );
[0m03:04:56.620456 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.09 seconds
[0m03:04:56.625452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.625452 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:04:56.626436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.629435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.630434 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:04:56.631434 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.634434 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:04:56.635433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.635433 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:04:56.666273 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m03:04:56.670275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:04:56.671275 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:04:56.678257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:04:56.681255 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.682254 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:04:56.684253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CD1B610>]}
[0m03:04:56.685252 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.23s]
[0m03:04:56.689250 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:04:56.690249 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:04:56.691249 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:04:56.698250 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.700247 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:04:56.701244 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:04:56.710240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.713238 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.714237 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:04:56.728229 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.731227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.732227 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:04:56.733226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:56.799187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:04:56.800189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.801187 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    ROW_NUMBER() OVER(ORDER BY (p.song)) AS id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:04:56.835166 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:04:56.841164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.841164 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:04:56.842163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.846160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.846160 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:04:56.848159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:56.852156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:04:56.853156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.854155 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:04:56.855156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:56.860152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:04:56.860152 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:04:56.866150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:56.868147 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.869147 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:04:56.870146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CD1B4F0>]}
[0m03:04:56.871147 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.17s]
[0m03:04:56.873145 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:04:56.874146 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:04:56.876143 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:04:56.878142 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:56.878142 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:04:56.879142 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:04:56.889137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:56.892148 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:56.893134 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:04:56.904128 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:56.905128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:56.906126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:04:56.906126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:56.963093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:04:56.963093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:56.964094 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select ROW_NUMBER() OVER(ORDER BY (psg.song)) AS id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:04:57.000073 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.04 seconds
[0m03:04:57.007069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:57.008067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:04:57.009067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.014066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:57.014066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:04:57.016063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.021060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:04:57.022062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:57.023059 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:04:57.026058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.029056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:04:57.029056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:04:57.037052 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:04:57.040049 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.040049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:04:57.042048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CE102E0>]}
[0m03:04:57.043048 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.16s]
[0m03:04:57.045047 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:04:57.046046 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:04:57.047047 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:04:57.048046 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.049045 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:04:57.050045 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:04:57.060038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.061037 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.062037 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:04:57.080027 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.082026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.082026 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:04:57.083025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.148988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:04:57.149987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.150987 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    ROW_NUMBER() OVER(ORDER BY (s.song)) AS id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:04:57.174934 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:04:57.179932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.179932 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:04:57.180930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.184930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.184930 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:04:57.185928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.189926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:04:57.189926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.190924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:04:57.192766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.195767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:04:57.195767 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:04:57.200996 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:57.202996 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.203996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:04:57.204993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CE046D0>]}
[0m03:04:57.205994 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.16s]
[0m03:04:57.207993 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:04:57.208992 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:04:57.209991 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:04:57.210990 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.211990 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:04:57.212989 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:04:57.216988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.217986 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.217986 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:04:57.224983 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.226981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.227980 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:04:57.228980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.293943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:04:57.294942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.294942 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    ROW_NUMBER() OVER(ORDER BY (d.song)) AS id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:04:57.315595 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:04:57.319595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.320596 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:04:57.321594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.326591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.327589 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:04:57.328590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.331587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:04:57.331587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.331587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:04:57.334157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.337159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:04:57.337159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:04:57.343158 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:57.345156 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.345156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:04:57.346153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CE2ED40>]}
[0m03:04:57.347153 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.14s]
[0m03:04:57.350151 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:04:57.351150 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:04:57.352150 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:04:57.354149 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.355148 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:04:57.355148 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:04:57.364146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.366144 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.366144 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:04:57.374137 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.377142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.378135 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:04:57.378135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.426108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:57.427107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.427107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    ROW_NUMBER() OVER(ORDER BY (e.song)) AS id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:04:57.449111 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:04:57.453109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.453109 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:04:57.454108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.458107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.458107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:04:57.459106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.463104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:04:57.463104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.464103 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:04:57.465955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.468958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:04:57.468958 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:04:57.474954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:57.476951 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.476951 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:04:57.477951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CD0E620>]}
[0m03:04:57.478950 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:04:57.480950 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:04:57.480950 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:04:57.481949 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:04:57.482948 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.483948 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:04:57.484947 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:04:57.494942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.496941 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.496941 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:04:57.505935 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.507934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.508944 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:04:57.509933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.558906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:57.559905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.559905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    ROW_NUMBER() OVER(ORDER BY (t.song)) AS id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:04:57.611416 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.05 seconds
[0m03:04:57.614399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.615402 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:04:57.616398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.620396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.621395 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:04:57.622395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.625395 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:04:57.626394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.626394 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:04:57.629034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.675014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:04:57.676013 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:04:57.683007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:04:57.684008 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.685008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:04:57.686006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CA3B0A0>]}
[0m03:04:57.687004 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.20s]
[0m03:04:57.691001 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:04:57.692002 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:04:57.693002 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:04:57.695000 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.698002 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:04:57.699000 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:04:57.703015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.703996 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.703996 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:04:57.713989 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.715987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.716986 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:04:57.716986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.772955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:04:57.772955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.774953 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    ROW_NUMBER() OVER(ORDER BY (y.song)) AS id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:04:57.801937 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:04:57.805936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.806935 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:04:57.807935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.811932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.811932 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:04:57.812931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.816929 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:04:57.816929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.817928 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:04:57.819927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.821928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:04:57.822927 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:04:57.828923 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:57.830922 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.831920 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:04:57.832920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CAAF0D0>]}
[0m03:04:57.833920 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.14s]
[0m03:04:57.835919 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:04:57.835919 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:04:57.836918 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:04:57.838918 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.839916 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:04:57.839916 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:04:57.852910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.853909 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.854908 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:04:57.865902 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.867901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.868900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:04:57.868900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:57.914873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:57.915873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.915873 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:04:57.952858 [debug] [Thread-1 (]: SQL status: SELECT 1997 in 0.04 seconds
[0m03:04:57.956857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.957857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:04:57.958855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.961853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.962853 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:04:57.963853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:57.967851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:04:57.967851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.967851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:04:57.969805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:57.973806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:04:57.973806 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:04:57.979192 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:57.981200 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:57.982203 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:04:57.983188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC84D60>]}
[0m03:04:57.984188 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 1997[0m in 0.15s]
[0m03:04:57.986188 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:04:57.987187 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:04:57.987187 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:04:57.989185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:57.990185 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:04:57.991184 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:04:58.002180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.003180 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:58.004178 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:04:58.013174 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.015170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.016169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:04:58.016169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:58.063142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:58.063142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.064142 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:04:58.811591 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.75 seconds
[0m03:04:58.815574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.815574 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:04:58.816574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:58.822585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.823569 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:04:58.824569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:58.828587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:04:58.828587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.829566 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:04:58.830587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:58.833564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:04:58.833564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:04:58.838924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:58.840907 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:58.841906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:04:58.841906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC293F0>]}
[0m03:04:58.842906 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.85s]
[0m03:04:58.844905 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:04:58.845923 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:04:58.845923 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:04:58.847903 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.847903 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:04:58.848903 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:04:58.855900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.858902 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:58.859898 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:04:58.868891 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.871893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.872889 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:04:58.873888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:04:58.922862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:04:58.922862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.923859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:04:58.939344 [debug] [Thread-1 (]: SQL status: SELECT 1285 in 0.01 seconds
[0m03:04:58.944328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.944328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:04:58.945325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:58.948324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.949323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:04:58.950323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:04:58.953323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:04:58.954323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.954323 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:04:58.956457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:04:58.958458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:04:58.959457 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:04:58.964432 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:04:58.968431 [debug] [Thread-1 (]: finished collecting timing info
[0m03:04:58.969427 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:04:58.970430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca9d7641-bd9d-42bf-8249-13301c172301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC6A500>]}
[0m03:04:58.971429 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1285[0m in 0.12s]
[0m03:04:58.973426 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:04:58.975424 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:04:58.976425 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:58.977425 [debug] [MainThread]: On master: BEGIN
[0m03:04:58.978424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:04:59.053381 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:04:59.053381 [debug] [MainThread]: On master: COMMIT
[0m03:04:59.054381 [debug] [MainThread]: Using postgres connection "master"
[0m03:04:59.054381 [debug] [MainThread]: On master: COMMIT
[0m03:04:59.055380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:04:59.056378 [debug] [MainThread]: On master: Close
[0m03:04:59.057378 [info ] [MainThread]: 
[0m03:04:59.059377 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m03:04:59.061376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:04:59.062376 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:04:59.062376 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:04:59.063375 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:04:59.081365 [info ] [MainThread]: 
[0m03:04:59.082363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:04:59.084363 [info ] [MainThread]: 
[0m03:04:59.086361 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:04:59.088362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CC689A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CD30A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0CCF65C0>]}


============================== 2022-11-23 03:08:55.011226 | ea39420e-1783-44c4-8698-d63f88dadea8 ==============================
[0m03:08:55.011226 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:08:55.012225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:08:55.013225 [debug] [MainThread]: Tracking: tracking
[0m03:08:55.034213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEDEF640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEE0C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEE0C790>]}
[0m03:08:55.174132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m03:08:55.175132 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_explicit.sql
[0m03:08:55.176131 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_traits.sql
[0m03:08:55.177132 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_year.sql
[0m03:08:55.178131 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\song\stg_song_duration.sql
[0m03:08:55.179130 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:08:55.180129 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_statistics.sql
[0m03:08:55.181129 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_popularity.sql
[0m03:08:55.200117 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_explicit.sql
[0m03:08:55.220106 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_traits.sql
[0m03:08:55.229101 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_year.sql
[0m03:08:55.237096 [debug] [MainThread]: 1699: static parser successfully parsed staging\song\stg_song_duration.sql
[0m03:08:55.252088 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:08:55.256085 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_statistics.sql
[0m03:08:55.264081 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_popularity.sql
[0m03:08:55.276080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:08:55.286068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEFD6650>]}
[0m03:08:55.300062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEF2BA90>]}
[0m03:08:55.301060 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:08:55.303059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEDEF640>]}
[0m03:08:55.310065 [info ] [MainThread]: 
[0m03:08:55.312053 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:08:55.316051 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:08:55.338040 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:08:55.339039 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:08:55.339039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:55.395008 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:08:55.397005 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:08:55.398004 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:08:55.402002 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:08:55.402002 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:08:55.403002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:55.445977 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:08:55.447975 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:08:55.448977 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:08:55.453972 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:08:55.454972 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:08:55.454972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:55.501944 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:08:55.504943 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:08:55.507941 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:08:55.517936 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:08:55.518935 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:08:55.518935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:08:55.585904 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m03:08:55.586898 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:08:55.587897 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:08:55.599890 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:08:55.601890 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:08:55.602887 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:08:55.603887 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:08:55.608884 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:08:55.609884 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:08:55.609884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:55.667850 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:08:55.668850 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:08:55.669849 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:08:55.679843 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:08:55.682842 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:08:55.683841 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:08:55.684840 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:08:55.689837 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:08:55.690838 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:08:55.691837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:08:55.749805 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:08:55.749805 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:08:55.750804 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:08:55.759798 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:08:55.761799 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:08:55.762796 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:08:55.770792 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:55.771792 [debug] [MainThread]: On master: BEGIN
[0m03:08:55.771792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:08:55.819763 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:08:55.820763 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:55.821762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:08:55.864738 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:08:55.866736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEF3B5B0>]}
[0m03:08:55.867736 [debug] [MainThread]: On master: ROLLBACK
[0m03:08:55.867736 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:55.868735 [debug] [MainThread]: On master: BEGIN
[0m03:08:55.868735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:08:55.869734 [debug] [MainThread]: On master: COMMIT
[0m03:08:55.869734 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:55.869734 [debug] [MainThread]: On master: COMMIT
[0m03:08:55.870734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:08:55.870734 [debug] [MainThread]: On master: Close
[0m03:08:55.871733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:08:55.872733 [info ] [MainThread]: 
[0m03:08:55.883729 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:08:55.884732 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:08:55.886725 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:55.887728 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:08:55.887728 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:08:55.893721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:08:55.894723 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:55.895722 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:08:55.961682 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:08:55.962682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:55.963681 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:08:55.963681 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:08:56.001662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:08:56.002671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:56.003661 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:08:56.017493 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:08:56.025474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:56.026473 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:08:56.027488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.030471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:56.030471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:08:56.031472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.060453 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:08:56.060453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:56.061454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:08:56.062453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:08:56.068449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:08:56.069448 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:08:56.074173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:08:56.076173 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.077171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:08:56.078171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF030820>]}
[0m03:08:56.079171 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.19s]
[0m03:08:56.080169 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:08:56.081170 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:08:56.082169 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:08:56.084168 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.085168 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:08:56.086167 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:08:56.094162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.096162 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.098167 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:08:56.107156 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.109156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.111159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:08:56.112151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.163122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:08:56.164122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.164122 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:08:56.200630 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.04 seconds
[0m03:08:56.203643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.204643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:08:56.205644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.208626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.209625 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:08:56.210624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.214622 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:08:56.214622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.215621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:08:56.216621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:08:56.220620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:08:56.221634 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:08:56.226271 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:08:56.228273 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.229277 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:08:56.230272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEF38D30>]}
[0m03:08:56.230272 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.15s]
[0m03:08:56.232270 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:08:56.233269 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:08:56.234271 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:08:56.235269 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.236268 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:08:56.237268 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:08:56.247265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:08:56.250262 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.251260 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:08:56.264254 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:08:56.265252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.266253 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:08:56.266253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.316222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:08:56.317223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.317223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:08:56.335374 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:08:56.338372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.339372 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:08:56.340373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.343370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.344369 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:08:56.345368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.348367 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:08:56.348367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.349367 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:08:56.351251 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:08:56.353252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:08:56.354251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:08:56.360249 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:08:56.362247 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.363247 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:08:56.364245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF0FAEC0>]}
[0m03:08:56.365247 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:08:56.366244 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:08:56.367245 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:08:56.368243 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:08:56.370243 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.371242 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:08:56.372242 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:08:56.385234 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.386233 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.386233 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:08:56.394230 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.396229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.396229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:08:56.397228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.441202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:08:56.442202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.443201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from profiled_data
  );
[0m03:08:56.532757 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.09 seconds
[0m03:08:56.536755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.537753 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:08:56.538771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.541753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.542752 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:08:56.543766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:56.547749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:08:56.547749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.548748 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:08:56.551001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:08:56.553003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:08:56.554002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:08:56.560028 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:08:56.562042 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.562042 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:08:56.563028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEFAD7B0>]}
[0m03:08:56.564026 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.19s]
[0m03:08:56.565027 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:08:56.566027 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:08:56.567028 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:08:56.568039 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:08:56.569024 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:08:56.570024 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:08:56.577019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:08:56.578018 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.579019 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:08:56.596009 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:08:56.599016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:08:56.600007 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:08:56.600007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.644980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:08:56.645980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:08:56.645980 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:08:56.648446 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna p.id_song
LINE 10:     p.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «p.song».

[0m03:08:56.648446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: ROLLBACK
[0m03:08:56.649462 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.650461 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:08:56.651461 [debug] [Thread-1 (]: Database Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)
  no existe la columna p.id_song
  LINE 10:     p.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «p.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:08:56.652462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF109270>]}
[0m03:08:56.652462 [error] [Thread-1 (]: 5 of 14 ERROR creating table model SummerSong_staging.stg_publication_popularity  [[31mERROR[0m in 0.08s]
[0m03:08:56.654460 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:08:56.654460 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:08:56.655459 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:08:56.657461 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:08:56.658459 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:08:56.659458 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:08:56.669452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:08:56.670450 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.671451 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:08:56.683443 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:08:56.685442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:08:56.685442 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:08:56.686442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.738412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:08:56.738412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:08:56.739410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:08:56.739410 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «psg»
LINE 9:     psg.id_song,
            ^

[0m03:08:56.740410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:08:56.741410 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.743421 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:08:56.744409 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «psg»
  LINE 9:     psg.id_song,
              ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:08:56.745407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF035390>]}
[0m03:08:56.745407 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.09s]
[0m03:08:56.747407 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:08:56.748405 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:08:56.749405 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:08:56.751404 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:08:56.752403 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:08:56.752403 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:08:56.758400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:08:56.760398 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.761398 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:08:56.772392 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:08:56.773392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:08:56.773392 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:08:56.774391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.837357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:08:56.838356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:08:56.838356 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:08:56.839353 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna s.id_song
LINE 10:     s.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «s.song».

[0m03:08:56.840353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: ROLLBACK
[0m03:08:56.842352 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.843360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:08:56.844350 [debug] [Thread-1 (]: Database Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)
  no existe la columna s.id_song
  LINE 10:     s.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «s.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:08:56.845350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBEFAC6D0>]}
[0m03:08:56.847349 [error] [Thread-1 (]: 7 of 14 ERROR creating table model SummerSong_staging.stg_publication_statistics  [[31mERROR[0m in 0.09s]
[0m03:08:56.849349 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:08:56.849349 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:08:56.850347 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:08:56.852346 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:08:56.853347 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:08:56.854345 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:08:56.861341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:08:56.863340 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.864339 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:08:56.878332 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:08:56.879331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:08:56.880331 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:08:56.880331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:56.949290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:08:56.950290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:08:56.950290 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:08:56.952289 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna d.id_song
LINE 10:     d.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «d.song».

[0m03:08:56.952289 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: ROLLBACK
[0m03:08:56.953288 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.954287 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:08:56.955287 [debug] [Thread-1 (]: Database Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)
  no existe la columna d.id_song
  LINE 10:     d.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «d.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:08:56.956286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF0EAE00>]}
[0m03:08:56.957287 [error] [Thread-1 (]: 8 of 14 ERROR creating table model SummerSong_staging.stg_song_duration ........ [[31mERROR[0m in 0.10s]
[0m03:08:56.961284 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:08:56.962283 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:08:56.963283 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:08:56.964282 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:08:56.965283 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:08:56.965283 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:08:56.970279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:08:56.971278 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:56.972277 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:08:56.985270 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:08:56.986269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:08:56.987269 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:08:56.987269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:57.051232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:08:57.052232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:08:57.053231 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:08:57.054230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna e.id_song
LINE 10:     e.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «e.song».

[0m03:08:57.055229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: ROLLBACK
[0m03:08:57.056229 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.057229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:08:57.058229 [debug] [Thread-1 (]: Database Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)
  no existe la columna e.id_song
  LINE 10:     e.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «e.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:08:57.060227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF13F2E0>]}
[0m03:08:57.061227 [error] [Thread-1 (]: 9 of 14 ERROR creating table model SummerSong_staging.stg_song_explicit ........ [[31mERROR[0m in 0.10s]
[0m03:08:57.063225 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:08:57.064226 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:08:57.065224 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:08:57.067224 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:08:57.067224 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:08:57.068223 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:08:57.077217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:08:57.078217 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.079216 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:08:57.089211 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:08:57.093208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:08:57.094208 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:08:57.094208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:57.157171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:08:57.159172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:08:57.160170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:08:57.161170 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna t.id_song
LINE 10:     t.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «t.song».

[0m03:08:57.162171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: ROLLBACK
[0m03:08:57.163170 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.164167 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:08:57.165167 [debug] [Thread-1 (]: Database Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)
  no existe la columna t.id_song
  LINE 10:     t.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «t.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:08:57.166169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF0D26E0>]}
[0m03:08:57.167168 [error] [Thread-1 (]: 10 of 14 ERROR creating table model SummerSong_staging.stg_song_traits ......... [[31mERROR[0m in 0.10s]
[0m03:08:57.169165 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:08:57.170165 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:08:57.171164 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:08:57.173164 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:08:57.173164 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:08:57.174162 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:08:57.182158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:08:57.183157 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.184157 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:08:57.194155 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:08:57.195150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:08:57.196150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:08:57.197149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:57.251118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:08:57.252117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:08:57.252117 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:08:57.253117 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna y.id_song
LINE 10:     y.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «y.song».

[0m03:08:57.254116 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: ROLLBACK
[0m03:08:57.255115 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.255115 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:08:57.256116 [debug] [Thread-1 (]: Database Error in model stg_song_year (models\staging\song\stg_song_year.sql)
  no existe la columna y.id_song
  LINE 10:     y.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «y.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:08:57.257115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF046530>]}
[0m03:08:57.259115 [error] [Thread-1 (]: 11 of 14 ERROR creating table model SummerSong_staging.stg_song_year ........... [[31mERROR[0m in 0.08s]
[0m03:08:57.262112 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:08:57.262112 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:08:57.263111 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:08:57.264110 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.265111 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:08:57.266109 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:08:57.276118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.278102 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.279102 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:08:57.288096 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.289096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.290097 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:08:57.290097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:08:57.438101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:08:57.438101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.439103 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:08:57.469192 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:08:57.473210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.473210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:08:57.474189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:57.478206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.479205 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:08:57.480184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:08:57.484184 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:08:57.484184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.485182 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:08:57.487274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:08:57.492286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:08:57.493285 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:08:57.500281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:08:57.502280 [debug] [Thread-1 (]: finished collecting timing info
[0m03:08:57.503279 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:08:57.504281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea39420e-1783-44c4-8698-d63f88dadea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF0494E0>]}
[0m03:08:57.505279 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.24s]
[0m03:08:57.510275 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:08:57.511274 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:08:57.512274 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:08:57.514272 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:08:57.515272 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:08:57.516271 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:08:57.519271 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:08:57.523271 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:08:57.523271 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:57.524270 [debug] [MainThread]: On master: BEGIN
[0m03:08:57.527269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:08:57.588303 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:08:57.588303 [debug] [MainThread]: On master: COMMIT
[0m03:08:57.589300 [debug] [MainThread]: Using postgres connection "master"
[0m03:08:57.590298 [debug] [MainThread]: On master: COMMIT
[0m03:08:57.590298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:08:57.591299 [debug] [MainThread]: On master: Close
[0m03:08:57.593306 [info ] [MainThread]: 
[0m03:08:57.594296 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m03:08:57.596295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:08:57.596295 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:08:57.597295 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:08:57.597295 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:08:57.618283 [info ] [MainThread]: 
[0m03:08:57.619284 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m03:08:57.621283 [info ] [MainThread]: 
[0m03:08:57.622280 [error] [MainThread]: [33mDatabase Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)[0m
[0m03:08:57.623280 [error] [MainThread]:   no existe la columna p.id_song
[0m03:08:57.627277 [error] [MainThread]:   LINE 10:     p.id_song,
[0m03:08:57.630277 [error] [MainThread]:                ^
[0m03:08:57.632275 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «p.song».
[0m03:08:57.634274 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:08:57.636274 [info ] [MainThread]: 
[0m03:08:57.637272 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:08:57.639272 [error] [MainThread]:   error de sintaxis en o cerca de «psg»
[0m03:08:57.643275 [error] [MainThread]:   LINE 9:     psg.id_song,
[0m03:08:57.649266 [error] [MainThread]:               ^
[0m03:08:57.651265 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:08:57.653263 [info ] [MainThread]: 
[0m03:08:57.655263 [error] [MainThread]: [33mDatabase Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)[0m
[0m03:08:57.656262 [error] [MainThread]:   no existe la columna s.id_song
[0m03:08:57.658261 [error] [MainThread]:   LINE 10:     s.id_song,
[0m03:08:57.662258 [error] [MainThread]:                ^
[0m03:08:57.667257 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «s.song».
[0m03:08:57.669253 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:08:57.671253 [info ] [MainThread]: 
[0m03:08:57.672252 [error] [MainThread]: [33mDatabase Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)[0m
[0m03:08:57.674251 [error] [MainThread]:   no existe la columna d.id_song
[0m03:08:57.679248 [error] [MainThread]:   LINE 10:     d.id_song,
[0m03:08:57.680247 [error] [MainThread]:                ^
[0m03:08:57.682247 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «d.song».
[0m03:08:57.684248 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:08:57.685244 [info ] [MainThread]: 
[0m03:08:57.686243 [error] [MainThread]: [33mDatabase Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)[0m
[0m03:08:57.688243 [error] [MainThread]:   no existe la columna e.id_song
[0m03:08:57.689242 [error] [MainThread]:   LINE 10:     e.id_song,
[0m03:08:57.690241 [error] [MainThread]:                ^
[0m03:08:57.694243 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «e.song».
[0m03:08:57.697238 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:08:57.699237 [info ] [MainThread]: 
[0m03:08:57.700236 [error] [MainThread]: [33mDatabase Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)[0m
[0m03:08:57.702235 [error] [MainThread]:   no existe la columna t.id_song
[0m03:08:57.703235 [error] [MainThread]:   LINE 10:     t.id_song,
[0m03:08:57.704234 [error] [MainThread]:                ^
[0m03:08:57.705233 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «t.song».
[0m03:08:57.706232 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:08:57.710240 [info ] [MainThread]: 
[0m03:08:57.715231 [error] [MainThread]: [33mDatabase Error in model stg_song_year (models\staging\song\stg_song_year.sql)[0m
[0m03:08:57.718226 [error] [MainThread]:   no existe la columna y.id_song
[0m03:08:57.719226 [error] [MainThread]:   LINE 10:     y.id_song,
[0m03:08:57.720224 [error] [MainThread]:                ^
[0m03:08:57.722224 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «y.song».
[0m03:08:57.723223 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:08:57.724222 [info ] [MainThread]: 
[0m03:08:57.729225 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=7 SKIP=2 TOTAL=14
[0m03:08:57.731220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF0372E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF17E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF17C0A0>]}


============================== 2022-11-23 03:10:34.469444 | 9063d7ca-fbda-46e2-9527-6d4a754b5c6e ==============================
[0m03:10:34.469444 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:10:34.470444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:10:34.471444 [debug] [MainThread]: Tracking: tracking
[0m03:10:34.493448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7199F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7199C040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7199F490>]}
[0m03:10:34.607366 [debug] [MainThread]: Executing "git --help"
[0m03:10:34.668333 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:10:34.668333 [debug] [MainThread]: STDERR: "b''"
[0m03:10:34.673329 [debug] [MainThread]: Acquiring new postgres connection "debug"
[0m03:10:34.674328 [debug] [MainThread]: Using postgres connection "debug"
[0m03:10:34.675328 [debug] [MainThread]: On debug: select 1 as id
[0m03:10:34.676328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:34.735292 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
[0m03:10:34.736293 [debug] [MainThread]: On debug: Close
[0m03:10:34.738291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E71AEEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E71B0C460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E71B0C910>]}
[0m03:10:35.431371 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-23 03:10:42.319689 | d95e43b8-3c66-4487-9708-6fc29a2e910d ==============================
[0m03:10:42.319689 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:10:42.321337 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:10:42.321337 [debug] [MainThread]: Tracking: tracking
[0m03:10:42.338132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5609DE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A560C09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A560C0730>]}
[0m03:10:42.440052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:42.440052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:42.441051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:10:42.454047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A562240D0>]}
[0m03:10:42.470035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A561F1F60>]}
[0m03:10:42.470035 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:10:42.471694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5609DE10>]}
[0m03:10:42.474716 [info ] [MainThread]: 
[0m03:10:42.477693 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:10:42.483703 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:10:42.501697 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:10:42.502701 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:10:42.502701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:42.554266 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:10:42.557267 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:10:42.559264 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:10:42.563264 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:10:42.564260 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:10:42.564260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:42.603584 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:10:42.605585 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:10:42.606582 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:10:42.609595 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:10:42.610595 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:10:42.610595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:42.648558 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:10:42.649558 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:10:42.653555 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:10:42.660551 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:10:42.661550 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:10:42.661550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:42.702527 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:10:42.703527 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:10:42.703527 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:10:42.710523 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:10:42.712523 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:10:42.713521 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:10:42.714520 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:10:42.718519 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:10:42.719518 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:10:42.720517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:42.774486 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:10:42.775486 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:10:42.776487 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:10:42.783481 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:10:42.785481 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:10:42.786479 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:10:42.787480 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:10:42.790478 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:10:42.790478 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:10:42.791476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:42.957874 [debug] [ThreadPool]: SQL status: BEGIN in 0.17 seconds
[0m03:10:42.957874 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:10:42.958871 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:10:42.967030 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:10:42.969021 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:10:42.970017 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:10:42.976014 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:42.976014 [debug] [MainThread]: On master: BEGIN
[0m03:10:42.977016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:43.018310 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:10:43.018310 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:43.019320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:43.058112 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:10:43.060091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A561F0B20>]}
[0m03:10:43.061090 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:43.061090 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:43.062090 [debug] [MainThread]: On master: BEGIN
[0m03:10:43.062090 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:43.063110 [debug] [MainThread]: On master: COMMIT
[0m03:10:43.063110 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:43.064109 [debug] [MainThread]: On master: COMMIT
[0m03:10:43.064109 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:43.065108 [debug] [MainThread]: On master: Close
[0m03:10:43.066087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:43.067087 [info ] [MainThread]: 
[0m03:10:43.079080 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:10:43.080080 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:10:43.083088 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.084095 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:10:43.084095 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:10:43.088096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.090113 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.090113 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:10:43.160093 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.161690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.161690 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:10:43.162709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:10:43.202671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:10:43.202671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.203670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:10:43.221659 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:10:43.230654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.231655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:10:43.232656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.237651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.238650 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:10:43.239652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.295617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:10:43.295617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.296616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:10:43.298615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:10:43.310609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:10:43.310609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:10:43.317605 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:43.319603 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.320604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:10:43.322603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5628ACE0>]}
[0m03:10:43.323602 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.24s]
[0m03:10:43.325600 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:10:43.326601 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:10:43.327599 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:10:43.331597 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.332597 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:10:43.333598 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:10:43.343590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.346588 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.347587 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:10:43.361580 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.362579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.363579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:10:43.364578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:43.419548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:43.419548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.420546 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:10:43.434539 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:10:43.440534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.441534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:10:43.442534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.446532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.447530 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:10:43.448530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.451528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:10:43.452527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.452527 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:10:43.454526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:10:43.459523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:10:43.459523 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:10:43.463522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:43.465520 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.466519 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:10:43.467519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56345570>]}
[0m03:10:43.468519 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.14s]
[0m03:10:43.471518 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:10:43.472516 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:10:43.474515 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:10:43.476514 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.478515 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:10:43.480514 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:10:43.487507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:10:43.489506 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.489506 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:10:43.500500 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:10:43.502499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.502499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:10:43.503498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:43.557467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:43.557467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.558467 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:10:43.581453 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:10:43.585451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.585451 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:10:43.586451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.590448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.590448 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:10:43.591449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.595446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:10:43.595446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.596446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:10:43.598208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:10:43.601210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:10:43.601210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:10:43.607038 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:43.609038 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.610037 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:10:43.610037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A562F7AC0>]}
[0m03:10:43.611036 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:10:43.614034 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:10:43.615034 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:10:43.615034 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:10:43.617032 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.618033 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:10:43.618033 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:10:43.630026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.633033 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.635024 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:10:43.640019 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.643019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.644034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:10:43.645017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:43.687992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:10:43.688991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.689991 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from profiled_data
  );
[0m03:10:43.804404 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.11 seconds
[0m03:10:43.808389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.808389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:10:43.809389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.812384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.813383 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:10:43.814385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:43.816382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:10:43.817381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.817381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:10:43.820221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:10:43.823236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:10:43.823236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:10:43.829816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:10:43.830818 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.831817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:10:43.832814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A562B9660>]}
[0m03:10:43.833814 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.22s]
[0m03:10:43.834813 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:10:43.835815 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:10:43.836833 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:10:43.838810 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:10:43.839810 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:10:43.839810 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:10:43.849804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:10:43.851803 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.852802 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:10:43.866811 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:10:43.867795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:10:43.868794 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:10:43.868794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:43.917768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:43.918765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:10:43.918765 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:10:43.920766 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna p.id_song
LINE 10:     p.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «p.song».

[0m03:10:43.920766 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: ROLLBACK
[0m03:10:43.921763 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.921763 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:10:43.922762 [debug] [Thread-1 (]: Database Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)
  no existe la columna p.id_song
  LINE 10:     p.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «p.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:10:43.923762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56359540>]}
[0m03:10:43.923762 [error] [Thread-1 (]: 5 of 14 ERROR creating table model SummerSong_staging.stg_publication_popularity  [[31mERROR[0m in 0.08s]
[0m03:10:43.927759 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:10:43.927759 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:10:43.928759 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:10:43.929758 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:10:43.930759 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:10:43.931759 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:10:43.936756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:10:43.938755 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:43.938755 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:10:43.950747 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:10:43.952757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:10:43.953745 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:10:43.953745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.004715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:44.005716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:10:44.005716 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:10:44.006715 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «psg»
LINE 9:     psg.id_song,
            ^

[0m03:10:44.007714 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:10:44.008716 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.009721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:10:44.010712 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «psg»
  LINE 9:     psg.id_song,
              ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:10:44.011711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56330790>]}
[0m03:10:44.012711 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.08s]
[0m03:10:44.013712 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:10:44.014712 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:10:44.015710 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:10:44.016709 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:10:44.017710 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:10:44.017710 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:10:44.022706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:10:44.023705 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.023705 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:10:44.031708 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:10:44.033700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:10:44.033700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:10:44.034699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.087668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:44.087668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:10:44.088669 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:10:44.089667 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna s.id_song
LINE 10:     s.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «s.song».

[0m03:10:44.090666 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: ROLLBACK
[0m03:10:44.090666 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.091666 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:10:44.092667 [debug] [Thread-1 (]: Database Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)
  no existe la columna s.id_song
  LINE 10:     s.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «s.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:10:44.093666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5629D600>]}
[0m03:10:44.094665 [error] [Thread-1 (]: 7 of 14 ERROR creating table model SummerSong_staging.stg_publication_statistics  [[31mERROR[0m in 0.08s]
[0m03:10:44.095664 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:10:44.096664 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:10:44.096664 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:10:44.098662 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:10:44.098662 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:10:44.099663 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:10:44.103659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:10:44.104659 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.105658 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:10:44.111656 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:10:44.115654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:10:44.116657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:10:44.117653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.166623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:44.167624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:10:44.168622 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:10:44.169621 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna d.id_song
LINE 10:     d.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «d.song».

[0m03:10:44.169621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: ROLLBACK
[0m03:10:44.170623 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.171620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:10:44.171620 [debug] [Thread-1 (]: Database Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)
  no existe la columna d.id_song
  LINE 10:     d.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «d.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:10:44.172621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A561EBE80>]}
[0m03:10:44.173619 [error] [Thread-1 (]: 8 of 14 ERROR creating table model SummerSong_staging.stg_song_duration ........ [[31mERROR[0m in 0.07s]
[0m03:10:44.176618 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:10:44.177617 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:10:44.177617 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:10:44.179616 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:10:44.180616 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:10:44.181614 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:10:44.185612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:10:44.186612 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.187611 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:10:44.196606 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:10:44.199606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:10:44.200604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:10:44.200604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.252574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:10:44.253574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:10:44.253574 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:10:44.254573 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna e.id_song
LINE 10:     e.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «e.song».

[0m03:10:44.255573 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: ROLLBACK
[0m03:10:44.256572 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.256572 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:10:44.257571 [debug] [Thread-1 (]: Database Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)
  no existe la columna e.id_song
  LINE 10:     e.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «e.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:10:44.258571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A5639A9B0>]}
[0m03:10:44.259571 [error] [Thread-1 (]: 9 of 14 ERROR creating table model SummerSong_staging.stg_song_explicit ........ [[31mERROR[0m in 0.08s]
[0m03:10:44.261569 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:10:44.261569 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:10:44.262568 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:10:44.263568 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:10:44.264568 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:10:44.264568 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:10:44.268565 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:10:44.270564 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.271564 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:10:44.280559 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:10:44.283557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:10:44.284556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:10:44.284556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.329531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:10:44.330530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:10:44.330530 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:10:44.332529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna t.id_song
LINE 10:     t.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «t.song».

[0m03:10:44.332529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: ROLLBACK
[0m03:10:44.333528 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.333528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:10:44.334528 [debug] [Thread-1 (]: Database Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)
  no existe la columna t.id_song
  LINE 10:     t.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «t.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:10:44.335527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A563338B0>]}
[0m03:10:44.336527 [error] [Thread-1 (]: 10 of 14 ERROR creating table model SummerSong_staging.stg_song_traits ......... [[31mERROR[0m in 0.07s]
[0m03:10:44.337525 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:10:44.338527 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:10:44.339525 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:10:44.340524 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:10:44.341523 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:10:44.342523 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:10:44.349521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:10:44.351517 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.351517 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:10:44.357514 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:10:44.360512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:10:44.360512 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:10:44.361512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.489440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.13 seconds
[0m03:10:44.490438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:10:44.490438 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:10:44.492438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna y.id_song
LINE 10:     y.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «y.song».

[0m03:10:44.492438 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: ROLLBACK
[0m03:10:44.493436 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.493436 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:10:44.494436 [debug] [Thread-1 (]: Database Error in model stg_song_year (models\staging\song\stg_song_year.sql)
  no existe la columna y.id_song
  LINE 10:     y.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «y.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:10:44.495436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A563CCD90>]}
[0m03:10:44.496435 [error] [Thread-1 (]: 11 of 14 ERROR creating table model SummerSong_staging.stg_song_year ........... [[31mERROR[0m in 0.15s]
[0m03:10:44.497434 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:10:44.498435 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:10:44.499434 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:10:44.501433 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.501433 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:10:44.502432 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:10:44.518422 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.520422 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.521421 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:10:44.530416 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.532415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.533414 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:10:44.534415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:10:44.577388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:10:44.578390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.578390 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:10:44.608370 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:10:44.613369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.613369 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:10:44.614367 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:44.618366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.618366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:10:44.619365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:44.623363 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:10:44.624361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.624361 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:10:44.626360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:10:44.631357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:10:44.632356 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:10:44.638353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:10:44.640354 [debug] [Thread-1 (]: finished collecting timing info
[0m03:10:44.641351 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:10:44.642351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd95e43b8-3c66-4487-9708-6fc29a2e910d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A562B8EE0>]}
[0m03:10:44.643351 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.14s]
[0m03:10:44.645349 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:10:44.646349 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:10:44.646349 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:10:44.648349 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:10:44.650347 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:10:44.651349 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:10:44.655345 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:10:44.657343 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:10:44.658342 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:44.659342 [debug] [MainThread]: On master: BEGIN
[0m03:10:44.660350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:44.716311 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:10:44.717309 [debug] [MainThread]: On master: COMMIT
[0m03:10:44.718308 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:44.718308 [debug] [MainThread]: On master: COMMIT
[0m03:10:44.719308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:44.720309 [debug] [MainThread]: On master: Close
[0m03:10:44.721307 [info ] [MainThread]: 
[0m03:10:44.722307 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m03:10:44.724304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:44.724304 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:10:44.725305 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:10:44.726303 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:10:44.747291 [info ] [MainThread]: 
[0m03:10:44.749291 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m03:10:44.751291 [info ] [MainThread]: 
[0m03:10:44.752290 [error] [MainThread]: [33mDatabase Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)[0m
[0m03:10:44.754288 [error] [MainThread]:   no existe la columna p.id_song
[0m03:10:44.755287 [error] [MainThread]:   LINE 10:     p.id_song,
[0m03:10:44.756287 [error] [MainThread]:                ^
[0m03:10:44.759285 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «p.song».
[0m03:10:44.761283 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:10:44.762283 [info ] [MainThread]: 
[0m03:10:44.764284 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:10:44.766281 [error] [MainThread]:   error de sintaxis en o cerca de «psg»
[0m03:10:44.768280 [error] [MainThread]:   LINE 9:     psg.id_song,
[0m03:10:44.770279 [error] [MainThread]:               ^
[0m03:10:44.772279 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:10:44.774277 [info ] [MainThread]: 
[0m03:10:44.776276 [error] [MainThread]: [33mDatabase Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)[0m
[0m03:10:44.778274 [error] [MainThread]:   no existe la columna s.id_song
[0m03:10:44.779274 [error] [MainThread]:   LINE 10:     s.id_song,
[0m03:10:44.782273 [error] [MainThread]:                ^
[0m03:10:44.784272 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «s.song».
[0m03:10:44.785272 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:10:44.787269 [info ] [MainThread]: 
[0m03:10:44.789269 [error] [MainThread]: [33mDatabase Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)[0m
[0m03:10:44.792267 [error] [MainThread]:   no existe la columna d.id_song
[0m03:10:44.794265 [error] [MainThread]:   LINE 10:     d.id_song,
[0m03:10:44.796264 [error] [MainThread]:                ^
[0m03:10:44.799263 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «d.song».
[0m03:10:44.801262 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:10:44.804262 [info ] [MainThread]: 
[0m03:10:44.805259 [error] [MainThread]: [33mDatabase Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)[0m
[0m03:10:44.807259 [error] [MainThread]:   no existe la columna e.id_song
[0m03:10:44.810256 [error] [MainThread]:   LINE 10:     e.id_song,
[0m03:10:44.811256 [error] [MainThread]:                ^
[0m03:10:44.813254 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «e.song».
[0m03:10:44.815253 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:10:44.817254 [info ] [MainThread]: 
[0m03:10:44.820253 [error] [MainThread]: [33mDatabase Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)[0m
[0m03:10:44.822250 [error] [MainThread]:   no existe la columna t.id_song
[0m03:10:44.824248 [error] [MainThread]:   LINE 10:     t.id_song,
[0m03:10:44.827247 [error] [MainThread]:                ^
[0m03:10:44.829245 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «t.song».
[0m03:10:44.832245 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:10:44.834243 [info ] [MainThread]: 
[0m03:10:44.836241 [error] [MainThread]: [33mDatabase Error in model stg_song_year (models\staging\song\stg_song_year.sql)[0m
[0m03:10:44.838243 [error] [MainThread]:   no existe la columna y.id_song
[0m03:10:44.840239 [error] [MainThread]:   LINE 10:     y.id_song,
[0m03:10:44.842238 [error] [MainThread]:                ^
[0m03:10:44.844236 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «y.song».
[0m03:10:44.845235 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:10:44.846235 [info ] [MainThread]: 
[0m03:10:44.848235 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=7 SKIP=2 TOTAL=14
[0m03:10:44.851234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A561F1C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56079810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A56414370>]}


============================== 2022-11-23 03:11:58.644770 | 0d1cfa16-5246-4c44-ab61-28351734b63a ==============================
[0m03:11:58.644770 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:11:58.645770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:11:58.646767 [debug] [MainThread]: Tracking: tracking
[0m03:11:58.665775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FCF0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FCF09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FCF07F0>]}
[0m03:11:58.780692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:11:58.781692 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m03:11:58.799681 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m03:11:58.824665 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:11:58.839668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FE91A80>]}
[0m03:11:58.856647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FE1BAC0>]}
[0m03:11:58.856647 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:11:58.857646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FCBA770>]}
[0m03:11:58.863645 [info ] [MainThread]: 
[0m03:11:58.866650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:11:58.870641 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:11:58.887632 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:11:58.887632 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:11:58.888629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:58.954592 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.07 seconds
[0m03:11:58.956591 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:11:58.957589 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:11:58.960587 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:11:58.960587 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:11:58.961587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:59.003563 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:11:59.005563 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:11:59.006563 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:11:59.009561 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:11:59.010560 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:11:59.010560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:59.157538 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.15 seconds
[0m03:11:59.161553 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:11:59.163553 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:11:59.171534 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:11:59.172534 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:11:59.172534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:59.212781 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:11:59.213782 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:11:59.213782 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:11:59.222024 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:11:59.224033 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:11:59.225030 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:11:59.226021 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:11:59.229020 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:11:59.229020 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:11:59.230020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:59.269253 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:11:59.270274 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:11:59.270274 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:11:59.279250 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:11:59.282247 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:11:59.283246 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:11:59.284248 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:11:59.287245 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:11:59.288244 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:11:59.289242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:59.332217 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:11:59.333218 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:11:59.333218 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:11:59.341212 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:11:59.344213 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:11:59.344213 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:11:59.352208 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:59.353208 [debug] [MainThread]: On master: BEGIN
[0m03:11:59.354205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:11:59.399180 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:11:59.400179 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:59.401178 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:11:59.452148 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:11:59.455148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FE446D0>]}
[0m03:11:59.456147 [debug] [MainThread]: On master: ROLLBACK
[0m03:11:59.457146 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:59.457146 [debug] [MainThread]: On master: BEGIN
[0m03:11:59.458146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:11:59.459145 [debug] [MainThread]: On master: COMMIT
[0m03:11:59.459145 [debug] [MainThread]: Using postgres connection "master"
[0m03:11:59.460144 [debug] [MainThread]: On master: COMMIT
[0m03:11:59.460144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:11:59.461144 [debug] [MainThread]: On master: Close
[0m03:11:59.462144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:59.464143 [info ] [MainThread]: 
[0m03:11:59.482132 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:11:59.483132 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:11:59.485131 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.486130 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:11:59.486130 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:11:59.490127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.493128 [debug] [Thread-1 (]: finished collecting timing info
[0m03:11:59.494127 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:11:59.572081 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.573080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.574080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:11:59.575079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:11:59.619055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:11:59.619055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.620053 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:11:59.637044 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:11:59.651036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.652034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:11:59.653035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:59.657031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.658031 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:11:59.659031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:59.700007 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:11:59.700007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.701009 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:11:59.703007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:11:59.715999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:11:59.716999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:11:59.725993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:11:59.728991 [debug] [Thread-1 (]: finished collecting timing info
[0m03:11:59.729990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:11:59.730990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FF37F10>]}
[0m03:11:59.732988 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.25s]
[0m03:11:59.734988 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:11:59.735988 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:11:59.736988 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:11:59.739988 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.740986 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:11:59.741984 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:11:59.752977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.754976 [debug] [Thread-1 (]: finished collecting timing info
[0m03:11:59.754976 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:11:59.764971 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.766970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.767976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:11:59.768969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:11:59.818940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:11:59.819939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.819939 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:11:59.830722 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:11:59.835717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.835717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:11:59.836716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:59.840715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.840715 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:11:59.841713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:11:59.845711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:11:59.845711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.846711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:11:59.880741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m03:11:59.882758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:11:59.883756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:11:59.888019 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:11:59.890036 [debug] [Thread-1 (]: finished collecting timing info
[0m03:11:59.890036 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:11:59.891019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FE19030>]}
[0m03:11:59.892019 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.15s]
[0m03:11:59.894018 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:11:59.895018 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:11:59.896020 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:11:59.898015 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:11:59.898015 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:11:59.899016 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:11:59.906027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:11:59.908012 [debug] [Thread-1 (]: finished collecting timing info
[0m03:11:59.908012 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:11:59.919015 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:11:59.920014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:11:59.921002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:11:59.921002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:11:59.972717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:11:59.973716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:11:59.973716 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:11:59.993712 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:11:59.999708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:11:59.999708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:12:00.000708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:00.005706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:00.006705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:12:00.008705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:00.013700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:12:00.014700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:00.015700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:12:00.017699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:00.021697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:00.021697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:12:00.027693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:00.030691 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.030691 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:12:00.031690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FFCD180>]}
[0m03:12:00.032689 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:12:00.034689 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:12:00.035688 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:12:00.036688 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:12:00.038687 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:00.039687 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:12:00.040686 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:12:00.051680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:12:00.053678 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.054679 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:12:00.063672 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:12:00.065672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:00.065672 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:12:00.066673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.256078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.19 seconds
[0m03:12:00.257077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:00.257077 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_dataprofiled_data
  );
[0m03:12:00.260074 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la relación «identified_profiled_dataprofiled_data»
LINE 60: select * from identified_profiled_dataprofiled_data
                       ^

[0m03:12:00.261073 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: ROLLBACK
[0m03:12:00.262072 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.262072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:12:00.263088 [debug] [Thread-1 (]: Database Error in model profiled_data (models\profiling\profiled_data.sql)
  no existe la relación «identified_profiled_dataprofiled_data»
  LINE 60: select * from identified_profiled_dataprofiled_data
                         ^
  compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m03:12:00.264072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FEE1A20>]}
[0m03:12:00.265074 [error] [Thread-1 (]: 4 of 14 ERROR creating table model SummerSong_profile.profiled_data ............ [[31mERROR[0m in 0.23s]
[0m03:12:00.267069 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:12:00.268072 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:00.269069 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:12:00.270071 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:00.271070 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:00.272067 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:00.282062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:00.283060 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.283060 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:00.291073 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:00.295062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:00.296056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:12:00.297057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.350022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:00.350022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:00.351022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:12:00.353021 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna p.id_song
LINE 10:     p.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «p.song».

[0m03:12:00.353021 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: ROLLBACK
[0m03:12:00.354021 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.355022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:12:00.356019 [debug] [Thread-1 (]: Database Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)
  no existe la columna p.id_song
  LINE 10:     p.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «p.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:12:00.357019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FFE1F00>]}
[0m03:12:00.358021 [error] [Thread-1 (]: 5 of 14 ERROR creating table model SummerSong_staging.stg_publication_popularity  [[31mERROR[0m in 0.09s]
[0m03:12:00.360017 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:00.361016 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:00.362018 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:12:00.363015 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:00.364015 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:00.365014 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:00.369013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:00.370013 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.371012 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:00.378006 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:00.379008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:00.380006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:12:00.381005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.432978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:00.432978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:00.433976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:12:00.434976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «psg»
LINE 9:     psg.id_song,
            ^

[0m03:12:00.434976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:12:00.435973 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.435973 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:12:00.436973 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «psg»
  LINE 9:     psg.id_song,
              ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:12:00.437973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FFFFB20>]}
[0m03:12:00.438972 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:12:00.439970 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:00.440970 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:00.441972 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:12:00.443970 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:00.444969 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:00.445968 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:00.451967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:00.452966 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.453964 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:00.465956 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:00.466955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:00.467956 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:12:00.467956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.641682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:12:00.642678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:00.643677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:12:00.644676 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna s.id_song
LINE 10:     s.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «s.song».

[0m03:12:00.645675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: ROLLBACK
[0m03:12:00.646695 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.646695 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:12:00.647674 [debug] [Thread-1 (]: Database Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)
  no existe la columna s.id_song
  LINE 10:     s.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «s.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:12:00.648674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4000BDF0>]}
[0m03:12:00.648674 [error] [Thread-1 (]: 7 of 14 ERROR creating table model SummerSong_staging.stg_publication_statistics  [[31mERROR[0m in 0.21s]
[0m03:12:00.650672 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:00.651672 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:12:00.651672 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:12:00.653673 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:00.654671 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:12:00.655670 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:12:00.662669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:00.664668 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.665665 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:12:00.671681 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:00.672681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:00.673660 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:12:00.674659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.759611 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m03:12:00.759611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:00.760610 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:12:00.761609 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna d.id_song
LINE 10:     d.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «d.song».

[0m03:12:00.762609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: ROLLBACK
[0m03:12:00.763608 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.763608 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:12:00.764610 [debug] [Thread-1 (]: Database Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)
  no existe la columna d.id_song
  LINE 10:     d.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «d.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:12:00.765607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FEE6920>]}
[0m03:12:00.766606 [error] [Thread-1 (]: 8 of 14 ERROR creating table model SummerSong_staging.stg_song_duration ........ [[31mERROR[0m in 0.11s]
[0m03:12:00.768605 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:12:00.769605 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:00.769605 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:12:00.771604 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:00.772606 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:00.772606 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:12:00.780599 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:00.781598 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.782598 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:00.790593 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:00.793592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:00.793592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:12:00.794591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.853556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:12:00.854557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:00.854557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:12:00.856555 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna e.id_song
LINE 10:     e.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «e.song».

[0m03:12:00.856555 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: ROLLBACK
[0m03:12:00.857556 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.858554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:12:00.859553 [debug] [Thread-1 (]: Database Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)
  no existe la columna e.id_song
  LINE 10:     e.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «e.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:12:00.860553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FE92950>]}
[0m03:12:00.861554 [error] [Thread-1 (]: 9 of 14 ERROR creating table model SummerSong_staging.stg_song_explicit ........ [[31mERROR[0m in 0.09s]
[0m03:12:00.863553 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:00.864551 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:12:00.865550 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:12:00.866551 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:00.867550 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:12:00.868550 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:12:00.874545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:00.877543 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.878543 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:12:00.889536 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:00.890536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:00.891535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:12:00.892536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:00.944504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:00.945504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:00.945504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:12:00.947503 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna t.id_song
LINE 10:     t.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «t.song».

[0m03:12:00.947503 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: ROLLBACK
[0m03:12:00.948504 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.949502 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:12:00.950502 [debug] [Thread-1 (]: Database Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)
  no existe la columna t.id_song
  LINE 10:     t.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «t.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:12:00.951501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F40039FC0>]}
[0m03:12:00.952500 [error] [Thread-1 (]: 10 of 14 ERROR creating table model SummerSong_staging.stg_song_traits ......... [[31mERROR[0m in 0.08s]
[0m03:12:00.954500 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:12:00.954500 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:12:00.955499 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:12:00.957498 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:00.957498 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:12:00.958498 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:12:00.966494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:12:00.967492 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:00.968492 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:12:00.978485 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:12:00.979485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:00.980484 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:12:00.981484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:01.035453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:01.035453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:01.036454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:12:01.037452 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna y.id_song
LINE 10:     y.id_song,
             ^
HINT:  Probablemente quiera hacer referencia a la columna «y.song».

[0m03:12:01.038452 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: ROLLBACK
[0m03:12:01.039450 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:01.039450 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:12:01.040450 [debug] [Thread-1 (]: Database Error in model stg_song_year (models\staging\song\stg_song_year.sql)
  no existe la columna y.id_song
  LINE 10:     y.id_song,
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «y.song».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:12:01.041450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4006A0E0>]}
[0m03:12:01.043450 [error] [Thread-1 (]: 11 of 14 ERROR creating table model SummerSong_staging.stg_song_year ........... [[31mERROR[0m in 0.08s]
[0m03:12:01.044447 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:12:01.045448 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:12:01.046446 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:12:01.047446 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.048446 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:12:01.049446 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:12:01.071433 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.073431 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:01.074430 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:12:01.085425 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.087424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.088423 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:12:01.088423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:01.139394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:01.139394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.140394 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:12:01.167591 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:12:01.171588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.171588 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:12:01.172589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:01.176587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.177585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:12:01.178587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:01.181585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:12:01.181585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.182584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:12:01.214290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m03:12:01.221291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:01.222289 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:12:01.243278 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.02 seconds
[0m03:12:01.246286 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:01.247284 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:12:01.249273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1cfa16-5246-4c44-ab61-28351734b63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FEF4B20>]}
[0m03:12:01.251284 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.20s]
[0m03:12:01.255270 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:12:01.257269 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:12:01.258268 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:12:01.262267 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:12:01.267265 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:12:01.268262 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:12:01.271265 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:12:01.274270 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:12:01.274270 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:01.275259 [debug] [MainThread]: On master: BEGIN
[0m03:12:01.277261 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:01.323229 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:12:01.324230 [debug] [MainThread]: On master: COMMIT
[0m03:12:01.324230 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:01.325229 [debug] [MainThread]: On master: COMMIT
[0m03:12:01.326228 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:01.327228 [debug] [MainThread]: On master: Close
[0m03:12:01.328228 [info ] [MainThread]: 
[0m03:12:01.329228 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m03:12:01.330227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:01.331225 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:12:01.331225 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:12:01.332225 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:12:01.353217 [info ] [MainThread]: 
[0m03:12:01.354212 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m03:12:01.356211 [info ] [MainThread]: 
[0m03:12:01.357210 [error] [MainThread]: [33mDatabase Error in model profiled_data (models\profiling\profiled_data.sql)[0m
[0m03:12:01.361209 [error] [MainThread]:   no existe la relación «identified_profiled_dataprofiled_data»
[0m03:12:01.362208 [error] [MainThread]:   LINE 60: select * from identified_profiled_dataprofiled_data
[0m03:12:01.363207 [error] [MainThread]:                          ^
[0m03:12:01.366205 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\profiling\profiled_data.sql
[0m03:12:01.372202 [info ] [MainThread]: 
[0m03:12:01.374201 [error] [MainThread]: [33mDatabase Error in model stg_publication_popularity (models\staging\publication\stg_publication_popularity.sql)[0m
[0m03:12:01.376200 [error] [MainThread]:   no existe la columna p.id_song
[0m03:12:01.378199 [error] [MainThread]:   LINE 10:     p.id_song,
[0m03:12:01.380197 [error] [MainThread]:                ^
[0m03:12:01.381197 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «p.song».
[0m03:12:01.383196 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_popularity.sql
[0m03:12:01.388195 [info ] [MainThread]: 
[0m03:12:01.390195 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:12:01.392191 [error] [MainThread]:   error de sintaxis en o cerca de «psg»
[0m03:12:01.394199 [error] [MainThread]:   LINE 9:     psg.id_song,
[0m03:12:01.396188 [error] [MainThread]:               ^
[0m03:12:01.398189 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:12:01.402186 [info ] [MainThread]: 
[0m03:12:01.404183 [error] [MainThread]: [33mDatabase Error in model stg_publication_statistics (models\staging\publication\stg_publication_statistics.sql)[0m
[0m03:12:01.405183 [error] [MainThread]:   no existe la columna s.id_song
[0m03:12:01.407181 [error] [MainThread]:   LINE 10:     s.id_song,
[0m03:12:01.408183 [error] [MainThread]:                ^
[0m03:12:01.411180 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «s.song».
[0m03:12:01.412179 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_statistics.sql
[0m03:12:01.414178 [info ] [MainThread]: 
[0m03:12:01.416178 [error] [MainThread]: [33mDatabase Error in model stg_song_duration (models\staging\song\stg_song_duration.sql)[0m
[0m03:12:01.419179 [error] [MainThread]:   no existe la columna d.id_song
[0m03:12:01.421175 [error] [MainThread]:   LINE 10:     d.id_song,
[0m03:12:01.422173 [error] [MainThread]:                ^
[0m03:12:01.423173 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «d.song».
[0m03:12:01.425173 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_duration.sql
[0m03:12:01.428170 [info ] [MainThread]: 
[0m03:12:01.429170 [error] [MainThread]: [33mDatabase Error in model stg_song_explicit (models\staging\song\stg_song_explicit.sql)[0m
[0m03:12:01.431168 [error] [MainThread]:   no existe la columna e.id_song
[0m03:12:01.433167 [error] [MainThread]:   LINE 10:     e.id_song,
[0m03:12:01.436166 [error] [MainThread]:                ^
[0m03:12:01.437166 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «e.song».
[0m03:12:01.439163 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_explicit.sql
[0m03:12:01.440163 [info ] [MainThread]: 
[0m03:12:01.441163 [error] [MainThread]: [33mDatabase Error in model stg_song_traits (models\staging\song\stg_song_traits.sql)[0m
[0m03:12:01.444166 [error] [MainThread]:   no existe la columna t.id_song
[0m03:12:01.446162 [error] [MainThread]:   LINE 10:     t.id_song,
[0m03:12:01.447159 [error] [MainThread]:                ^
[0m03:12:01.449159 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «t.song».
[0m03:12:01.453157 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_traits.sql
[0m03:12:01.455155 [info ] [MainThread]: 
[0m03:12:01.456154 [error] [MainThread]: [33mDatabase Error in model stg_song_year (models\staging\song\stg_song_year.sql)[0m
[0m03:12:01.458154 [error] [MainThread]:   no existe la columna y.id_song
[0m03:12:01.461152 [error] [MainThread]:   LINE 10:     y.id_song,
[0m03:12:01.462151 [error] [MainThread]:                ^
[0m03:12:01.463150 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «y.song».
[0m03:12:01.465149 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\song\stg_song_year.sql
[0m03:12:01.468153 [info ] [MainThread]: 
[0m03:12:01.470147 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=8 SKIP=2 TOTAL=14
[0m03:12:01.472145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F4006A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F3FFFFE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F40081C00>]}


============================== 2022-11-23 03:12:41.484996 | 19978706-7b05-48fa-afbe-d0e890c13687 ==============================
[0m03:12:41.484996 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:12:41.486104 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:12:41.486104 [debug] [MainThread]: Tracking: tracking
[0m03:12:41.507912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E504C520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E504CA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E504C790>]}
[0m03:12:41.603857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:12:41.604856 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\profiling\profiled_data.sql
[0m03:12:41.620827 [debug] [MainThread]: 1699: static parser successfully parsed profiling\profiled_data.sql
[0m03:12:41.657808 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:12:41.671817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E51EDAB0>]}
[0m03:12:41.706780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E517BAF0>]}
[0m03:12:41.707778 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:12:41.715774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E501BE50>]}
[0m03:12:41.720771 [info ] [MainThread]: 
[0m03:12:41.722771 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:12:41.751754 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:12:41.782735 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:12:41.788732 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:12:41.788732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:41.853695 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:12:41.856692 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:12:41.857692 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:12:41.862689 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:12:41.863688 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:12:41.863688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:41.913661 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:12:41.916658 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:12:41.917658 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:12:41.920656 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:12:41.920656 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:12:41.921655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:41.972626 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:12:41.979623 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:12:41.985619 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:12:41.998613 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:12:41.999611 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:12:41.999611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:12:42.048585 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:12:42.049582 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:12:42.049582 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:12:42.057578 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:12:42.060575 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:12:42.061575 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:12:42.062574 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:12:42.065573 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:12:42.066572 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:12:42.066572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:42.105551 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:12:42.106551 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:12:42.107549 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:12:42.114545 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:12:42.116546 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:12:42.117543 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:12:42.118543 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:12:42.121543 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:12:42.122541 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:12:42.122541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:12:42.278300 [debug] [ThreadPool]: SQL status: BEGIN in 0.16 seconds
[0m03:12:42.279320 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:12:42.280298 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:12:42.291202 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:12:42.294203 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:12:42.295200 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:12:42.301211 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:42.302195 [debug] [MainThread]: On master: BEGIN
[0m03:12:42.302195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:12:42.344281 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:12:42.345282 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:42.345282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:12:42.389016 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:12:42.390029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E51A53C0>]}
[0m03:12:42.391028 [debug] [MainThread]: On master: ROLLBACK
[0m03:12:42.392013 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:42.392013 [debug] [MainThread]: On master: BEGIN
[0m03:12:42.393015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:12:42.394011 [debug] [MainThread]: On master: COMMIT
[0m03:12:42.394011 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:42.395011 [debug] [MainThread]: On master: COMMIT
[0m03:12:42.395011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:42.396010 [debug] [MainThread]: On master: Close
[0m03:12:42.396010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:12:42.398087 [info ] [MainThread]: 
[0m03:12:42.406085 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:12:42.410085 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:12:42.415081 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.416080 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:12:42.418079 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:12:42.423075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.424075 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:42.426080 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:12:42.495034 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.496050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.497035 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:12:42.497035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:12:42.665334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:12:42.666337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.667336 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:12:42.731832 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.06 seconds
[0m03:12:42.741829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.742826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:12:42.743826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:42.749824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.749824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:12:42.750821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:42.777821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:12:42.777821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.778808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:12:42.780553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:42.785568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:12:42.786567 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:12:42.790924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:42.792937 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:42.792937 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:12:42.793937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53A3BE0>]}
[0m03:12:42.794924 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.38s]
[0m03:12:42.796923 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:12:42.796923 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:12:42.797922 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:12:42.798923 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.799923 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:12:42.800921 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:12:42.807920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.808919 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:42.810915 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:12:42.821926 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.823907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.823907 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:12:42.824910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:42.873879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:42.873879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.874880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:12:42.885092 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:12:42.890090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.890090 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:12:42.891088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:42.895086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.896085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:12:42.897100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:42.900098 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:12:42.901082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.901082 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:12:42.903081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:42.905095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:12:42.906095 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:12:42.910469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:42.912485 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:42.912485 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:12:42.913486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53DDA20>]}
[0m03:12:42.914468 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:12:42.916467 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:12:42.917468 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:12:42.918467 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:12:42.920467 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:42.921467 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:12:42.922464 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:12:42.933461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:12:42.935457 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:42.936457 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:12:42.941468 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:12:42.945453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:42.946451 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:12:42.947450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:42.995423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:42.996423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:42.996423 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:12:43.013743 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:12:43.018740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:43.018740 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:12:43.019740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.022738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:43.023737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:12:43.024738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.027735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:12:43.028734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:43.028734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:12:43.031733 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:43.034731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:12:43.035732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:12:43.039491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:43.041493 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.042489 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:12:43.043491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E522D180>]}
[0m03:12:43.044488 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:12:43.046490 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:12:43.047487 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:12:43.048489 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:12:43.050485 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.051485 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:12:43.052490 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:12:43.071476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.072473 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.073472 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:12:43.081468 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.083466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.084466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:12:43.085485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:43.134438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:43.135437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.136437 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:12:43.279354 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.14 seconds
[0m03:12:43.287349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.288349 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:12:43.289349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.295345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.296345 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:12:43.298345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.304341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:12:43.305340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.306340 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:12:43.309338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:43.316333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:12:43.317333 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:12:43.324329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:43.327331 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.328327 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:12:43.330326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53F9030>]}
[0m03:12:43.331326 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.28s]
[0m03:12:43.334323 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:12:43.335323 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:43.336322 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:12:43.338322 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.338322 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:43.339321 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:43.350314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.352313 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.353312 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:43.367305 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.369306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.369306 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:12:43.370302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:43.444260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:12:43.445260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.446259 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:12:43.459252 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:12:43.463249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.464248 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:12:43.465248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.471245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.472243 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:12:43.473243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.478241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:12:43.479240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.480239 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:12:43.494232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:12:43.499228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:12:43.499228 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:12:43.505225 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:43.507225 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.508223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:12:43.509223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E525F2E0>]}
[0m03:12:43.510224 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.17s]
[0m03:12:43.513221 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:12:43.514221 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:43.515220 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:12:43.517218 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:43.518219 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:43.519218 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:43.528212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:43.530212 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.531212 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:43.544212 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:43.546202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:43.546202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:12:43.547201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:43.599171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:43.599171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:12:43.600171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:12:43.601170 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «psg»
LINE 9:     psg.id_song,
            ^

[0m03:12:43.602171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:12:43.603170 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.603170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:12:43.604168 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «psg»
  LINE 9:     psg.id_song,
              ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:12:43.605168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E5357E20>]}
[0m03:12:43.606169 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.09s]
[0m03:12:43.608166 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:12:43.609166 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:43.610166 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:12:43.612164 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.613164 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:43.614163 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:43.620160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.622159 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.622159 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:43.635153 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.637152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.638151 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:12:43.639149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:43.802055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m03:12:43.803055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.804055 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:12:43.818046 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:12:43.825057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.825057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:12:43.827041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.831038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.832038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:12:43.833038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:43.837035 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:12:43.837035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.838035 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:12:43.839956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:43.842957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:12:43.842957 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:12:43.851952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:43.853952 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.854950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:12:43.855951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E51EE5F0>]}
[0m03:12:43.856948 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.24s]
[0m03:12:43.859947 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:12:43.860946 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:12:43.861946 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:12:43.863946 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:43.865948 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:12:43.866953 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:12:43.873939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:43.876937 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:43.886932 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:12:43.901925 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:43.902923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:43.903923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:12:43.904921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:43.967885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:12:43.968885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:43.968885 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:12:44.016357 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.05 seconds
[0m03:12:44.020350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:44.021349 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:12:44.022365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.025348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:44.025348 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:12:44.026347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.029345 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:12:44.030344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:44.030344 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:12:44.032515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:44.035516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:12:44.035516 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:12:44.042657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:44.044669 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.044669 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:12:44.045669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53612A0>]}
[0m03:12:44.046652 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.18s]
[0m03:12:44.048652 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:12:44.049651 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:44.050651 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:12:44.053649 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.054648 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:44.056647 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:12:44.066643 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.069640 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.069640 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:44.078654 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.080634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.081633 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:12:44.082633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:44.131605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:44.132605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.132605 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:12:44.144613 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:12:44.148609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.149609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:12:44.150609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.153607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.154606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:12:44.155606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.158604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:12:44.158604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.159603 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:12:44.161708 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:44.163708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:12:44.164708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:12:44.169750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:44.171750 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.172749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:12:44.173749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53611B0>]}
[0m03:12:44.174748 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:12:44.176747 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:12:44.177747 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:12:44.177747 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:12:44.179746 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.180745 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:12:44.180745 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:12:44.187741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.188741 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.188741 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:12:44.203731 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.206730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.207730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:12:44.208729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:44.255703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:12:44.255703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.256701 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:12:44.267734 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:12:44.272731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.273731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:12:44.274731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.278730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.278730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:12:44.279728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.282726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:12:44.283725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.283725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:12:44.285832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:44.287832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:12:44.288832 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:12:44.293903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:44.295902 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.296901 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:12:44.297901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E53610C0>]}
[0m03:12:44.297901 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.12s]
[0m03:12:44.299900 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:12:44.300899 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:12:44.301900 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:12:44.303897 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.304897 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:12:44.305896 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:12:44.314892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.316891 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.318889 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:12:44.324885 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.326887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.328883 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:12:44.329884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:44.374857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:12:44.374857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.375856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:12:44.391912 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:12:44.395910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.395910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:12:44.396910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.399908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.400907 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:12:44.401908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.404905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:12:44.405904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.405904 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:12:44.440554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m03:12:44.443558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:12:44.443558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:12:44.450383 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:12:44.452401 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.452401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:12:44.453384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E5360FD0>]}
[0m03:12:44.454384 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.15s]
[0m03:12:44.456391 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:12:44.457383 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:12:44.457383 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:12:44.459382 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.460381 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:12:44.461380 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:12:44.469378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.470377 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.471374 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:12:44.482370 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.483367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.484369 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:12:44.485366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:12:44.541335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:12:44.542335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.543334 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:12:44.572317 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:12:44.579313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.579313 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:12:44.580312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.631285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.631285 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:12:44.632281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:12:44.636282 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:12:44.637281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.638281 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:12:44.640280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:12:44.644275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:12:44.644275 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:12:44.650274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:12:44.653270 [debug] [Thread-1 (]: finished collecting timing info
[0m03:12:44.653270 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:12:44.654272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19978706-7b05-48fa-afbe-d0e890c13687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E501E230>]}
[0m03:12:44.655269 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.19s]
[0m03:12:44.657270 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:12:44.658270 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:12:44.658270 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:12:44.660268 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:12:44.662270 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:12:44.663266 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:12:44.667263 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:12:44.669261 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:12:44.669261 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:44.670260 [debug] [MainThread]: On master: BEGIN
[0m03:12:44.670260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:12:44.755212 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
[0m03:12:44.756211 [debug] [MainThread]: On master: COMMIT
[0m03:12:44.756211 [debug] [MainThread]: Using postgres connection "master"
[0m03:12:44.757210 [debug] [MainThread]: On master: COMMIT
[0m03:12:44.758210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:12:44.759212 [debug] [MainThread]: On master: Close
[0m03:12:44.760210 [info ] [MainThread]: 
[0m03:12:44.762208 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m03:12:44.763207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:12:44.764207 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:12:44.765207 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:12:44.765207 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:12:44.786194 [info ] [MainThread]: 
[0m03:12:44.795190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:12:44.800187 [info ] [MainThread]: 
[0m03:12:44.803185 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:12:44.806184 [error] [MainThread]:   error de sintaxis en o cerca de «psg»
[0m03:12:44.807183 [error] [MainThread]:   LINE 9:     psg.id_song,
[0m03:12:44.810183 [error] [MainThread]:               ^
[0m03:12:44.812181 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:12:44.814179 [info ] [MainThread]: 
[0m03:12:44.818177 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:12:44.821177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E501D5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E501D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E501E320>]}


============================== 2022-11-23 03:13:29.751372 | 6937164b-9bb0-4091-a3f2-3469fd93407c ==============================
[0m03:13:29.751372 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:13:29.752371 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:13:29.753372 [debug] [MainThread]: Tracking: tracking
[0m03:13:29.772361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B964360730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9643609D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9643607F0>]}
[0m03:13:29.865855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:13:29.866855 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:13:29.880846 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:13:29.904013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:13:29.914041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B964501A50>]}
[0m03:13:29.931038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96447BEE0>]}
[0m03:13:29.932032 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:13:29.933542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96447BE50>]}
[0m03:13:29.936564 [info ] [MainThread]: 
[0m03:13:29.937617 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:13:29.940782 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:13:29.956791 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:13:29.957775 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:13:29.957775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:30.006825 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:13:30.008842 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:13:30.010825 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:13:30.013825 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:13:30.013825 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:13:30.014825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:30.055802 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:13:30.057800 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:13:30.058801 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:13:30.061797 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:13:30.062795 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:13:30.062795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:30.101774 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:13:30.104771 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:13:30.108768 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:13:30.118764 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:13:30.119763 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:13:30.119763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:30.169734 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:13:30.170734 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:13:30.171733 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:13:30.182727 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m03:13:30.185725 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:13:30.186724 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:13:30.187724 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:13:30.192721 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:13:30.193727 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:13:30.193727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:30.252687 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:13:30.253686 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:13:30.253686 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:13:30.263680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:13:30.265680 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:13:30.266678 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:13:30.267678 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:13:30.272675 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:13:30.273674 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:13:30.273674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:30.328644 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:13:30.329643 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:13:30.329643 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:13:30.342635 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:13:30.345633 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:13:30.346633 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:13:30.358626 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:30.358626 [debug] [MainThread]: On master: BEGIN
[0m03:13:30.359626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:30.407598 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:13:30.407598 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:30.408597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:13:30.463566 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:13:30.466565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9644B6470>]}
[0m03:13:30.467565 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:30.468563 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:30.469563 [debug] [MainThread]: On master: BEGIN
[0m03:13:30.470564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:30.470564 [debug] [MainThread]: On master: COMMIT
[0m03:13:30.471562 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:30.471562 [debug] [MainThread]: On master: COMMIT
[0m03:13:30.472561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:30.473560 [debug] [MainThread]: On master: Close
[0m03:13:30.474560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:30.476559 [info ] [MainThread]: 
[0m03:13:30.486554 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:13:30.487552 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:13:30.490551 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.491550 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:13:30.492550 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:13:30.502544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.504543 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:30.505543 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:13:30.581499 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.582499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.582499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:13:30.583498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:13:30.621475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:30.622476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.623475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:13:30.636407 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:13:30.644402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.645402 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:13:30.646402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:30.650399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.651399 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:13:30.652399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:30.686380 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:13:30.686380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.687379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:13:30.689378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:30.698374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:13:30.698374 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:13:30.705369 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:30.709366 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:30.710366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:13:30.711365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9645A7B80>]}
[0m03:13:30.713363 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.22s]
[0m03:13:30.715363 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:13:30.717362 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:13:30.718362 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:13:30.721360 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.724357 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:13:30.725358 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:13:30.737350 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.739349 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:30.740349 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:13:30.750344 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.752342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.752342 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:13:30.753341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:30.850285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m03:13:30.851285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.852284 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:13:30.912250 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.06 seconds
[0m03:13:30.918246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.919246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:13:30.920246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:30.925242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.926242 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:13:30.927241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:30.932239 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:13:30.933238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.933238 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:13:30.935237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:30.939235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:13:30.940234 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:13:30.946230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:30.949229 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:30.949229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:13:30.951227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9645E1A80>]}
[0m03:13:30.952228 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.23s]
[0m03:13:31.007196 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:13:31.008195 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:13:31.009194 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:13:31.019189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.020188 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:13:31.020188 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:13:31.030183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:13:31.031181 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.032181 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:13:31.043175 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:13:31.055168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.056167 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:13:31.057167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.123129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:13:31.124129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.125128 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:13:31.153112 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:13:31.162107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.162107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:13:31.164106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.170102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.171102 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:13:31.173100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.178098 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:13:31.179097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.180096 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:13:31.182095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:31.188092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:13:31.188092 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:13:31.197087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:31.199086 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.200086 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:13:31.201085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B964641180>]}
[0m03:13:31.203084 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.18s]
[0m03:13:31.239064 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:13:31.240062 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:13:31.241062 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:13:31.248058 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.249058 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:13:31.249058 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:13:31.264050 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.266049 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.267048 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:13:31.277043 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.279041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.280040 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:13:31.281041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.324014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:31.324014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.325013 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:13:31.449036 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m03:13:31.453036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.454035 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:13:31.454035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.458032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.459031 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:13:31.460031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.465030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:13:31.465030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.466028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:13:31.469026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:31.475023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:13:31.475023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:13:31.484435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:31.486446 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.486446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:13:31.488435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9644B6B00>]}
[0m03:13:31.489436 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.24s]
[0m03:13:31.491435 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:13:31.492433 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:13:31.494431 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:13:31.496430 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.496430 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:13:31.497430 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:13:31.502427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.504427 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.505426 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:13:31.515419 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.517418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.517418 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:13:31.518419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.559916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:31.559916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.560916 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:13:31.572906 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:31.576906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.577906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:13:31.578903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.584899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.585899 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:13:31.586899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.591895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:13:31.592895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.592895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:13:31.594894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:31.597892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:13:31.598891 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:13:31.602892 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:31.604891 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.605890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:13:31.606887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96466F280>]}
[0m03:13:31.607887 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:13:31.609885 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:13:31.610885 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:13:31.611885 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:13:31.612885 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.613884 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:13:31.614883 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:13:31.620879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.621879 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.622879 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:13:31.632873 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.634871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.635871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:13:31.636870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.696836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:13:31.697836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.697836 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:13:31.726819 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.03 seconds
[0m03:13:31.730817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.731815 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:13:31.733816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.738812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.739812 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:13:31.740811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.744808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:13:31.745808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.745808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:13:31.754804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:13:31.757800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:13:31.758800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:13:31.765796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:31.767797 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.768795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:13:31.769796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96462B3A0>]}
[0m03:13:31.770795 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.16s]
[0m03:13:31.772792 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:13:31.772792 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:13:31.773792 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:13:31.775799 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.776791 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:13:31.777790 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:13:31.784786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.786784 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.786784 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:13:31.796778 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.798779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.798779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:13:31.799778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.852747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:13:31.852747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.853746 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:13:31.866739 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:31.870737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.871735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:13:31.872736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.879731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.880730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:13:31.881730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:31.886727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:13:31.886727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.887728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:13:31.889726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:31.892725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:13:31.893723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:13:31.898720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:31.900719 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.901718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:13:31.902719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646935B0>]}
[0m03:13:31.903718 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.13s]
[0m03:13:31.905716 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:13:31.906716 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:13:31.907718 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:13:31.912721 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:31.913716 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:13:31.914711 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:13:31.920707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:31.921707 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:31.922707 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:13:31.935700 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:31.936700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:31.937698 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:13:31.937698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:31.983672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:13:31.984673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:31.984673 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:13:31.995664 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:31.999663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:32.000662 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:13:32.000662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.004661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:32.004661 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:13:32.005660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.010656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:13:32.010656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:32.011657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:13:32.013386 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:32.016388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:13:32.016388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:13:32.020671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:32.022671 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.022671 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:13:32.023670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B96469FA00>]}
[0m03:13:32.024668 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:13:32.026667 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:13:32.026667 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:13:32.027666 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:13:32.029665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.029665 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:13:32.030665 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:13:32.036661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.037662 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.037662 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:13:32.045657 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.047658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.048654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:13:32.048654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.095629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:13:32.096626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.096626 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:13:32.106139 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:32.110138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.111136 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:13:32.112136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.116133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.116133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:13:32.117133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.121131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:13:32.121131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.122130 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:13:32.155552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.03 seconds
[0m03:13:32.159555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:13:32.160568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:13:32.164962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:32.166979 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.166979 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:13:32.167965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646AF400>]}
[0m03:13:32.168962 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.14s]
[0m03:13:32.170962 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:13:32.171962 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:13:32.172962 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:13:32.173961 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.174961 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:13:32.175959 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:13:32.181956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.182954 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.183954 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:13:32.194947 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.196947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.197947 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:13:32.198946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.243166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:32.244166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.244166 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:13:32.255158 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:32.259156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.260157 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:13:32.261155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.264154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.265152 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:13:32.266152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.269150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:13:32.269150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.270150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:13:32.271954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:32.273956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:13:32.274955 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:13:32.278955 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:32.280957 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.280957 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:13:32.281951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646C0BE0>]}
[0m03:13:32.282952 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.11s]
[0m03:13:32.284951 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:13:32.285950 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:13:32.286949 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:13:32.288948 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.289949 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:13:32.290947 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:13:32.297943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.298944 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.299941 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:13:32.305938 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.306938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.306938 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:13:32.307937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.352911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:32.352911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.353911 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:13:32.366327 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:13:32.369325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.370325 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:13:32.371323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.374322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.375320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:13:32.376320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.379319 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:13:32.380317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.380317 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:13:32.382699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:32.387699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:13:32.387699 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:13:32.392695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:32.394694 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.394694 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:13:32.395695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646F0580>]}
[0m03:13:32.396693 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:13:32.398694 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:13:32.398694 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:13:32.399691 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:13:32.400693 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.401691 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:13:32.401691 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:13:32.468654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.469651 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.470650 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:13:32.476649 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.477647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.478646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:13:32.478646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.515626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:32.516627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.516627 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:13:32.551817 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:13:32.555815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.556814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:13:32.557814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.560811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.561810 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:13:32.562810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:32.566809 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:13:32.567807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.567807 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:13:32.569418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:32.571420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:13:32.572419 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:13:32.576269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:32.578268 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.579269 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:13:32.580266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646E1E70>]}
[0m03:13:32.580266 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.18s]
[0m03:13:32.582265 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:13:32.583266 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:13:32.584264 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:13:32.585264 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:32.586264 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:13:32.587265 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:13:32.594259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:32.596258 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:32.597258 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:13:32.605252 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:32.606253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:32.607251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:13:32.607251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.652226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:13:32.652226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:32.653225 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:13:33.345743 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.69 seconds
[0m03:13:33.348720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:33.349719 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:13:33.350740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:33.352718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:33.353717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:13:33.354719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:33.357736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:13:33.357736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:33.358717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:13:33.360868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:33.363872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:13:33.364870 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:13:33.370503 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:33.372508 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:33.372508 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:13:33.373505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9642BBC10>]}
[0m03:13:33.374504 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.79s]
[0m03:13:33.376505 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:13:33.377504 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:13:33.378501 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:13:33.379502 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.380501 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:13:33.381499 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:13:33.389515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.390798 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:33.390798 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:13:33.401806 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.403793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.403793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:13:33.404792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:33.452986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:13:33.453985 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.453985 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:13:33.468918 [debug] [Thread-1 (]: SQL status: SELECT 1285 in 0.01 seconds
[0m03:13:33.471916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.471916 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:13:33.472917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:33.476913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.476913 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:13:33.477912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:33.482911 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:13:33.483910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.483910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:13:33.485908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:13:33.489905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:13:33.489905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:13:33.496902 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:13:33.497902 [debug] [Thread-1 (]: finished collecting timing info
[0m03:13:33.498900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:13:33.499898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6937164b-9bb0-4091-a3f2-3469fd93407c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B964631300>]}
[0m03:13:33.500901 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1285[0m in 0.12s]
[0m03:13:33.501897 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:13:33.503896 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:13:33.504898 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:33.504898 [debug] [MainThread]: On master: BEGIN
[0m03:13:33.505897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:33.553868 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:13:33.553868 [debug] [MainThread]: On master: COMMIT
[0m03:13:33.554868 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:33.555867 [debug] [MainThread]: On master: COMMIT
[0m03:13:33.555867 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:33.556867 [debug] [MainThread]: On master: Close
[0m03:13:33.557865 [info ] [MainThread]: 
[0m03:13:33.558865 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m03:13:33.560877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:33.561866 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:13:33.561866 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:13:33.561866 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:13:33.573858 [info ] [MainThread]: 
[0m03:13:33.574856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:13:33.576857 [info ] [MainThread]: 
[0m03:13:33.578854 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:13:33.580853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B964640190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9646438E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9645A5C30>]}


============================== 2022-11-23 03:24:09.159345 | 019c1ea9-6829-4e6a-a6e6-b95917e3a205 ==============================
[0m03:24:09.159345 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:24:09.160345 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:24:09.161326 [debug] [MainThread]: Tracking: tracking
[0m03:24:09.179414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18395DCF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183980970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183980760>]}
[0m03:24:09.281391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:24:09.282392 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:24:09.296383 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:24:09.322388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:24:09.335361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B21990>]}
[0m03:24:09.349353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1839484C0>]}
[0m03:24:09.350354 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:24:09.352352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D18395DCF0>]}
[0m03:24:09.355370 [info ] [MainThread]: 
[0m03:24:09.356376 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:24:09.359347 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:24:09.376358 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:24:09.376358 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:24:09.377339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:09.427319 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:24:09.430309 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:24:09.431305 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:24:09.434319 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:24:09.434319 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:24:09.435306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:09.478281 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:24:09.479294 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:24:09.481277 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:24:09.483291 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:24:09.484291 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:24:09.484291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:09.524252 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:24:09.527266 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:24:09.530249 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:24:09.538245 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:24:09.538245 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:24:09.539244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:24:09.578222 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:24:09.578222 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:24:09.579224 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:24:09.586232 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:24:09.588218 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:24:09.589215 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:24:09.590217 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:24:09.592229 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:24:09.593228 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:24:09.593228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:09.631191 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:24:09.632208 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:24:09.632208 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:24:09.639187 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:24:09.641202 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:24:09.642186 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:24:09.643184 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:24:09.646185 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:24:09.646185 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:24:09.647184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:24:09.687175 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:24:09.687175 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:24:09.688161 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:24:09.695156 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:24:09.697155 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:24:09.697155 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:24:09.704150 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:09.704150 [debug] [MainThread]: On master: BEGIN
[0m03:24:09.705152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:24:09.744154 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:24:09.745154 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:09.745154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:24:09.780132 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:24:09.782133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183AD52A0>]}
[0m03:24:09.783136 [debug] [MainThread]: On master: ROLLBACK
[0m03:24:09.783136 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:09.784131 [debug] [MainThread]: On master: BEGIN
[0m03:24:09.784131 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:24:09.785131 [debug] [MainThread]: On master: COMMIT
[0m03:24:09.785131 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:09.786129 [debug] [MainThread]: On master: COMMIT
[0m03:24:09.786129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:24:09.787135 [debug] [MainThread]: On master: Close
[0m03:24:09.788130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:24:09.789010 [info ] [MainThread]: 
[0m03:24:09.799008 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:24:09.800010 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:24:09.801007 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.802008 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:24:09.802008 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:24:09.807005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.809002 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:09.809002 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:24:09.872968 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.874967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.874967 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:24:09.875980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:24:09.913942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:24:09.914946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.914946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:24:09.933931 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:24:09.942925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.942925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:24:09.944925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:09.949922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.950921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:24:09.951920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:09.989898 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:24:09.990898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:09.991897 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:24:09.993896 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:10.001892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:24:10.001892 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:24:10.006888 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:24:10.009887 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.010886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:24:10.011886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183BC7400>]}
[0m03:24:10.012887 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.21s]
[0m03:24:10.014885 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:24:10.015886 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:24:10.015886 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:24:10.017883 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.017883 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:24:10.018883 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:24:10.026878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.029876 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.030876 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:24:10.040871 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.042869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.042869 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:24:10.043869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.095838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:10.096838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.097837 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:24:10.108832 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:24:10.112830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.112830 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:24:10.114827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.118827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.119826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:24:10.120823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.124821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:24:10.125823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.126821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:24:10.127820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:10.131817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:24:10.132817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:24:10.136816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:24:10.138813 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.139813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:24:10.140813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B857B0>]}
[0m03:24:10.141812 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:24:10.143811 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:24:10.144810 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:24:10.145810 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:24:10.147810 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.148809 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:24:10.148809 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:24:10.158803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:24:10.159802 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.160802 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:24:10.169797 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:24:10.171795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.172794 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:24:10.173794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.231761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:24:10.232760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.233760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:24:10.253749 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:24:10.257747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.258745 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:24:10.259744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.267740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.267740 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:24:10.269739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.273736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:24:10.274736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.274736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:24:10.276735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:10.281734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:24:10.282732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:24:10.288874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:10.290873 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.291872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:24:10.292873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183C61180>]}
[0m03:24:10.293872 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.15s]
[0m03:24:10.295870 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:24:10.295870 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:24:10.296870 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:24:10.298868 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.298868 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:24:10.299868 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:24:10.306863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.308862 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.309862 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:24:10.318857 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.320857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.320857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:24:10.321855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.365831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:24:10.366829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.366829 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:24:10.467734 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:24:10.470751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.471734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:24:10.472732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.475747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.475747 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:24:10.476728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.480724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:24:10.481724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.481724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:24:10.484722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:10.487722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:24:10.488720 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:24:10.495535 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:10.497532 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.498531 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:24:10.499551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183AB1F00>]}
[0m03:24:10.500530 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:24:10.502529 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:24:10.503531 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:24:10.504528 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:24:10.505544 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.506530 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:24:10.507526 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:24:10.515522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.517522 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.517522 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:24:10.523516 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.524521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.524521 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:24:10.525522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.574377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:10.575381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.575381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:24:10.589469 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:24:10.593467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.594466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:24:10.595466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.600478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.601477 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:24:10.602461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.605475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:24:10.606475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.606475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:24:10.608694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:10.611473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:24:10.612471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:24:10.621724 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:10.623723 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.624723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:24:10.625724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183C84550>]}
[0m03:24:10.626722 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:24:10.627720 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:24:10.628723 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:24:10.629719 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:24:10.630722 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.631721 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:24:10.632719 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:24:10.638715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.640714 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.640714 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:24:10.649708 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.651710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.651710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:24:10.652706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.705676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:10.706676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.706676 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:24:10.735659 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.03 seconds
[0m03:24:10.738658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.739657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:24:10.740656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.743655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.744654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:24:10.745654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.748652 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:24:10.749651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.750651 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:24:10.771131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m03:24:10.774133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:24:10.775132 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:24:10.781128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:10.783126 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.783126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:24:10.784126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B85480>]}
[0m03:24:10.785125 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.15s]
[0m03:24:10.787126 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:24:10.788124 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:24:10.788124 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:24:10.790123 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.791122 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:24:10.791122 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:24:10.801116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.803309 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.803309 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:24:10.809323 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.810323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.811308 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:24:10.812308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:10.869275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:24:10.870275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.871274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:24:10.897258 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:24:10.903260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.904256 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:24:10.906255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.912250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.912250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:24:10.914249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:10.921247 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:24:10.922246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.922246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:24:10.929240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:24:10.932238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:24:10.933238 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:24:10.940234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:10.943232 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.944232 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:24:10.946231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183CBF580>]}
[0m03:24:10.947230 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.16s]
[0m03:24:10.949231 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:24:10.950228 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:24:10.951228 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:24:10.953228 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:10.954226 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:24:10.955226 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:24:10.962222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:10.964220 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:10.965220 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:24:10.978213 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:10.981212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:10.981212 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:24:10.982211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.037180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:11.038178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:11.038178 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:24:11.051171 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:24:11.057168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:11.057168 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:24:11.059167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.064165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:11.065164 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:24:11.066162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.071162 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:24:11.072165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:11.073158 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:24:11.075158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:11.080155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:24:11.081154 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:24:11.088150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:11.090148 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.091147 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:24:11.092148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B852A0>]}
[0m03:24:11.093149 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.14s]
[0m03:24:11.094146 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:24:11.095146 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:24:11.096146 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:24:11.098144 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.099144 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:24:11.099144 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:24:11.107139 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.109138 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.110137 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:24:11.120131 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.122130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.123130 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:24:11.124129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.170103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:11.171102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.171102 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:24:11.183095 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:24:11.189092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.190091 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:24:11.191090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.197087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.197087 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:24:11.199086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.203083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:24:11.203083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.204084 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:24:11.205083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:11.210080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:24:11.211080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:24:11.217077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:11.220076 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.220076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:24:11.221074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B85180>]}
[0m03:24:11.222073 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:24:11.224071 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:24:11.225073 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:24:11.226070 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:24:11.227070 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.228070 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:24:11.229069 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:24:11.235066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.236065 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.237064 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:24:11.246060 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.248058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.248058 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:24:11.249058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.300028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:24:11.301028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.302027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:24:11.323015 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:24:11.330010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.330010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:24:11.332010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.337007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.338006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:24:11.339006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.345002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:24:11.346002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.347001 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:24:11.349000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:11.351998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:24:11.352998 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:24:11.358995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:11.361993 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.362992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:24:11.363991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B850C0>]}
[0m03:24:11.364991 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.14s]
[0m03:24:11.366990 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:24:11.367989 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:24:11.368989 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:24:11.370988 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.371987 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:24:11.372987 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:24:11.381982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.384980 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.384980 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:24:11.391975 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.392975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.393974 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:24:11.394977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.456939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:24:11.457938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.457938 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:24:11.476927 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:24:11.483924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.484923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:24:11.485922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.492918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.493917 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:24:11.494918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.501913 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:24:11.501913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.502912 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:24:11.504911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:11.512906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:24:11.513906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:24:11.521902 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:11.524900 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.525900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:24:11.526899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B84FD0>]}
[0m03:24:11.527898 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.16s]
[0m03:24:11.529897 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:24:11.530896 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:24:11.530896 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:24:11.532895 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.533896 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:24:11.534895 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:24:11.622844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.624843 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.625842 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:24:11.635836 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.637835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.638834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:24:11.638834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.722787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m03:24:11.723786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.723786 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:24:11.795745 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.07 seconds
[0m03:24:11.803740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.804740 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:24:11.805739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.812736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.812736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:24:11.813735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:11.819732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:24:11.819732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.820731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:24:11.824728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:11.829726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:24:11.830725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:24:11.839720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:11.843717 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.843717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:24:11.845719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183CF6800>]}
[0m03:24:11.846716 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.31s]
[0m03:24:11.849715 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:24:11.849715 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:24:11.850714 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:24:11.853714 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:11.854712 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:24:11.855711 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:24:11.864706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:11.866705 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:11.867704 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:24:11.886693 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:11.888692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:11.888692 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:24:11.889691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:11.953655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:24:11.954654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:11.954654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:24:12.778183 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.82 seconds
[0m03:24:12.782182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:12.783180 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:24:12.784180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:12.788177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:12.789176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:24:12.790177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:12.795174 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:24:12.796173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:12.796173 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:24:12.799171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:12.803169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:24:12.804168 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:24:12.810165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:12.812164 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:12.813163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:24:12.814163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183C9D870>]}
[0m03:24:12.815162 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.96s]
[0m03:24:12.817161 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:24:12.818161 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:24:12.819161 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:24:12.821159 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.822159 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:24:12.823158 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:24:12.836150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.838149 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:12.838149 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:24:12.850142 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.852142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.852142 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:24:12.853140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:24:12.939091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.09 seconds
[0m03:24:12.940091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.940091 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spg1.id_song,
    spg1.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    full outer join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:24:12.959080 [debug] [Thread-1 (]: SQL status: SELECT 1285 in 0.02 seconds
[0m03:24:12.967076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.967076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:24:12.969075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:12.975071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.976070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:24:12.977069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:24:12.983066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:24:12.984066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.984066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:24:12.987064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:24:12.991062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:24:12.992061 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:24:13.000056 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:24:13.003057 [debug] [Thread-1 (]: finished collecting timing info
[0m03:24:13.003057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:24:13.005054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '019c1ea9-6829-4e6a-a6e6-b95917e3a205', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183BB7610>]}
[0m03:24:13.006053 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1285[0m in 0.18s]
[0m03:24:13.008053 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:24:13.010050 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:24:13.011051 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:13.012050 [debug] [MainThread]: On master: BEGIN
[0m03:24:13.012050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:24:13.087007 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:24:13.088006 [debug] [MainThread]: On master: COMMIT
[0m03:24:13.088006 [debug] [MainThread]: Using postgres connection "master"
[0m03:24:13.089005 [debug] [MainThread]: On master: COMMIT
[0m03:24:13.090005 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:24:13.090005 [debug] [MainThread]: On master: Close
[0m03:24:13.092004 [info ] [MainThread]: 
[0m03:24:13.093004 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m03:24:13.095003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:24:13.096003 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:24:13.096003 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:24:13.097001 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:24:13.114991 [info ] [MainThread]: 
[0m03:24:13.115990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:24:13.118989 [info ] [MainThread]: 
[0m03:24:13.119989 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:24:13.121987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B85960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B85C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D183B86DA0>]}


============================== 2022-11-23 03:26:00.518823 | 3b097e53-91d1-418b-a8f0-e69e90fbc2f9 ==============================
[0m03:26:00.518823 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:26:00.519822 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:26:00.520822 [debug] [MainThread]: Tracking: tracking
[0m03:26:00.539324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3098D0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3098D09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3098D07F0>]}
[0m03:26:00.633119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:00.634118 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:26:00.648090 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:26:00.671078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:26:00.689067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309A6D9F0>]}
[0m03:26:00.708057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3099FBA60>]}
[0m03:26:00.709057 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:26:00.710055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F30989BF40>]}
[0m03:26:00.717051 [info ] [MainThread]: 
[0m03:26:00.718650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:00.721652 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:00.736656 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:00.736656 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:00.737656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:00.789274 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:26:00.791274 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:00.792273 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:00.796271 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:00.797273 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:00.798269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:00.840245 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:26:00.842245 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:00.843243 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:00.847241 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:00.847241 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:00.848243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:00.885219 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:26:00.888220 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:00.891216 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:00.899212 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:00.899212 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:26:00.900213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:00.939188 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:26:00.939188 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:00.940190 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:26:00.947184 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:26:00.949195 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:26:00.950197 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:26:00.951197 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:00.954195 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:00.954195 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:26:00.955182 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:00.995157 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:26:00.995157 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:00.996156 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:26:01.003163 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:26:01.005153 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:26:01.006151 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:26:01.007150 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:01.010163 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:01.010163 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:26:01.011147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:01.052124 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:26:01.052124 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:01.053126 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:26:01.060131 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:26:01.062118 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:26:01.063117 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:26:01.069129 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:01.070114 [debug] [MainThread]: On master: BEGIN
[0m03:26:01.070114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:01.112090 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:26:01.112090 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:01.113090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:26:01.147090 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:26:01.149071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309A24220>]}
[0m03:26:01.150070 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:01.151070 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:01.151070 [debug] [MainThread]: On master: BEGIN
[0m03:26:01.152067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:01.152067 [debug] [MainThread]: On master: COMMIT
[0m03:26:01.153066 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:01.153066 [debug] [MainThread]: On master: COMMIT
[0m03:26:01.154067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.154067 [debug] [MainThread]: On master: Close
[0m03:26:01.155065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:01.156065 [info ] [MainThread]: 
[0m03:26:01.165077 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:26:01.166059 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:26:01.168060 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.169061 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:26:01.169061 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:26:01.174057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.175054 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.176053 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:26:01.242030 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.243015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.244030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:26:01.244030 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:26:01.283735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:01.283735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.284737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:26:01.300258 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:26:01.308267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.308267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:26:01.309251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.314264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.314264 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:26:01.315250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.346246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:26:01.346246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.347231 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:26:01.349325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.355345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:01.355345 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:26:01.359764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:01.361762 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.362761 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:26:01.363761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309C23460>]}
[0m03:26:01.364781 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.20s]
[0m03:26:01.366759 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:26:01.367758 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:26:01.368760 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:26:01.370758 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.371757 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:26:01.372756 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:26:01.377773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.379758 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.380751 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:26:01.387768 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.388746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.389746 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:26:01.389746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:01.435343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:01.435343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.436343 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:26:01.446885 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:26:01.450895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.450895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:26:01.451880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.455879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.455879 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:26:01.456877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.460877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:26:01.460877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.461875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:26:01.463872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.465871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:01.466871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:26:01.471868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:01.473882 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.474881 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:26:01.475866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE17B0>]}
[0m03:26:01.476865 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:26:01.478865 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:26:01.479864 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:26:01.480863 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:26:01.481863 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.482863 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:26:01.483862 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:26:01.491857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:26:01.493856 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.494855 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:26:01.504852 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:26:01.506851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.506851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:26:01.507851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:01.559818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:01.559818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.560817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:26:01.580805 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:26:01.584805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.585803 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:26:01.586802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.592800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.592800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:26:01.594799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.598797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:26:01.598797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.599795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:26:01.601794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.604794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:01.604794 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:26:01.611788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:01.613790 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.614786 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:26:01.615786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309AB4FD0>]}
[0m03:26:01.616786 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:26:01.618784 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:26:01.619784 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:26:01.619784 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:26:01.621784 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.622783 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:26:01.623782 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:26:01.636774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.638774 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.638774 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:26:01.650774 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.652766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.652766 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:26:01.653765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:01.702738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:01.702738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.703736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:26:01.825666 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m03:26:01.829664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.829664 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:26:01.830664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.833662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.834660 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:26:01.835661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.838659 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:26:01.838659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.839658 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:26:01.842115 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.845116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:01.846115 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:26:01.850836 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:01.852835 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.853834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:26:01.854834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3098D0A60>]}
[0m03:26:01.855833 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.23s]
[0m03:26:01.857832 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:26:01.857832 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:01.858831 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:26:01.860831 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.861834 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:01.861834 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:01.867826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.869825 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.870824 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:01.879832 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.881818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.882818 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:26:01.883818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:01.925793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:01.925793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.926793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:26:01.938502 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:01.942498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.942498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:26:01.943498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.949495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.950495 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:26:01.951493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:01.954492 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:26:01.955492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.955492 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:26:01.957492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:01.960488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:01.961488 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:26:01.966570 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:01.968570 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.969568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:26:01.969568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309AD85B0>]}
[0m03:26:01.970567 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:26:01.972567 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:01.973566 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:01.974565 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:26:01.976565 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:01.977564 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:01.979564 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:01.985560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:01.987217 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:01.987217 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:01.993231 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:01.994216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:01.994216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:26:01.996215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.040190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.041190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:02.042189 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:26:02.057990 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:26:02.062998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:02.062998 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:26:02.063985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.067984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:02.068984 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:26:02.069982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.073980 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:26:02.074978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:02.074978 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:26:02.077983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.081983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:02.081983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:26:02.087463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.089463 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.090461 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:26:02.091462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE1480>]}
[0m03:26:02.092461 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.12s]
[0m03:26:02.094459 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:02.094459 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:02.095459 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:26:02.097459 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.097459 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:02.099459 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:02.104454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.106453 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.106453 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:02.115449 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.117447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.118446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:26:02.118446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.159426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.159426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.160422 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:26:02.172760 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:02.176758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.176758 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:26:02.177759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.181757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.182756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:26:02.183755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.190751 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:26:02.191750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.192749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:26:02.194747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.197748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:02.198746 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:26:02.204399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.206399 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.207397 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:26:02.208397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309B0F0A0>]}
[0m03:26:02.208397 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:26:02.210396 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:02.211395 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:26:02.211395 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:26:02.213397 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.214395 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:26:02.215394 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:26:02.220391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.221390 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.222390 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:26:02.228387 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.232384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.233384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:26:02.233384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.277359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.278358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.279357 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:26:02.289178 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:02.293175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.294175 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:26:02.295174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.299171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.300172 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:26:02.301170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.304169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:26:02.304169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.305169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:26:02.306776 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.309777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:02.309777 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:26:02.315775 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:02.317773 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.317773 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:26:02.318771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE12A0>]}
[0m03:26:02.319773 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:26:02.322770 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:26:02.322770 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:02.323785 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:26:02.325768 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.326770 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:02.326770 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:26:02.333778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.334778 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.335764 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:02.340775 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.342759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.342759 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:26:02.343758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.387732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.388735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.388735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:26:02.400417 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:02.405412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.406411 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:26:02.407413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.410410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.411409 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:26:02.412411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.416407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:26:02.416407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.417407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:26:02.419404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.427402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:02.427402 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:26:02.433761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:02.435776 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.435776 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:26:02.436760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE1420>]}
[0m03:26:02.437759 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:26:02.439758 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:02.439758 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:26:02.440757 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:26:02.441773 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.442757 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:26:02.443757 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:26:02.452752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.453750 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.454762 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:26:02.461747 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.463744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.464744 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:26:02.465744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.509719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.509719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.510718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:26:02.523763 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:02.526762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.527762 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:26:02.528762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.532758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.532758 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:26:02.533758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.536756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:26:02.536756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.537756 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:26:02.539078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.542080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:02.542080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:26:02.549076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:02.551075 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.552074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:26:02.553073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE10C0>]}
[0m03:26:02.554072 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.11s]
[0m03:26:02.556072 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:26:02.557071 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:26:02.557071 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:26:02.559069 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.560070 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:26:02.561070 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:26:02.568065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.570063 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.570063 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:26:02.577059 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.580064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.581058 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:26:02.582057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.626031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.627031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.628030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:26:02.642024 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:02.646021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.647019 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:26:02.648020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.651017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.651017 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:26:02.653016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.656014 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:26:02.657013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.657013 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:26:02.659396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.664396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:02.664396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:26:02.671391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:02.673390 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.674389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:26:02.675390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309BE1150>]}
[0m03:26:02.676389 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:26:02.679386 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:26:02.680386 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:26:02.681386 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:26:02.683386 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.684385 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:26:02.685384 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:26:02.751345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.752344 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.753345 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:26:02.758342 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.760340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.760340 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:26:02.761339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.799317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:02.800318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.801318 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:26:02.839294 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.04 seconds
[0m03:26:02.843294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.844294 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:26:02.845291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.849291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.850288 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:26:02.851288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.855287 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:26:02.855287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.856285 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:26:02.858284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.861282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:02.862282 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:26:02.867280 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.869278 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.870277 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:26:02.871277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309B46D70>]}
[0m03:26:02.872276 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.19s]
[0m03:26:02.875275 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:26:02.875275 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:26:02.876274 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:26:02.878273 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:02.879273 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:26:02.880272 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:26:02.887268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:02.888267 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:02.889267 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:26:02.896264 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:02.897262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:02.898262 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:26:02.898262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:02.953230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:02.953230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:02.954229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:26:03.531900 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.58 seconds
[0m03:26:03.535912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:03.535912 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:26:03.536898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:03.539896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:03.540893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:26:03.541895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:03.544907 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:26:03.545906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:03.545906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:26:03.548287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:03.551308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:03.551308 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:26:03.557367 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:03.559371 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:03.560367 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:26:03.561367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309AEC250>]}
[0m03:26:03.563367 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.68s]
[0m03:26:03.564366 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:26:03.566364 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:26:03.566364 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:26:03.568366 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:03.569363 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:26:03.570362 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:26:03.581361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:03.583363 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:03.584354 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:26:03.590366 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:03.591366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:03.591366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:26:03.592366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:03.636867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:03.636867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:03.637869 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre_1
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    full outer join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:26:03.638867 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna spsg.genre_1
LINE 11:     spsg.genre_1
             ^
HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre» o la columna «spg1.genre_1».

[0m03:26:03.639876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: ROLLBACK
[0m03:26:03.639876 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:03.640880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:26:03.641865 [debug] [Thread-1 (]: Database Error in model stg_genre_2 (models\staging\genre\stg_genre_2.sql)
  no existe la columna spsg.genre_1
  LINE 11:     spsg.genre_1
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre» o la columna «spg1.genre_1».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_2.sql
[0m03:26:03.641865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b097e53-91d1-418b-a8f0-e69e90fbc2f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309C3EE90>]}
[0m03:26:03.642863 [error] [Thread-1 (]: 14 of 14 ERROR creating table model SummerSong_staging.stg_genre_2 ............. [[31mERROR[0m in 0.07s]
[0m03:26:03.644862 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:26:03.646862 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:03.647876 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:03.647876 [debug] [MainThread]: On master: BEGIN
[0m03:26:03.648862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:03.693835 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:26:03.693835 [debug] [MainThread]: On master: COMMIT
[0m03:26:03.694834 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:03.695835 [debug] [MainThread]: On master: COMMIT
[0m03:26:03.696832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:03.697833 [debug] [MainThread]: On master: Close
[0m03:26:03.699831 [info ] [MainThread]: 
[0m03:26:03.700832 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m03:26:03.702830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:03.702830 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:26:03.703829 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:26:03.704828 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:26:03.718821 [info ] [MainThread]: 
[0m03:26:03.719819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:03.721819 [info ] [MainThread]: 
[0m03:26:03.722820 [error] [MainThread]: [33mDatabase Error in model stg_genre_2 (models\staging\genre\stg_genre_2.sql)[0m
[0m03:26:03.723818 [error] [MainThread]:   no existe la columna spsg.genre_1
[0m03:26:03.724816 [error] [MainThread]:   LINE 11:     spsg.genre_1
[0m03:26:03.725816 [error] [MainThread]:                ^
[0m03:26:03.726815 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre» o la columna «spg1.genre_1».
[0m03:26:03.727815 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_2.sql
[0m03:26:03.730814 [info ] [MainThread]: 
[0m03:26:03.733813 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m03:26:03.736811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309C3D420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309C3FA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F309C3FA90>]}


============================== 2022-11-23 03:26:28.611086 | ec898dba-5bfe-47ab-b3ac-217889fff089 ==============================
[0m03:26:28.611086 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:26:28.613088 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:26:28.614086 [debug] [MainThread]: Tracking: tracking
[0m03:26:28.634073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17D2F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17D50970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17D50700>]}
[0m03:26:28.763000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:28.764000 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:26:28.778990 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:26:28.802978 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:26:28.815971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17EED990>]}
[0m03:26:28.830962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17D1A5C0>]}
[0m03:26:28.831960 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:26:28.833960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17D2F2E0>]}
[0m03:26:28.836959 [info ] [MainThread]: 
[0m03:26:28.838959 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:28.841955 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:28.859944 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:28.859944 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:28.860944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:28.908919 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:26:28.910915 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:28.911914 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:28.914914 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:28.915913 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:28.916912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:28.954890 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:26:28.956889 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:28.957888 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:26:28.960887 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:26:28.961886 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:26:28.962886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:29.002862 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:26:29.005861 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:26:29.008861 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:29.016855 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:29.017856 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:26:29.017856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:29.055832 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:26:29.056832 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:26:29.056832 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:26:29.063828 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:26:29.065829 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:26:29.066828 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:26:29.067825 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:29.070824 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:29.070824 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:26:29.071824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:29.110801 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:26:29.111803 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:26:29.111803 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:26:29.118799 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:26:29.120798 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:26:29.121795 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:26:29.122794 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:29.128792 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:29.129790 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:26:29.129790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:26:29.305182 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m03:26:29.305182 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:26:29.306184 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:26:29.314181 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:26:29.316181 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:26:29.317180 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:26:29.324178 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:29.325192 [debug] [MainThread]: On master: BEGIN
[0m03:26:29.325192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:29.365152 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:26:29.366163 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:29.367151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:26:29.399148 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:26:29.401134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17EA4AF0>]}
[0m03:26:29.402133 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:29.403133 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:29.403133 [debug] [MainThread]: On master: BEGIN
[0m03:26:29.404129 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:29.404129 [debug] [MainThread]: On master: COMMIT
[0m03:26:29.405129 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:29.405129 [debug] [MainThread]: On master: COMMIT
[0m03:26:29.406131 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:29.406131 [debug] [MainThread]: On master: Close
[0m03:26:29.407130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:29.408128 [info ] [MainThread]: 
[0m03:26:29.418124 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:26:29.419123 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:26:29.420122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.421120 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:26:29.421120 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:26:29.426118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.429116 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:29.431121 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:26:29.490101 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.492101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.493082 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:26:29.493082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:26:29.535055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:29.536071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.537056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:26:29.552176 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:26:29.561173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.562172 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:26:29.563192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.567167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.568166 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:26:29.569188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.600150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:26:29.601150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.602150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:26:29.603709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:29.609723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:26:29.609723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:26:29.614549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:29.616561 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:29.616561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:26:29.617549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE180A3400>]}
[0m03:26:29.618549 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.20s]
[0m03:26:29.620548 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:26:29.620548 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:26:29.621550 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:26:29.622568 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.623551 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:26:29.623551 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:26:29.631542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.632541 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:29.633541 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:26:29.640557 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.641557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.642535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:26:29.642535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:29.822824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.18 seconds
[0m03:26:29.823821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.823821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:26:29.835814 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:26:29.841826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.841826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:26:29.843810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.847822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.848814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:26:29.849807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.854814 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:26:29.855818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.856804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:26:29.857802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:29.861802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:26:29.862800 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:26:29.866797 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:29.868798 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:29.869797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:26:29.870794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE180617B0>]}
[0m03:26:29.871794 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.25s]
[0m03:26:29.873793 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:26:29.874805 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:26:29.875791 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:26:29.876794 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.877791 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:26:29.878790 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:26:29.886786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:26:29.887784 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:29.887784 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:26:29.893781 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:26:29.894780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.897779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:26:29.898779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:29.952747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:29.953747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.954748 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:26:29.976735 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:26:29.980732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.981731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:26:29.982732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.987729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.987729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:26:29.988727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:29.992724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:26:29.992724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.993724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:26:29.995723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:29.998721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:26:29.998721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:26:30.003718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.006716 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.006716 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:26:30.007717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17F31180>]}
[0m03:26:30.009715 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:26:30.010714 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:26:30.011714 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:26:30.012713 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:26:30.014714 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.014714 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:26:30.015713 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:26:30.024708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.026707 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.027705 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:26:30.036699 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.037699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.038698 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:26:30.039698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.088670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:30.088670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.089669 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:26:30.195609 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.11 seconds
[0m03:26:30.199607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.200606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:26:30.201607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.204604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.205603 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:26:30.206602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.208616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:26:30.209616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.209616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:26:30.212599 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.215600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:26:30.216599 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:26:30.220594 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.222622 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.223595 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:26:30.224592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17E81D50>]}
[0m03:26:30.224592 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.21s]
[0m03:26:30.226592 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:26:30.227593 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:30.228592 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:26:30.230591 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.230591 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:30.231589 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:30.236585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.238584 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.238584 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:30.244580 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.247579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.248580 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:26:30.249579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.297565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:30.297565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.298550 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:26:30.308544 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:30.313541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.313541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:26:30.314540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.319538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.320537 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:26:30.321539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.324535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:26:30.325534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.325534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:26:30.327534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.330536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:26:30.331534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:26:30.335189 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.337188 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.337188 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:26:30.338186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17F54550>]}
[0m03:26:30.339187 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:26:30.340185 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:26:30.341185 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:30.342185 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:26:30.343185 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.344184 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:30.345183 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:30.351179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.353178 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.353178 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:30.361173 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.364172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.365171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:26:30.365171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.410147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:30.410147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.411145 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:26:30.427136 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:26:30.431133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.432133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:26:30.433134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.436130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.437131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:26:30.438131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.440129 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:26:30.441127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.441127 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:26:30.443983 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.446984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:26:30.446984 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:26:30.453230 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:26:30.455229 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.455229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:26:30.456229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18061480>]}
[0m03:26:30.457228 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.11s]
[0m03:26:30.459227 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:26:30.459227 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:30.460228 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:26:30.461226 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.462227 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:30.463227 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:30.468223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.469223 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.470220 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:30.476217 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.477217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.477217 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:26:30.481215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.528187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:30.529188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.529188 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:26:30.542102 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:30.546101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.547099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:26:30.548099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.551097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.551097 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:26:30.552096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.558093 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:26:30.559092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.559092 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:26:30.561285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.564107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:26:30.565105 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:26:30.568751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.570749 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.570749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:26:30.572748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17F8FFD0>]}
[0m03:26:30.572748 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:26:30.574748 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:26:30.575746 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:26:30.575746 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:26:30.577746 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.578745 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:26:30.579745 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:26:30.584741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.586740 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.586740 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:26:30.594735 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.597734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.598734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:26:30.599733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.642707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:30.643708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.643708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:26:30.654689 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:30.658686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.659687 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:26:30.659687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.664683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.664683 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:26:30.665683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.671680 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:26:30.672679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.672679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:26:30.674678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.679675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:26:30.680675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:26:30.686671 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.688672 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.689670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:26:30.690669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE180612A0>]}
[0m03:26:30.691668 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:26:30.693668 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:26:30.694667 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:30.695666 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:26:30.697666 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.698665 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:30.700664 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:26:30.707659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.708659 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.709659 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:30.720652 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.721652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.722650 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:26:30.722650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.767624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:30.767624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.768624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:26:30.779617 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:30.783615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.783615 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:26:30.784615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.787613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.788612 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:26:30.789613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.792610 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:26:30.792610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.793611 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:26:30.795609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.799607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:26:30.799607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:26:30.803952 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.805951 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.806950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:26:30.806950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18061420>]}
[0m03:26:30.807948 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:26:30.809948 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:26:30.810946 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:26:30.810946 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:26:30.812945 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.813948 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:26:30.814944 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:26:30.819941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.821940 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.821940 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:26:30.828936 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.830935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.831935 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:26:30.832934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.873910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:30.874910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.874910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:26:30.885540 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:30.889538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.890537 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:26:30.891538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.894535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.894535 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:26:30.896534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:30.899533 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:26:30.900532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.900532 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:26:30.902647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:30.905649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:26:30.905649 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:26:30.910587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:30.912586 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.913585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:26:30.914585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE180610C0>]}
[0m03:26:30.915584 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.10s]
[0m03:26:30.917583 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:26:30.918583 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:26:30.919582 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:26:30.920581 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:30.921581 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:26:30.922580 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:26:30.927593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:26:30.929576 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:30.931575 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:26:30.939572 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:26:30.940571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:30.941572 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:26:30.941572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:30.985544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:30.986543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:30.987543 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:26:30.999536 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:26:31.002534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:31.002534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:26:31.003535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.006531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:31.007532 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:26:31.008530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.012529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:26:31.013529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:31.013529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:26:31.015552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:31.019553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:26:31.019553 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:26:31.024048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:31.026048 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:31.027046 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:26:31.027046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18060FD0>]}
[0m03:26:31.028046 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:26:31.030045 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:26:31.031044 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:26:31.031044 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:26:31.033044 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.034043 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:26:31.034043 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:26:31.094007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.096007 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:31.096007 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:26:31.102004 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.103003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.104001 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:26:31.104001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:31.142979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:31.143979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.143979 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:26:31.186954 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.04 seconds
[0m03:26:31.190953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.190953 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:26:31.191951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.195950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.196950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:26:31.197948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.203944 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:26:31.203944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.204945 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:26:31.206943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:31.210940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:26:31.210940 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:26:31.215939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:31.218936 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:31.218936 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:26:31.219935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17FC19C0>]}
[0m03:26:31.220935 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2007[0m in 0.19s]
[0m03:26:31.222933 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:26:31.223935 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:26:31.224933 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:26:31.225933 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.226932 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:26:31.227931 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:26:31.235927 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.236926 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:31.237925 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:26:31.248919 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.250918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.251917 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:26:31.251917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:31.304888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:26:31.304888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.305887 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:26:31.959527 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.65 seconds
[0m03:26:31.963513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.963513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:26:31.964510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.968507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.968507 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:26:31.969507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:31.972507 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:26:31.973507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.973507 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:26:31.975515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:31.978502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:26:31.978502 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:26:31.983346 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:31.985359 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:31.986341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:26:31.987341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE17F6D870>]}
[0m03:26:31.987341 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.76s]
[0m03:26:31.989340 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:26:31.990339 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:26:31.991345 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:26:31.993339 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:31.994337 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:26:31.995337 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:26:32.004334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.005333 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:32.006332 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:26:32.013328 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.015325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.016326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:26:32.017324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:26:32.058649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:26:32.058649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.059645 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg  
    full outer join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spg1.id_song=spsg.id_song where not spsg.genre = spg1.genre_1

)

select * from stg_genre_2
  );
[0m03:26:32.077208 [debug] [Thread-1 (]: SQL status: SELECT 1699 in 0.02 seconds
[0m03:26:32.082192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.082192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:26:32.083189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:32.087189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.088188 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:26:32.089187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:32.092199 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:26:32.093185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.093185 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:26:32.095182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:26:32.098183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:26:32.099180 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:26:32.103820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:32.105818 [debug] [Thread-1 (]: finished collecting timing info
[0m03:26:32.106817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:26:32.107816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec898dba-5bfe-47ab-b3ac-217889fff089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE180935B0>]}
[0m03:26:32.108815 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1699[0m in 0.12s]
[0m03:26:32.110815 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:26:32.112816 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:26:32.113813 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:32.113813 [debug] [MainThread]: On master: BEGIN
[0m03:26:32.114812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:32.159915 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:26:32.160918 [debug] [MainThread]: On master: COMMIT
[0m03:26:32.160918 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:32.161914 [debug] [MainThread]: On master: COMMIT
[0m03:26:32.162914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:32.163915 [debug] [MainThread]: On master: Close
[0m03:26:32.164913 [info ] [MainThread]: 
[0m03:26:32.165912 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m03:26:32.167912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:32.167912 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:26:32.168911 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:26:32.169910 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:26:32.185901 [info ] [MainThread]: 
[0m03:26:32.186902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:26:32.187901 [info ] [MainThread]: 
[0m03:26:32.188902 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:26:32.190899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18061960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18061C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE18062DA0>]}


============================== 2022-11-23 03:29:28.358453 | 910697e2-e66b-4e3e-a7b8-1182151a38e1 ==============================
[0m03:29:28.358453 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:29:28.359454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:29:28.359454 [debug] [MainThread]: Tracking: tracking
[0m03:29:28.377463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA207B0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA207B0A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA207B0790>]}
[0m03:29:28.475598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:29:28.476598 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:29:28.489590 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:29:28.513047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:29:28.524061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2094DA20>]}
[0m03:29:28.537054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA208DBA90>]}
[0m03:29:28.538035 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:29:28.539474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2076D840>]}
[0m03:29:28.542477 [info ] [MainThread]: 
[0m03:29:28.543663 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:29:28.548664 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:29:28.567670 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:29:28.567670 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:29:28.568669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:28.617626 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:29:28.619643 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:29:28.620624 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:29:28.624620 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:29:28.625619 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:29:28.625619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:28.786867 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.16 seconds
[0m03:29:28.790891 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:29:28.792864 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:29:28.798861 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:29:28.799860 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:29:28.800886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:28.848737 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:29:28.851753 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:29:28.854736 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:29:28.865731 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:29:28.865731 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:29:28.866730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:28.904346 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:29:28.905359 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:29:28.905359 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:29:28.913338 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:29:28.915337 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:29:28.915337 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:29:28.916352 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:29:28.919349 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:29:28.920335 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:29:28.920335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:28.960311 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:29:28.961322 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:29:28.961322 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:29:28.968309 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:29:28.970306 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:29:28.971304 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:29:28.972305 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:29:28.976304 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:29:28.977301 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:29:28.978301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:29:29.018281 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:29:29.019295 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:29:29.019295 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:29:29.027275 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:29:29.029272 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:29:29.030272 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:29:29.037267 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:29.038267 [debug] [MainThread]: On master: BEGIN
[0m03:29:29.039266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:29:29.077247 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:29:29.078264 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:29.079247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:29:29.114243 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:29:29.116243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20906B00>]}
[0m03:29:29.116243 [debug] [MainThread]: On master: ROLLBACK
[0m03:29:29.117222 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:29.118221 [debug] [MainThread]: On master: BEGIN
[0m03:29:29.118221 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:29.119221 [debug] [MainThread]: On master: COMMIT
[0m03:29:29.119221 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:29.120220 [debug] [MainThread]: On master: COMMIT
[0m03:29:29.121219 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:29.121219 [debug] [MainThread]: On master: Close
[0m03:29:29.122221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:29.123220 [info ] [MainThread]: 
[0m03:29:29.134234 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:29:29.134234 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:29:29.136211 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.136211 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:29:29.137210 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:29:29.144214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.145205 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.146212 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:29:29.218163 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.220163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.220163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:29:29.221161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:29:29.370076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:29:29.371088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.372078 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:29:29.396061 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:29:29.404060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.405056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:29:29.406057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.411053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.412053 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:29:29.413052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.458028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:29:29.459028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.459028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:29:29.461074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:29.467073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:29:29.468074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:29:29.471913 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:29.473913 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.473913 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:29:29.474912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20B4B790>]}
[0m03:29:29.475912 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.34s]
[0m03:29:29.476910 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:29:29.477911 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:29:29.478909 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:29:29.479910 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.480909 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:29:29.480909 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:29:29.487905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.488898 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.488898 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:29:29.494913 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.495897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.496897 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:29:29.497897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:29.542875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:29:29.542875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.543870 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:29:29.556863 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:29:29.560860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.560860 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:29:29.561859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.565858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.566859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:29:29.567859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.570855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:29:29.570855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.571855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:29:29.573381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:29.575384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:29:29.576382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:29:29.581380 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:29.583379 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.583379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:29:29.584379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AC17B0>]}
[0m03:29:29.585378 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.10s]
[0m03:29:29.587376 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:29:29.588377 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:29:29.588377 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:29:29.590376 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.590376 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:29:29.591376 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:29:29.597371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:29:29.599370 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.600370 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:29:29.606366 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:29:29.607365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.607365 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:29:29.608364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:29.656340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:29.657337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.658337 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:29:29.677023 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:29:29.681022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.681022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:29:29.682021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.688017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.689016 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:29:29.689016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.693014 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:29:29.693014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.694014 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:29:29.695889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:29.698890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:29:29.699888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:29:29.705886 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:29.707884 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.707884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:29:29.708883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20991180>]}
[0m03:29:29.709883 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:29:29.711883 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:29:29.712882 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:29:29.712882 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:29:29.714881 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.715880 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:29:29.716879 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:29:29.724874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.725873 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:29.725873 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:29:29.733876 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.735870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.736870 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:29:29.736870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:29.785839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:29.786839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.786839 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:29:29.969735 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.18 seconds
[0m03:29:29.974733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.974733 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:29:29.976731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.982727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.983727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:29:29.984726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:29.989723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:29:29.989723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.990722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:29:29.993721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:29.998718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:29:29.999717 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:29:30.007712 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:30.010711 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.010711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:29:30.012710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20990E80>]}
[0m03:29:30.013709 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.30s]
[0m03:29:30.016708 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:29:30.017708 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:29:30.018706 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:29:30.020705 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.021705 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:29:30.022706 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:29:30.031699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.033699 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.035697 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:29:30.044692 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.047690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.048691 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:29:30.049689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.099660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.099660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.100659 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:29:30.109589 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:29:30.113586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.114585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:29:30.115586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.120582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.120582 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:29:30.121582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.125579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:29:30.125579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.126579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:29:30.128032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.131033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:29:30.131033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:29:30.136864 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:30.138868 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.138868 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:29:30.139867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA209AB790>]}
[0m03:29:30.140851 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:29:30.142851 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:29:30.143849 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:29:30.143849 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:29:30.145852 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.146848 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:29:30.147847 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:29:30.151860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.152860 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.152860 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:29:30.161839 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.162838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.163837 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:29:30.163837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.213811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.213811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.214809 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:29:30.232799 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:29:30.239795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.239795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:29:30.241793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.247790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.248789 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:29:30.249790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.255785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:29:30.255785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.256785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:29:30.259782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.262781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:29:30.263780 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:29:30.269777 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:30.271777 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.272776 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:29:30.273776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AC1480>]}
[0m03:29:30.274774 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.13s]
[0m03:29:30.276774 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:29:30.277772 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:29:30.278772 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:29:30.281771 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.281771 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:29:30.282770 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:29:30.288768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.290765 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.291764 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:29:30.299761 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.301759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.301759 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:29:30.302758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.352730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.353730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.353730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:29:30.366711 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:29:30.370709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.370709 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:29:30.371708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.375705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.375705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:29:30.376706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.382702 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:29:30.383701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.384700 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:29:30.386691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.388692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:29:30.389692 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:29:30.395305 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:30.398303 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.398303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:29:30.399303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA209EF190>]}
[0m03:29:30.400303 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.12s]
[0m03:29:30.402302 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:29:30.402302 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:29:30.403301 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:29:30.405300 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.405300 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:29:30.406300 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:29:30.412296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.414295 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.415294 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:29:30.425290 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.426287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.427289 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:29:30.427289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.474260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.475261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.476259 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:29:30.492249 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:29:30.498247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.499246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:29:30.500245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.505244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.506242 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:29:30.507242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.513239 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:29:30.514238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.514238 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:29:30.518235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.522234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:29:30.522234 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:29:30.530229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:30.533226 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.534226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:29:30.536226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA209E2AD0>]}
[0m03:29:30.537225 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.13s]
[0m03:29:30.539224 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:29:30.540223 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:29:30.541223 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:29:30.543222 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.544221 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:29:30.544221 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:29:30.553218 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.554215 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.555214 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:29:30.568207 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.570205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.570205 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:29:30.571205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.624174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.624174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.625174 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:29:30.639166 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:29:30.645162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.646163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:29:30.647161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.651159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.651159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:29:30.652158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.656157 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:29:30.656157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.657156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:29:30.659157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.664153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:29:30.665153 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:29:30.674146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:30.677145 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.678144 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:29:30.679144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA209BCEB0>]}
[0m03:29:30.681144 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.14s]
[0m03:29:30.683141 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:29:30.684141 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:29:30.685141 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:29:30.687140 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.688139 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:29:30.689140 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:29:30.698133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.699132 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.700131 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:29:30.709126 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.711125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.712125 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:29:30.713123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.870034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m03:29:30.871034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.872033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:29:30.885025 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:29:30.889024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.889024 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:29:30.890023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.894020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.894020 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:29:30.896019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:30.900017 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:29:30.901016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.902016 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:29:30.903017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.906013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:29:30.907012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:29:30.913010 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:30.915010 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.916009 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:29:30.917008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AC1510>]}
[0m03:29:30.918007 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.23s]
[0m03:29:30.920006 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:29:30.920006 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:29:30.921006 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:29:30.923004 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:30.924004 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:29:30.925004 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:29:30.933998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:29:30.935996 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:30.936996 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:29:30.942993 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:29:30.944992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:30.944992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:29:30.946990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:30.993964 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:30.994962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:30.994962 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:29:31.007932 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:29:31.011929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:31.011929 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:29:31.012929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.016926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:31.016926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:29:31.017926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.021925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:29:31.021925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:31.022923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:29:31.024648 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.029648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:29:31.029648 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:29:31.035815 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:31.037804 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.037804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:29:31.038819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20A2CD00>]}
[0m03:29:31.039802 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:29:31.041801 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:29:31.041801 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:29:31.042802 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:29:31.044800 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:29:31.044800 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:29:31.045800 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:29:31.104765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:29:31.105764 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.106766 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:29:31.111776 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:29:31.113770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:29:31.114762 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:29:31.114762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:31.152749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:29:31.153738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:29:31.153738 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre_1
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:29:31.155736 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna spg2.genre_1
LINE 25: ...       sps.id_song = spg2.id_song and gen.genre = spg2.genre...
                                                              ^
HINT:  Probablemente quiera hacer referencia a la columna «spg2.genre».

[0m03:29:31.156735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: ROLLBACK
[0m03:29:31.157735 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.157735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:29:31.158735 [debug] [Thread-1 (]: Database Error in model fact_publication (models\datawarehouse\fact_publication.sql)
  no existe la columna spg2.genre_1
  LINE 25: ...       sps.id_song = spg2.id_song and gen.genre = spg2.genre...
                                                                ^
  HINT:  Probablemente quiera hacer referencia a la columna «spg2.genre».
  compiled SQL at target\run\dbt_summersong_etl\models\datawarehouse\fact_publication.sql
[0m03:29:31.159735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2070BBB0>]}
[0m03:29:31.159735 [error] [Thread-1 (]: 12 of 14 ERROR creating table model SummerSong_datawarehouse.fact_publication .. [[31mERROR[0m in 0.11s]
[0m03:29:31.161732 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:29:31.162732 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:29:31.163734 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:29:31.165732 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.166730 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:29:31.167735 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:29:31.172741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.173742 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.173742 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:29:31.180722 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.181722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.182722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:29:31.182722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:31.227694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:29:31.228706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.229696 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:29:31.799080 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.57 seconds
[0m03:29:31.803057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.803057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:29:31.804058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.807054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.807054 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:29:31.808053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.811072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:29:31.812051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.812051 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:29:31.814568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.816586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:29:31.817590 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:29:31.823972 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:31.825995 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.825995 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:29:31.826994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2070BF10>]}
[0m03:29:31.827973 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.66s]
[0m03:29:31.829972 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:29:31.830972 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:29:31.831971 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:29:31.833973 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.833973 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:29:31.834970 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:29:31.839986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.841641 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.841641 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:29:31.850641 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.851656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.851656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:29:31.852637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:29:31.897783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:29:31.898764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.898764 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg, "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 
    where (not spsg.genre = spg1.genre_1) and spsg.id_song=spg1.id_song

)

select * from stg_genre_2
  );
[0m03:29:31.916090 [debug] [Thread-1 (]: SQL status: SELECT 1699 in 0.02 seconds
[0m03:29:31.921100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.921100 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:29:31.922087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.925099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.926083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:29:31.926083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.930096 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:29:31.930096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.931080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:29:31.932634 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.934651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:29:31.935650 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:29:31.942030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:29:31.944043 [debug] [Thread-1 (]: finished collecting timing info
[0m03:29:31.944043 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:29:31.945030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '910697e2-e66b-4e3e-a7b8-1182151a38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AF0D00>]}
[0m03:29:31.946031 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1699[0m in 0.11s]
[0m03:29:31.947421 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:29:31.949438 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:29:31.950422 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:31.950422 [debug] [MainThread]: On master: BEGIN
[0m03:29:31.951421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:29:32.003394 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:29:32.004392 [debug] [MainThread]: On master: COMMIT
[0m03:29:32.005392 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:32.005392 [debug] [MainThread]: On master: COMMIT
[0m03:29:32.006390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:32.007390 [debug] [MainThread]: On master: Close
[0m03:29:32.008390 [info ] [MainThread]: 
[0m03:29:32.009389 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m03:29:32.011388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:32.011388 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:29:32.012387 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:29:32.013390 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:29:32.033376 [info ] [MainThread]: 
[0m03:29:32.037373 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:29:32.039372 [info ] [MainThread]: 
[0m03:29:32.040371 [error] [MainThread]: [33mDatabase Error in model fact_publication (models\datawarehouse\fact_publication.sql)[0m
[0m03:29:32.042370 [error] [MainThread]:   no existe la columna spg2.genre_1
[0m03:29:32.043370 [error] [MainThread]:   LINE 25: ...       sps.id_song = spg2.id_song and gen.genre = spg2.genre...
[0m03:29:32.044369 [error] [MainThread]:                                                                 ^
[0m03:29:32.048367 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «spg2.genre».
[0m03:29:32.049367 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\datawarehouse\fact_publication.sql
[0m03:29:32.054372 [info ] [MainThread]: 
[0m03:29:32.056362 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m03:29:32.057362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AF3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20AF0CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA20990910>]}


============================== 2022-11-23 03:30:30.199813 | d12e0839-ea89-427d-9566-d586682ecdd7 ==============================
[0m03:30:30.199813 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:30:30.200954 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:30:30.200954 [debug] [MainThread]: Tracking: tracking
[0m03:30:30.218946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB490520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB490A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB4907F0>]}
[0m03:30:30.309890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:30:30.310890 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\datawarehouse\fact_publication.sql
[0m03:30:30.326880 [debug] [MainThread]: 1699: static parser successfully parsed datawarehouse\fact_publication.sql
[0m03:30:30.348867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:30:30.360250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB62DA80>]}
[0m03:30:30.376221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB5BBAF0>]}
[0m03:30:30.376221 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:30:30.378193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB45A770>]}
[0m03:30:30.383193 [info ] [MainThread]: 
[0m03:30:30.385404 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:30:30.388188 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:30:30.404202 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:30:30.404202 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:30:30.405183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:30.467269 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:30:30.470269 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:30:30.471269 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:30:30.476264 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:30:30.476264 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:30:30.477263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:30.518240 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:30:30.521238 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:30:30.522238 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:30:30.525235 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:30:30.525235 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:30:30.526235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:30.565213 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:30:30.567212 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:30:30.570210 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:30:30.578206 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:30:30.579206 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:30:30.579206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:30.618183 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:30:30.618183 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:30:30.619182 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:30:30.625179 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:30:30.627177 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:30:30.628176 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:30:30.629176 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:30:30.632174 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:30:30.632174 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:30:30.633174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:30.671152 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:30:30.671152 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:30:30.672153 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:30:30.682146 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:30:30.685144 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:30:30.685144 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:30:30.687143 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:30:30.690142 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:30:30.691140 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:30:30.691140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:30:30.735116 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:30:30.736116 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:30:30.736116 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:30:30.743111 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:30:30.745111 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:30:30.746110 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:30:30.753120 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:30.754104 [debug] [MainThread]: On master: BEGIN
[0m03:30:30.754104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:30:30.793085 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:30:30.794081 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:30.794081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:30:30.830068 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:30:30.832080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB5E5420>]}
[0m03:30:30.832080 [debug] [MainThread]: On master: ROLLBACK
[0m03:30:30.833062 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:30.833062 [debug] [MainThread]: On master: BEGIN
[0m03:30:30.834061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:30:30.835058 [debug] [MainThread]: On master: COMMIT
[0m03:30:30.835058 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:30.836058 [debug] [MainThread]: On master: COMMIT
[0m03:30:30.836058 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:30:30.837059 [debug] [MainThread]: On master: Close
[0m03:30:30.837059 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:30:30.839056 [info ] [MainThread]: 
[0m03:30:30.849051 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:30:30.850051 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:30:30.852050 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.853050 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:30:30.853050 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:30:30.857046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.858045 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:30.859045 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:30:30.921024 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.923008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.923008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:30:30.924019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:30:30.964987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:30.965983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.965983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:30:30.981977 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:30:30.991969 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:30.992968 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:30:30.993967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.000964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:31.000964 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:30:31.002965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.047937 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:30:31.047937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:31.048936 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:30:31.049935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.057932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:30:31.058930 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:30:31.062929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:31.064929 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.065929 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:30:31.066928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB7D0BE0>]}
[0m03:30:31.067925 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.21s]
[0m03:30:31.069924 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:30:31.071923 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:30:31.072923 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:30:31.074922 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.075921 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:30:31.076921 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:30:31.084915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.086915 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.086915 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:30:31.094909 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.097909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.097909 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:30:31.098908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.149878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:30:31.150878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.150878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:30:31.162871 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:30:31.166869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.167868 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:30:31.168868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.171865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.172865 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:30:31.173865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.177863 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:30:31.178861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.179861 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:30:31.180861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.183860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:30:31.183860 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:30:31.188856 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:31.190856 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.190856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:30:31.191855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB7A17B0>]}
[0m03:30:31.193855 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:30:31.196852 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:30:31.197851 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:30:31.198850 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:30:31.200850 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.200850 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:30:31.201849 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:30:31.207845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:30:31.209844 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.210844 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:30:31.216840 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:30:31.217840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.218839 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:30:31.218839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.267812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:30:31.268811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.268811 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:30:31.290797 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:30:31.293797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.294796 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:30:31.295797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.300792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.300792 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:30:31.301792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.304791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:30:31.305789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.305789 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:30:31.308894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.311896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:30:31.311896 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:30:31.317717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:31.319714 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.320714 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:30:31.320714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB66D000>]}
[0m03:30:31.321713 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:30:31.323712 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:30:31.324712 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:30:31.324712 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:30:31.326711 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.326711 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:30:31.327710 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:30:31.337704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.339703 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.339703 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:30:31.345699 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.347699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.348701 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:30:31.348701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.392672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:31.393673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.393673 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:30:31.506748 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.11 seconds
[0m03:30:31.513745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.514745 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:30:31.516743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.523739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.523739 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:30:31.525738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.530737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:30:31.530737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.531737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:30:31.534747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.538732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:30:31.538732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:30:31.548727 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:31.550725 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.550725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:30:31.552725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB45A770>]}
[0m03:30:31.552725 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.23s]
[0m03:30:31.554721 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:30:31.555720 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:30:31.556720 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:30:31.558724 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.559719 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:30:31.559719 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:30:31.568713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.569712 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.570712 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:30:31.581705 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.583721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.584710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:30:31.584710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.637673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:30:31.638673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.638673 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:30:31.649667 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:31.653664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.654663 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:30:31.655663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.660660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.661659 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:30:31.661659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.667655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:30:31.667655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.668655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:30:31.670654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.674652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:30:31.674652 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:30:31.680123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:31.683123 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.683123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:30:31.684121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB68B790>]}
[0m03:30:31.685120 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.13s]
[0m03:30:31.687119 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:30:31.688118 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:30:31.688118 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:30:31.691118 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.692117 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:30:31.693116 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:30:31.700112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.702111 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.703111 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:30:31.708107 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.710106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.710106 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:30:31.711106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.756079 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:31.756079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.757078 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:30:31.771863 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.01 seconds
[0m03:30:31.775859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.775859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:30:31.776859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.780856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.780856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:30:31.781855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.785856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:30:31.785856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.786855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:30:31.788852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.791853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:30:31.792852 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:30:31.799788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:31.801786 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.801786 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:30:31.802785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB7A1480>]}
[0m03:30:31.803785 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.11s]
[0m03:30:31.805784 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:30:31.806784 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:30:31.807782 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:30:31.808783 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.809782 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:30:31.810781 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:30:31.817778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.819775 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.819775 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:30:31.826771 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.827773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.827773 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:30:31.828770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.872746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:31.873744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.873744 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:30:31.886544 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:31.890540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.890540 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:30:31.891540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.894538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.895537 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:30:31.896537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:31.902534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:30:31.903534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.903534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:30:31.906092 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:31.908093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:30:31.909092 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:30:31.915058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:31.916058 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.917057 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:30:31.918056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB6CF5B0>]}
[0m03:30:31.918056 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:30:31.920055 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:30:31.921054 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:30:31.922055 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:30:31.924053 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:31.925053 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:30:31.925053 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:30:31.934049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:31.936046 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:31.937045 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:30:31.943041 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:31.944041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:31.945041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:30:31.945041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:31.989015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:31.990016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:31.991015 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:30:32.001352 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:32.005348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:32.006348 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:30:32.006348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.010347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:32.010347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:30:32.011345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.016343 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:30:32.016343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:32.017341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:30:32.019197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:32.022198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:30:32.022198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:30:32.028195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:32.031193 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.031193 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:30:32.032192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB6AFD90>]}
[0m03:30:32.033191 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:30:32.035191 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:30:32.035191 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:30:32.036190 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:30:32.037189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.038189 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:30:32.039189 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:30:32.045184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.047188 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.048184 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:30:32.056178 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.058178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.059176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:30:32.059176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:32.104154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:32.105150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.105150 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:30:32.115628 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:32.119625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.120624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:30:32.120624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.124624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.124624 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:30:32.125623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.129620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:30:32.130620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.130620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:30:32.132794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:32.136795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:30:32.137795 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:30:32.142795 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:32.144793 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.145792 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:30:32.146792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB69CEB0>]}
[0m03:30:32.147792 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:30:32.148790 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:30:32.149790 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:30:32.150791 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:30:32.151792 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.152789 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:30:32.153788 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:30:32.159786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.160785 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.160785 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:30:32.172778 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.173777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.174775 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:30:32.174775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:32.219752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:32.219752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.220749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:30:32.231618 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:32.235617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.236617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:30:32.237615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.241617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.241617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:30:32.242614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.247610 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:30:32.247610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.248609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:30:32.249759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:32.251761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:30:32.252760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:30:32.257386 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:32.259386 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.260386 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:30:32.261383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB81CEE0>]}
[0m03:30:32.262383 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.11s]
[0m03:30:32.264383 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:30:32.265382 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:30:32.266380 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:30:32.267381 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.268381 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:30:32.268381 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:30:32.274377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.275376 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.276375 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:30:32.285370 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.286371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.286371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:30:32.287369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:32.339338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:30:32.340338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.340338 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:30:32.355331 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:30:32.360327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.361326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:30:32.362327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.367323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.368322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:30:32.369321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.375318 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:30:32.375318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.376320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:30:32.378317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:32.384313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:30:32.385312 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:30:32.391310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:32.393309 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.394308 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:30:32.395307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB70CD00>]}
[0m03:30:32.396307 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:30:32.398305 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:30:32.399305 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:30:32.399305 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:30:32.401304 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.402304 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:30:32.403303 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:30:32.478260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.486255 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.487255 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:30:32.497250 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.499248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.500247 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:30:32.500247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:32.587197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.09 seconds
[0m03:30:32.588197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.589196 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:30:32.676146 [debug] [Thread-1 (]: SQL status: SELECT 2421 in 0.09 seconds
[0m03:30:32.682143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.683142 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:30:32.684142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.691138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.691138 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:30:32.693137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:32.699133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:30:32.700132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.700132 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:30:32.704130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:32.709129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:30:32.710127 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:30:32.719122 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:32.722120 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.723120 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:30:32.724119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB702830>]}
[0m03:30:32.725119 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2421[0m in 0.32s]
[0m03:30:32.728117 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:30:32.728117 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:30:32.729116 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:30:32.732115 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:32.732115 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:30:32.733115 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:30:32.742109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:32.743109 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:32.744107 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:30:32.773091 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:32.775090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:32.775090 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:30:32.776090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:32.864041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.09 seconds
[0m03:30:32.865039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:32.866038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:30:33.431716 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.57 seconds
[0m03:30:33.434713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:33.434713 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:30:33.435714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:33.438710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:33.439711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:30:33.440709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:33.443707 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:30:33.443707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:33.444725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:30:33.447039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:33.449057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:30:33.450056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:30:33.455861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:33.457883 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:33.457883 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:30:33.458861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB3EBA90>]}
[0m03:30:33.459861 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.73s]
[0m03:30:33.461028 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:30:33.463030 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:30:33.463030 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:30:33.465032 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.466029 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:30:33.466029 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:30:33.473046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.475023 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:33.476025 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:30:33.485018 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.486352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.486352 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:30:33.487354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:30:33.528955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:30:33.529955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.529955 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg, "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 
    where (not spsg.genre = spg1.genre_1) and spsg.id_song=spg1.id_song

)

select * from stg_genre_2
  );
[0m03:30:33.545761 [debug] [Thread-1 (]: SQL status: SELECT 1699 in 0.01 seconds
[0m03:30:33.549774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.549774 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:30:33.550761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:33.553772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.554758 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:30:33.555756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:33.559755 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:30:33.560755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.560755 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:30:33.562761 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:30:33.565765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:30:33.565765 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:30:33.572108 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:30:33.573117 [debug] [Thread-1 (]: finished collecting timing info
[0m03:30:33.574105 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:30:33.575107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12e0839-ea89-427d-9566-d586682ecdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB8423B0>]}
[0m03:30:33.575107 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 1699[0m in 0.11s]
[0m03:30:33.577156 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:30:33.579158 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:30:33.580160 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:33.580160 [debug] [MainThread]: On master: BEGIN
[0m03:30:33.581158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:30:33.625951 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:30:33.625951 [debug] [MainThread]: On master: COMMIT
[0m03:30:33.626950 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:33.627952 [debug] [MainThread]: On master: COMMIT
[0m03:30:33.627952 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:30:33.628949 [debug] [MainThread]: On master: Close
[0m03:30:33.629949 [info ] [MainThread]: 
[0m03:30:33.631948 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m03:30:33.633947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:30:33.634946 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:30:33.635945 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:30:33.635945 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:30:33.648937 [info ] [MainThread]: 
[0m03:30:33.649937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:30:33.651937 [info ] [MainThread]: 
[0m03:30:33.653939 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:30:33.655935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB842470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB843010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7AB6CC430>]}


============================== 2022-11-23 03:42:12.516640 | ccd43462-7f03-488b-9e04-75dcf9709579 ==============================
[0m03:42:12.516640 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:42:12.518066 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:42:12.518066 [debug] [MainThread]: Tracking: tracking
[0m03:42:12.537060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2FB0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2FB09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2FB07F0>]}
[0m03:42:12.629020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:42:12.630006 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:42:12.646996 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:42:12.688971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:42:12.720954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31519F0>]}
[0m03:42:12.753934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C30DBA60>]}
[0m03:42:12.754934 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:42:12.775922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2F7A770>]}
[0m03:42:12.780918 [info ] [MainThread]: 
[0m03:42:12.783918 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:42:12.804905 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:12.832889 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:12.833889 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:12.833889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:12.910845 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.08 seconds
[0m03:42:12.913842 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:12.915842 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:12.920839 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:12.920839 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:12.921838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:12.966813 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:42:12.968812 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:12.970811 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:12.973810 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:12.974807 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:12.974807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:13.025778 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:42:13.029776 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:13.033774 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:13.044769 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:13.044769 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:42:13.045768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:13.092740 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:42:13.092740 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:13.093740 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:42:13.100738 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:42:13.103734 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:42:13.103734 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:42:13.105733 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:13.107731 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:13.108731 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:42:13.108731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:13.151711 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:42:13.152707 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:13.152707 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:42:13.159704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:42:13.161701 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:42:13.162700 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:42:13.163701 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:13.168697 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:13.169697 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:42:13.169697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:13.210678 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:42:13.210678 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:13.211672 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:42:13.218670 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:42:13.220668 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:42:13.221669 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:42:13.231662 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:13.232661 [debug] [MainThread]: On master: BEGIN
[0m03:42:13.232661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:42:13.275635 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:42:13.275635 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:13.276635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:42:13.319611 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:42:13.322609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31048B0>]}
[0m03:42:13.323608 [debug] [MainThread]: On master: ROLLBACK
[0m03:42:13.323608 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:13.324610 [debug] [MainThread]: On master: BEGIN
[0m03:42:13.325608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:42:13.325608 [debug] [MainThread]: On master: COMMIT
[0m03:42:13.326606 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:13.326606 [debug] [MainThread]: On master: COMMIT
[0m03:42:13.327606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:42:13.327606 [debug] [MainThread]: On master: Close
[0m03:42:13.328607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:13.330606 [info ] [MainThread]: 
[0m03:42:13.340598 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:42:13.341599 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:42:13.343599 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.344597 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:42:13.344597 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:42:13.351593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.353595 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.354592 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:42:13.414556 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.416556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.416556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:42:13.417555 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:42:13.462529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:13.463528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.463528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:42:13.479520 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:42:13.489515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.489515 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:42:13.490514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.496510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.497510 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:42:13.498509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.534490 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:42:13.535490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.535490 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:42:13.537489 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:13.543498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:13.544496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:42:13.548499 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:13.550500 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.551499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:42:13.552496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31F7460>]}
[0m03:42:13.553497 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.21s]
[0m03:42:13.555494 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:42:13.556494 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:42:13.557494 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:42:13.558493 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.559492 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:42:13.560492 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:42:13.567488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.569487 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.570488 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:42:13.576483 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.577483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.577483 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:42:13.578481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:13.624047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:13.624047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.625047 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:42:13.636308 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:42:13.640321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.641307 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:42:13.642322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.645303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.645303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:42:13.646305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.650303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:42:13.651300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.651300 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:42:13.653290 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:13.655291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:13.656291 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:42:13.660275 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:13.662274 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.662274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:42:13.663273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B57B0>]}
[0m03:42:13.664273 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.10s]
[0m03:42:13.666271 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:42:13.667273 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:42:13.667273 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:42:13.669274 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.669274 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:42:13.670269 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:42:13.680281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:42:13.683271 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.684262 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:42:13.697254 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:42:13.701253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.702252 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:42:13.703251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:13.759222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:42:13.759222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.760218 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:42:13.778348 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:42:13.782347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.783346 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:42:13.783346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.788342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.789342 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:42:13.790342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.793341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:42:13.793341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.794339 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:42:13.796161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:13.799161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:13.799161 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:42:13.804622 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:13.806621 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.807620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:42:13.808619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3291180>]}
[0m03:42:13.809620 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.14s]
[0m03:42:13.810618 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:42:13.811618 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:42:13.812617 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:42:13.813618 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.814617 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:42:13.814617 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:42:13.823611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.824610 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:13.824610 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:42:13.831606 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.835604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.835604 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:42:13.836606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:13.883583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:13.884576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.885577 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:42:13.989393 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:42:13.993390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.994388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:42:13.995403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:13.998386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:13.998386 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:42:13.999385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.002384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:42:14.003382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:14.003382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:42:14.006510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.009525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:14.009525 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:42:14.015266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.017266 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.018264 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:42:14.019264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C2FB1D20>]}
[0m03:42:14.020264 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.21s]
[0m03:42:14.022264 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:42:14.023262 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:14.024262 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:42:14.026261 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.027260 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:14.027260 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:14.038254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.040253 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.041253 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:14.047248 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.048248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.049248 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:42:14.050255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.093223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:14.094221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.094221 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:42:14.109213 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.114210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.115210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:42:14.116209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.122206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.122206 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:42:14.123206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.127202 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:42:14.128201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.128201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:42:14.130204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.135198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:14.136198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:42:14.142194 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:42:14.144193 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.145192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:42:14.146191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C32B45B0>]}
[0m03:42:14.148190 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:42:14.150190 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:14.151189 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:14.152189 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:42:14.154189 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.155187 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:14.156186 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:14.164184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.166180 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.167180 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:14.176175 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.177175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.178173 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:42:14.178173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.227145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:14.227145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.228145 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:42:14.246136 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:42:14.251131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.251131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:42:14.252132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.256130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.256130 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:42:14.257130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.261127 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:42:14.262125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.262125 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:42:14.265125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.268121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:14.268121 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:42:14.274119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.277117 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.278116 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:42:14.279116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B5480>]}
[0m03:42:14.280115 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.12s]
[0m03:42:14.282117 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:14.283114 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:14.283114 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:42:14.285113 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.286113 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:14.287112 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:14.293108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.294108 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.295107 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:14.310098 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.312097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.313097 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:42:14.314096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.364068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:14.364068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.365066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:42:14.379060 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.384056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.384056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:42:14.385055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.390052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.391052 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:42:14.392051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.400047 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:42:14.401046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.401046 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:42:14.403047 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.406043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:14.407052 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:42:14.412040 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.415037 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.416037 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:42:14.417037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C32EF460>]}
[0m03:42:14.418036 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.13s]
[0m03:42:14.420036 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:14.420036 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:42:14.421043 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:42:14.423034 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.423034 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:42:14.424033 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:42:14.433030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.436027 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.437026 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:42:14.445022 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.447021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.448019 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:42:14.448019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.497991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:14.498991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.499989 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:42:14.509203 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.513200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.514199 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:42:14.514199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.519198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.519198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:42:14.520196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.524193 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:42:14.525192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.525192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:42:14.528192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.531190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:14.531190 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:42:14.536604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.538602 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.539602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:42:14.539602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B52A0>]}
[0m03:42:14.540601 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:42:14.542599 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:42:14.543599 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:14.543599 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:42:14.545600 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.545600 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:14.546598 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:42:14.554594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.556592 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.556592 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:14.562588 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.563588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.564587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:42:14.565589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.610561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:14.611560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.611560 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:42:14.624327 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.628324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.628324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:42:14.629326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.633322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.634321 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:42:14.635321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.638318 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:42:14.638318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.639319 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:42:14.640888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.644889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:14.645888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:42:14.650936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:42:14.652936 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.653934 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:42:14.654935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B51B0>]}
[0m03:42:14.655934 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:42:14.657932 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:14.658933 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:42:14.659931 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:42:14.660931 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.661931 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:42:14.662930 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:42:14.678921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.680920 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.681920 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:42:14.705907 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.709904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.710903 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:42:14.711902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.781862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:42:14.782862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.783861 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:42:14.796115 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.800113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.800113 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:42:14.801113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.805111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.805111 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:42:14.806110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.810108 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:42:14.810108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.811107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:42:14.812819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.815820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:14.815820 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:42:14.821008 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.823006 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.824005 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:42:14.825005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B50C0>]}
[0m03:42:14.826005 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.16s]
[0m03:42:14.827004 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:42:14.828004 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:42:14.829003 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:42:14.830003 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.831003 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:42:14.831003 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:42:14.838999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.839997 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.840997 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:42:14.845993 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.846993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.849999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:42:14.850990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:14.899969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:14.900963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.901963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:42:14.911956 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:14.916953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.917952 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:42:14.918952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.921951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.922949 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:42:14.923949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:14.926948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:42:14.927948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.928946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:42:14.930592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:14.935591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:14.936590 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:42:14.942588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:14.944586 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:14.944586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:42:14.945585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C31B5420>]}
[0m03:42:14.946584 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:42:14.947585 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:42:14.948585 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:42:14.949583 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:42:14.951582 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:14.951582 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:42:14.952582 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:42:15.011547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.013546 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.013546 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:42:15.019543 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.020542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.021542 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:42:15.021542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:15.060935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:15.060935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.061933 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:42:15.101253 [debug] [Thread-1 (]: SQL status: SELECT 2421 in 0.04 seconds
[0m03:42:15.105236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.105236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:42:15.106247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:15.109249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.109249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:42:15.110236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:15.114232 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:42:15.114232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.115246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:42:15.116782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:15.118799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:15.119798 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:42:15.124674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:15.126671 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.127670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:42:15.128669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C3325C90>]}
[0m03:42:15.129669 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2421[0m in 0.18s]
[0m03:42:15.131668 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:42:15.132668 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:42:15.132668 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:42:15.134666 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.135666 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:42:15.136666 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:42:15.142678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.143677 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.144661 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:42:15.152658 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.154655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.154655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:42:15.155657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:15.196630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:15.197632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.198629 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:42:15.832830 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.63 seconds
[0m03:42:15.836828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.837828 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:42:15.838828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:15.841824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.842824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:42:15.843825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:15.846822 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:42:15.847821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.847821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:42:15.850821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:15.854818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:15.855826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:42:15.861630 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:42:15.863652 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.863652 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:42:15.865630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C32CCFD0>]}
[0m03:42:15.866633 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.73s]
[0m03:42:15.868628 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:42:15.869628 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:42:15.870627 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:42:15.872627 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:15.873626 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:42:15.873626 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:42:15.882621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:15.884622 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.885620 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:42:15.892635 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:15.894228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:15.894228 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:42:15.895230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:15.940205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:15.940205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:15.941204 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_id_genre_2 as (
    select distinct
    spsg.id_song
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg, "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 
    where (not spsg.genre = spg1.genre_1) and spsg.id_song=spg1.id_song

),

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    right join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:42:15.941204 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «with»
LINE 16: with stg_genre_2 as (
         ^

[0m03:42:15.942219 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: ROLLBACK
[0m03:42:15.943212 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:15.943212 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:42:15.944205 [debug] [Thread-1 (]: Database Error in model stg_genre_2 (models\staging\genre\stg_genre_2.sql)
  error de sintaxis en o cerca de «with»
  LINE 16: with stg_genre_2 as (
           ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_2.sql
[0m03:42:15.945204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd43462-7f03-488b-9e04-75dcf9709579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C324E140>]}
[0m03:42:15.946203 [error] [Thread-1 (]: 14 of 14 ERROR creating table model SummerSong_staging.stg_genre_2 ............. [[31mERROR[0m in 0.07s]
[0m03:42:15.947202 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:42:15.950203 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:42:15.950203 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:15.951201 [debug] [MainThread]: On master: BEGIN
[0m03:42:15.952214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:42:15.999171 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:42:16.000181 [debug] [MainThread]: On master: COMMIT
[0m03:42:16.001170 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:16.001170 [debug] [MainThread]: On master: COMMIT
[0m03:42:16.002169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:42:16.002169 [debug] [MainThread]: On master: Close
[0m03:42:16.003170 [info ] [MainThread]: 
[0m03:42:16.004169 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m03:42:16.006169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:16.006169 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:42:16.007169 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:42:16.007169 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:42:16.022158 [info ] [MainThread]: 
[0m03:42:16.024156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:42:16.025156 [info ] [MainThread]: 
[0m03:42:16.026158 [error] [MainThread]: [33mDatabase Error in model stg_genre_2 (models\staging\genre\stg_genre_2.sql)[0m
[0m03:42:16.028156 [error] [MainThread]:   error de sintaxis en o cerca de «with»
[0m03:42:16.029154 [error] [MainThread]:   LINE 16: with stg_genre_2 as (
[0m03:42:16.030156 [error] [MainThread]:            ^
[0m03:42:16.031154 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_2.sql
[0m03:42:16.033161 [info ] [MainThread]: 
[0m03:42:16.035152 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m03:42:16.039149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C324F400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C324E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C324C790>]}


============================== 2022-11-23 03:42:35.838596 | 2c8f7a68-2f36-46a5-b721-0817af61ad82 ==============================
[0m03:42:35.838596 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:42:35.839593 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:42:35.839593 [debug] [MainThread]: Tracking: tracking
[0m03:42:35.854605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85EDDE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85F009A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85F00790>]}
[0m03:42:35.951529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:42:35.951529 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:42:35.966522 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:42:35.987264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:42:36.000785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D860A19C0>]}
[0m03:42:36.013778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85ECA770>]}
[0m03:42:36.014777 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:42:36.016788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85EDDE10>]}
[0m03:42:36.021787 [info ] [MainThread]: 
[0m03:42:36.023770 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:42:36.026788 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:36.041780 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:36.041780 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:36.042779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:36.095731 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:42:36.098727 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:36.099728 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:36.105723 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:36.105723 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:36.106722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:36.151697 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:42:36.153695 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:36.155694 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:42:36.158694 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:42:36.158694 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:42:36.159692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:36.206666 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:42:36.209663 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:42:36.213661 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:36.225654 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:36.226653 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:42:36.226653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:42:36.274626 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:42:36.275628 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:42:36.276625 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:42:36.285620 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:42:36.288619 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:42:36.289618 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:42:36.291616 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:36.295614 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:36.296613 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:42:36.296613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:36.355582 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:42:36.355582 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:42:36.356580 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:42:36.363575 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:42:36.366575 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:42:36.367573 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:42:36.369572 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:36.373570 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:36.374569 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:42:36.374569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:42:36.421543 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:42:36.422542 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:42:36.422542 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:42:36.429539 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:42:36.431537 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:42:36.432538 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:42:36.439533 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:36.439533 [debug] [MainThread]: On master: BEGIN
[0m03:42:36.440531 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:42:36.477512 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:42:36.478514 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:36.478514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:42:36.521485 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:42:36.523484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86057850>]}
[0m03:42:36.524491 [debug] [MainThread]: On master: ROLLBACK
[0m03:42:36.524491 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:36.525484 [debug] [MainThread]: On master: BEGIN
[0m03:42:36.526483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:42:36.526483 [debug] [MainThread]: On master: COMMIT
[0m03:42:36.526483 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:36.527482 [debug] [MainThread]: On master: COMMIT
[0m03:42:36.527482 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:42:36.528481 [debug] [MainThread]: On master: Close
[0m03:42:36.529481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:42:36.531073 [info ] [MainThread]: 
[0m03:42:36.540074 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:42:36.541073 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:42:36.542075 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.543071 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:42:36.543071 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:42:36.549067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.551065 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:36.552066 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:42:36.607033 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.608033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.608033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:42:36.609032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:42:36.646863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:36.646863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.647853 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:42:36.661843 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:42:36.672840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.673838 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:42:36.674837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:36.682835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.683832 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:42:36.684831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:36.742798 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:42:36.743797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.744797 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:42:36.745796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:36.754791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:42:36.754791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:42:36.759789 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:36.761787 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:36.761787 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:42:36.762786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86147430>]}
[0m03:42:36.763786 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.22s]
[0m03:42:36.765787 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:42:36.766785 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:42:36.767785 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:42:36.769782 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.770782 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:42:36.771794 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:42:36.776778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.777777 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:36.777777 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:42:36.788774 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.789772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.790770 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:42:36.790770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:36.838743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:36.839742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.840742 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:42:36.853734 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:42:36.858732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.858732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:42:36.859731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:36.863728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.863728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:42:36.864728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:36.868725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:42:36.868725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.869725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:42:36.870943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:36.872946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:42:36.873946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:42:36.877697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:36.879696 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:36.879696 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:42:36.880694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861057B0>]}
[0m03:42:36.881693 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:42:36.883692 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:42:36.883692 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:42:36.884691 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:42:36.886690 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:36.886690 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:42:36.887690 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:42:36.893686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:42:36.895684 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:36.895684 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:42:36.904680 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:42:36.906679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:36.906679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:42:36.907678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:36.968566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:42:36.969565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:36.969565 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:42:37.005545 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:42:37.012541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:37.012541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:42:37.014540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.024534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:37.025534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:42:37.027533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.033529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:42:37.034528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:37.034528 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:42:37.037527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.043524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:42:37.044524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:42:37.051519 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:42:37.054517 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.055517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:42:37.056516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861E1180>]}
[0m03:42:37.057516 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.17s]
[0m03:42:37.060514 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:42:37.061514 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:42:37.061514 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:42:37.063513 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.064512 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:42:37.065513 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:42:37.078505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.080502 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.080502 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:42:37.091497 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.093495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.094494 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:42:37.094494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.213426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.12 seconds
[0m03:42:37.214428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.215425 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:42:37.325814 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.11 seconds
[0m03:42:37.330810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.330810 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:42:37.332809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.335808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.336808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:42:37.337808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.340804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:42:37.341804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.341804 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:42:37.344337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.347339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:42:37.347339 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:42:37.351559 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:37.353558 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.353558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:42:37.354557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85F01B40>]}
[0m03:42:37.355557 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.29s]
[0m03:42:37.357555 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:42:37.358555 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:37.358555 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:42:37.360555 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.361554 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:37.362553 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:37.370550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.371549 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.372548 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:37.379544 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.381544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.382542 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:42:37.383549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.425516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:37.426517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.426517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:42:37.440510 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:37.446505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.447504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:42:37.447504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.454502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.455499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:42:37.456500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.461496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:42:37.461496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.462496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:42:37.464494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.467493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:42:37.468493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:42:37.474490 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:37.476487 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.477487 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:42:37.478488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86204580>]}
[0m03:42:37.479486 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:42:37.482486 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:42:37.483484 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:37.484483 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:42:37.486482 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.487482 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:37.487482 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:37.492478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.493478 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.494477 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:37.505471 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.507471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.507471 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:42:37.508470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.570435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:42:37.571434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.572433 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:42:37.590423 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:42:37.595419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.595419 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:42:37.596418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.602416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.602416 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:42:37.603415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.607412 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:42:37.607412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.608412 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:42:37.610412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.613409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:42:37.614409 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:42:37.619405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:37.622404 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.622404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:42:37.623405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86105480>]}
[0m03:42:37.624403 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.14s]
[0m03:42:37.626402 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:42:37.627402 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:37.628401 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:42:37.630400 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.631399 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:37.632398 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:37.639397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.641394 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.642393 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:37.653388 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.655386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.656385 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:42:37.657384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.716351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:42:37.716351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.717350 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:42:37.732341 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:37.736339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.736339 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:42:37.738338 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.741336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.742336 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:42:37.743337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.748333 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:42:37.749332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.749332 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:42:37.751332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.754329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:42:37.755328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:42:37.760325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:37.762326 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.762326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:42:37.763323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8623F5B0>]}
[0m03:42:37.764323 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.13s]
[0m03:42:37.766322 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:42:37.767322 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:42:37.768321 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:42:37.770320 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.770320 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:42:37.771319 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:42:37.779315 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.780314 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.781313 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:42:37.795305 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.796305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.797304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:42:37.798304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.851274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:42:37.852273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.853272 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:42:37.863626 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:37.867623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.868621 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:42:37.869622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.872621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.873620 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:42:37.874619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.877616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:42:37.878617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.878617 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:42:37.880468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.883469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:42:37.883469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:42:37.887513 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:37.889510 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.889510 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:42:37.890509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861052A0>]}
[0m03:42:37.891509 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:42:37.893507 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:42:37.893507 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:37.894510 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:42:37.895506 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.896508 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:37.897505 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:42:37.905503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.906503 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:37.907500 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:37.917497 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.919494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.920504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:42:37.920504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:37.964467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:37.964467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.965467 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:42:37.976857 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:37.980854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.980854 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:42:37.982854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.985853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.986851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:42:37.987850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:37.990851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:42:37.990851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.991850 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:42:37.993585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:37.997585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:42:37.997585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:42:38.002585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:38.004583 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.005582 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:42:38.006580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861051B0>]}
[0m03:42:38.006580 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:42:38.008579 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:42:38.009578 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:42:38.009578 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:42:38.011578 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.011578 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:42:38.012592 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:42:38.020572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.022571 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.022571 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:42:38.028567 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.029569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.030568 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:42:38.030568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:38.074541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:38.075541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.075541 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:42:38.087396 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:38.090394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.090394 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:42:38.091394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.094392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.095391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:42:38.096391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.099390 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:42:38.100389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.100389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:42:38.102387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:38.105385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:42:38.105385 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:42:38.109644 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:38.111643 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.111643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:42:38.112642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861050C0>]}
[0m03:42:38.113644 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.10s]
[0m03:42:38.116641 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:42:38.117643 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:42:38.118639 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:42:38.119639 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.120639 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:42:38.121638 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:42:38.127635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.129633 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.129633 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:42:38.137629 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.138627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.139628 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:42:38.139628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:38.180605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:38.181604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.182603 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:42:38.192736 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:42:38.196733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.197734 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:42:38.197734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.201731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.202731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:42:38.203731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.207727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:42:38.208727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.209727 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:42:38.211558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:38.216558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:42:38.217558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:42:38.221528 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:38.223527 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.223527 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:42:38.224526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86104FD0>]}
[0m03:42:38.225527 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.10s]
[0m03:42:38.227525 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:42:38.228525 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:42:38.228525 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:42:38.230525 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.232522 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:42:38.233523 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:42:38.294486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.295488 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.295488 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:42:38.303482 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.304480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.304480 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:42:38.305480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:38.343458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:38.344462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.344462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:42:38.382741 [debug] [Thread-1 (]: SQL status: SELECT 2421 in 0.04 seconds
[0m03:42:38.386738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.386738 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:42:38.387724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.390736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.391736 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:42:38.392732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:38.395718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:42:38.395718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.396718 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:42:38.398747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:38.401748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:42:38.401748 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:42:38.405824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:38.407823 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.407823 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:42:38.408822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D862750F0>]}
[0m03:42:38.409822 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 2421[0m in 0.18s]
[0m03:42:38.411821 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:42:38.411821 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:42:38.412820 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:42:38.413840 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:38.414821 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:42:38.415818 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:42:38.421815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:38.422814 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:38.423814 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:42:38.435807 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:38.437808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:38.438806 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:42:38.439805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:38.482781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:42:38.483779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:38.483779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:42:39.152412 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.67 seconds
[0m03:42:39.155395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:39.156394 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:42:39.156394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:39.161392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:39.162391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:42:39.163391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:39.167390 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:42:39.168388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:39.168388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:42:39.170545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:39.173561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:42:39.174547 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:42:39.178538 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:42:39.180537 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:39.181533 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:42:39.182534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8621C3A0>]}
[0m03:42:39.183534 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.77s]
[0m03:42:39.185531 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:42:39.186531 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:42:39.187532 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:42:39.189530 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.190530 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:42:39.191529 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:42:39.202523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.204521 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:39.205522 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:42:39.211517 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.212516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.213517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:42:39.213517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:42:39.399765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.19 seconds
[0m03:42:39.400742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.400742 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_id_genre_2 as (
    select distinct
    spsg.id_song
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg, "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 
    where (not spsg.genre = spg1.genre_1) and spsg.id_song=spg1.id_song

),

stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    right join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:42:39.418418 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:42:39.422397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.423396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:42:39.424394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:39.427413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.427413 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:42:39.428394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:42:39.432391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:42:39.432391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.433391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:42:39.435575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:42:39.438609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:42:39.438609 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:42:39.444720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:42:39.446743 [debug] [Thread-1 (]: finished collecting timing info
[0m03:42:39.446743 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:42:39.447723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8f7a68-2f36-46a5-b721-0817af61ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D861374F0>]}
[0m03:42:39.448721 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 3706[0m in 0.26s]
[0m03:42:39.450274 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:42:39.452275 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:42:39.453277 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:39.453277 [debug] [MainThread]: On master: BEGIN
[0m03:42:39.454275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:42:39.504469 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:42:39.505449 [debug] [MainThread]: On master: COMMIT
[0m03:42:39.505449 [debug] [MainThread]: Using postgres connection "master"
[0m03:42:39.505449 [debug] [MainThread]: On master: COMMIT
[0m03:42:39.506449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:42:39.507449 [debug] [MainThread]: On master: Close
[0m03:42:39.507449 [info ] [MainThread]: 
[0m03:42:39.509449 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m03:42:39.510446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:42:39.510446 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:42:39.511446 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:42:39.511446 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:42:39.524438 [info ] [MainThread]: 
[0m03:42:39.525449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:42:39.527437 [info ] [MainThread]: 
[0m03:42:39.528436 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:42:39.530446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86105960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86105C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86106DA0>]}


============================== 2022-11-23 03:43:14.126353 | 26feceb6-c170-4800-8efc-a19d85a683c0 ==============================
[0m03:43:14.126353 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:43:14.127353 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:43:14.128352 [debug] [MainThread]: Tracking: tracking
[0m03:43:14.147342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002777793F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002777795C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002777795C730>]}
[0m03:43:14.244301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:14.244301 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:43:14.265274 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:43:14.286912 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:43:14.296921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777AFD9C0>]}
[0m03:43:14.309898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002777792BE50>]}
[0m03:43:14.310899 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:43:14.311898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002777793F6A0>]}
[0m03:43:14.315896 [info ] [MainThread]: 
[0m03:43:14.317894 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:43:14.322924 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:43:14.337900 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:43:14.337900 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:43:14.338885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:14.397033 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:43:14.399030 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:43:14.400029 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:43:14.403030 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:43:14.404029 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:43:14.404029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:14.442453 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:43:14.443461 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:43:14.444464 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:43:14.448448 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:43:14.448448 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:43:14.449448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:14.489434 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:43:14.492423 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:43:14.495426 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:43:14.503417 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:43:14.504417 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:43:14.504417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:43:14.547018 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:43:14.547018 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:43:14.548020 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:43:14.555564 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:43:14.557579 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:43:14.558562 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:43:14.559561 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:43:14.562562 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:43:14.562562 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:43:14.563575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:14.604630 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:43:14.604630 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:43:14.605631 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:43:14.612636 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:43:14.614626 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:43:14.615623 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:43:14.616623 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:43:14.619621 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:43:14.620620 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:43:14.620620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:43:14.663596 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:43:14.664595 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:43:14.664595 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:43:14.672591 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:43:14.675590 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:43:14.676589 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:43:14.690581 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:14.690581 [debug] [MainThread]: On master: BEGIN
[0m03:43:14.691581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:43:14.763539 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:43:14.763539 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:14.764541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:43:14.815508 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:43:14.817509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777AB57E0>]}
[0m03:43:14.818509 [debug] [MainThread]: On master: ROLLBACK
[0m03:43:14.819507 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:14.820507 [debug] [MainThread]: On master: BEGIN
[0m03:43:14.820507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:43:14.821506 [debug] [MainThread]: On master: COMMIT
[0m03:43:14.822505 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:14.822505 [debug] [MainThread]: On master: COMMIT
[0m03:43:14.823504 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:43:14.823504 [debug] [MainThread]: On master: Close
[0m03:43:14.824505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:43:14.826504 [info ] [MainThread]: 
[0m03:43:14.836498 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:43:14.837499 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:43:14.839498 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.840497 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:43:14.841495 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:43:14.852490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.854488 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:14.855487 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:43:14.922449 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.923447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.924447 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:43:14.924447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:43:14.967422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:43:14.968423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.969421 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:43:14.988410 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:43:14.999404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:14.999404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:43:15.000403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.004401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:15.005401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:43:15.006401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.034384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:43:15.035384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:15.035384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:43:15.037199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.042214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:43:15.043214 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:43:15.047296 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.049302 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.050294 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:43:15.051294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777CB3430>]}
[0m03:43:15.051294 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.21s]
[0m03:43:15.053293 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:43:15.054292 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:43:15.054292 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:43:15.056294 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.057291 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:43:15.057291 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:43:15.063302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.064303 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.064303 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:43:15.074282 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.076281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.076281 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:43:15.077281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.122253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:43:15.122253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.123255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:43:15.134247 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:43:15.138259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.138259 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:43:15.140243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.143257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.143257 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:43:15.144241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.148241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:43:15.148241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.149240 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:43:15.150249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.153236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:43:15.154237 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:43:15.158195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.160207 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.160207 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:43:15.161196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C717B0>]}
[0m03:43:15.162195 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.10s]
[0m03:43:15.164194 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:43:15.165196 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:43:15.166193 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:43:15.167192 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.168192 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:43:15.168192 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:43:15.175189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:43:15.176195 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.177186 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:43:15.184182 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:43:15.187181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.188181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:43:15.189180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.235155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:15.235155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.236153 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:43:15.254143 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:43:15.258140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.258140 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:43:15.259140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.264137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.264137 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:43:15.265137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.269133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:43:15.270134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.270134 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:43:15.272495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.274496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:43:15.275495 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:43:15.280695 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:43:15.283693 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.283693 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:43:15.285693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777B41180>]}
[0m03:43:15.286694 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:43:15.287692 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:43:15.288703 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:43:15.288703 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:43:15.290692 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.291690 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:43:15.292690 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:43:15.300699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.303693 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.304685 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:43:15.310680 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.312677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.312677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:43:15.313689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.359651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:15.359651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.360651 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:43:15.462241 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:43:15.467236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.468236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:43:15.469236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.473245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.474248 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:43:15.475232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.478230 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:43:15.478230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.479230 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:43:15.481243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.484227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:43:15.484227 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:43:15.491346 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:43:15.493342 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.493342 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:43:15.494342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777D10160>]}
[0m03:43:15.495342 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:43:15.497342 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:43:15.498340 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:43:15.499339 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:43:15.501339 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.502337 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:43:15.504336 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:43:15.509348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.510335 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.510335 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:43:15.519330 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.521329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.522326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:43:15.522326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.570374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:15.571373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.572362 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:43:15.583003 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:15.585999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.586998 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:43:15.587999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.592996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.593994 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:43:15.594997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.597992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:43:15.597992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.598991 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:43:15.600692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.603693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:43:15.603693 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:43:15.609025 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.611023 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.612022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:43:15.613021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777B64580>]}
[0m03:43:15.614022 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:43:15.616020 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:43:15.617019 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:43:15.618019 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:43:15.620018 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.620018 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:43:15.621018 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:43:15.627013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.628013 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.629013 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:43:15.638008 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.639006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.640006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:43:15.641006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.692976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:15.693976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.694976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:43:15.710560 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:43:15.714560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.715558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:43:15.716561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.719556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.720555 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:43:15.721555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.724555 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:43:15.724555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.725554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:43:15.727870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.730871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:43:15.730871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:43:15.736364 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.738362 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.739361 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:43:15.739361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C71480>]}
[0m03:43:15.740360 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.12s]
[0m03:43:15.742360 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:43:15.743359 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:43:15.744358 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:43:15.745357 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.746358 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:43:15.747357 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:43:15.754353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.756352 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.756352 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:43:15.763347 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.765346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.767345 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:43:15.768344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.811321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:43:15.812320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.812320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:43:15.826568 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:15.829565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.830565 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:43:15.831566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.835562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.835562 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:43:15.836561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.842559 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:43:15.843559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.843559 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:43:15.845753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.847754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:43:15.848754 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:43:15.853685 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.855685 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.856685 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:43:15.857684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777B9FF40>]}
[0m03:43:15.858683 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:43:15.860682 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:43:15.861682 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:43:15.862680 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:43:15.863681 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.864680 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:43:15.865680 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:43:15.872675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.873674 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.874673 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:43:15.879671 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.880672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.881670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:43:15.881670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:15.926644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:43:15.927643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.927643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:43:15.939720 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:15.943719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.943719 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:43:15.944718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.947715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.948715 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:43:15.949714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:15.953711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:43:15.953711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.954711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:43:15.956353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:15.959353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:43:15.959353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:43:15.964722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:15.967720 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.968720 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:43:15.968720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C712A0>]}
[0m03:43:15.969719 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:43:15.971718 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:43:15.972718 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:43:15.972718 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:43:15.974717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:15.974717 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:43:15.975716 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:43:15.983711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:15.984711 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:15.986710 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:43:15.993706 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:15.994705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:15.994705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:43:15.995705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:16.046676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:16.047675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:16.048674 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:43:16.059668 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:16.063665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:16.064664 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:43:16.065664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.072660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:16.072660 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:43:16.073661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.077657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:43:16.078656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:16.078656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:43:16.080656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:16.086653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:43:16.086653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:43:16.092648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:16.094648 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.095647 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:43:16.096647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C71420>]}
[0m03:43:16.097646 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:43:16.099645 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:43:16.100645 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:43:16.101643 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:43:16.103642 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.105642 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:43:16.106641 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:43:16.112638 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.113637 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.114636 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:43:16.124632 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.126630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.126630 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:43:16.127629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:16.174603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:16.175602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.175602 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:43:16.189593 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:16.194590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.195589 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:43:16.196589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.201586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.202586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:43:16.203586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.206585 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:43:16.207584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.207584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:43:16.209582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:16.214579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:43:16.214579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:43:16.221575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:43:16.223576 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.224573 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:43:16.225573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C710C0>]}
[0m03:43:16.226572 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.12s]
[0m03:43:16.228572 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:43:16.229572 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:43:16.230570 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:43:16.232570 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.232570 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:43:16.233568 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:43:16.239567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.240565 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.241564 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:43:16.246560 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.248559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.250558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:43:16.252558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:16.306527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:16.307526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.307526 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:43:16.320518 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:43:16.326515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.326515 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:43:16.327515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.331513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.332513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:43:16.333511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.337510 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:43:16.338509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.338509 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:43:16.341507 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:16.347504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:43:16.347504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:43:16.353501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:16.355500 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.355500 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:43:16.356497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C71120>]}
[0m03:43:16.357498 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:43:16.358499 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:43:16.359497 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:43:16.360495 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:43:16.361495 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.362496 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:43:16.363495 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:43:16.429456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.431455 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.432455 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:43:16.443448 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.445447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.446447 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:43:16.446447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:16.530398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m03:43:16.531398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.531398 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:43:16.637337 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.1 seconds
[0m03:43:16.645332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.646332 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:43:16.647332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.654328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.655327 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:43:16.657326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:16.662325 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:43:16.663324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.663324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:43:16.665322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:16.671319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:43:16.672317 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:43:16.680312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:43:16.683311 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.684310 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:43:16.686309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777BD6920>]}
[0m03:43:16.687308 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.32s]
[0m03:43:16.689309 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:43:16.690308 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:43:16.691307 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:43:16.693306 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:16.694305 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:43:16.694305 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:43:16.703302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:16.705299 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:16.707298 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:43:16.727288 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:16.728287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:16.729287 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:43:16.730284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:16.814237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.08 seconds
[0m03:43:16.814237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:16.815237 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:43:17.391656 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.58 seconds
[0m03:43:17.397653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:17.397653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:43:17.399652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:17.402653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:17.402653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:43:17.403650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:17.408648 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:43:17.408648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:17.409649 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:43:17.411647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:17.414646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:43:17.415643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:43:17.421639 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:17.423642 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:17.423642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:43:17.424637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777B7C400>]}
[0m03:43:17.425637 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.73s]
[0m03:43:17.427636 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:43:17.428636 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:43:17.429635 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:43:17.431635 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.432634 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:43:17.434633 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:43:17.450625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.452622 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:17.453622 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:43:17.460619 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.462616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.462616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:43:17.463615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:43:17.512590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:43:17.513587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.513587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_id_genre_2 as (
    select distinct
    spsg.id_song
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg, "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 
    where (not spsg.genre = spg1.genre_1) and spsg.id_song=spg1.id_song

),

stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    inner join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:43:17.535575 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:43:17.541571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.541571 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:43:17.542570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:17.548567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.548567 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:43:17.550566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:43:17.553564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:43:17.553564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.554564 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:43:17.556564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:43:17.559561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:43:17.560560 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:43:17.565557 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:43:17.567556 [debug] [Thread-1 (]: finished collecting timing info
[0m03:43:17.568556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:43:17.568556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26feceb6-c170-4800-8efc-a19d85a683c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777CA3430>]}
[0m03:43:17.570555 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 3706[0m in 0.14s]
[0m03:43:17.572556 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:43:17.574552 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:43:17.575553 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:17.576552 [debug] [MainThread]: On master: BEGIN
[0m03:43:17.577552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:43:17.631521 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:43:17.632520 [debug] [MainThread]: On master: COMMIT
[0m03:43:17.633519 [debug] [MainThread]: Using postgres connection "master"
[0m03:43:17.633519 [debug] [MainThread]: On master: COMMIT
[0m03:43:17.634519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:43:17.635518 [debug] [MainThread]: On master: Close
[0m03:43:17.636518 [info ] [MainThread]: 
[0m03:43:17.637517 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m03:43:17.638516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:43:17.639517 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:43:17.640517 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:43:17.640517 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:43:17.660503 [info ] [MainThread]: 
[0m03:43:17.661503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:43:17.663502 [info ] [MainThread]: 
[0m03:43:17.666501 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:43:17.668499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C71960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C71C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027777C72DA0>]}


============================== 2022-11-23 03:46:53.236774 | 9f1f8b24-045a-428b-9d5f-f5659e07da4e ==============================
[0m03:46:53.236774 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:46:53.237775 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:46:53.237775 [debug] [MainThread]: Tracking: tracking
[0m03:46:53.255763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C1ECE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C210940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C210730>]}
[0m03:46:53.355708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:46:53.356707 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\genre\stg_genre_2.sql
[0m03:46:53.356707 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:46:53.372696 [debug] [MainThread]: 1699: static parser successfully parsed staging\genre\stg_genre_2.sql
[0m03:46:53.388543 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:46:53.397554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:46:53.408389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C3ADD20>]}
[0m03:46:53.422365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C32FDC0>]}
[0m03:46:53.422365 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:46:53.424102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C1ECE80>]}
[0m03:46:53.426124 [info ] [MainThread]: 
[0m03:46:53.428059 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:46:53.431062 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:46:53.448050 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:46:53.449049 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:46:53.450050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:53.650347 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.2 seconds
[0m03:46:53.652365 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:46:53.653346 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:46:53.655363 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:46:53.656362 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:46:53.656362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.703141 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:46:53.705152 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:46:53.706138 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:46:53.708153 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:46:53.709151 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:46:53.709151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.749629 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:46:53.752645 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:46:53.755627 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:46:53.762638 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:46:53.763638 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:46:53.763638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:46:53.803611 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:46:53.803611 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:46:53.804609 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:46:53.812037 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:46:53.815035 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:46:53.815035 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:46:53.817021 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:46:53.820016 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:46:53.821032 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:46:53.821032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.858319 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:46:53.859310 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:46:53.859310 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:46:53.866314 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:46:53.868305 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:46:53.869304 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:46:53.870301 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:46:53.873301 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:46:53.873301 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:46:53.874300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:46:53.915275 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:46:53.915275 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:46:53.916275 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:46:53.923287 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:46:53.925272 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:46:53.926269 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:46:53.933267 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:53.934264 [debug] [MainThread]: On master: BEGIN
[0m03:46:53.934264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:46:53.971243 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:46:53.972258 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:53.973244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:46:54.008221 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:46:54.009223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C355090>]}
[0m03:46:54.010236 [debug] [MainThread]: On master: ROLLBACK
[0m03:46:54.011223 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:54.011223 [debug] [MainThread]: On master: BEGIN
[0m03:46:54.012222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:46:54.012222 [debug] [MainThread]: On master: COMMIT
[0m03:46:54.013221 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:54.013221 [debug] [MainThread]: On master: COMMIT
[0m03:46:54.014218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:46:54.014218 [debug] [MainThread]: On master: Close
[0m03:46:54.015221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:46:54.016217 [info ] [MainThread]: 
[0m03:46:54.025243 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:46:54.026247 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:46:54.027416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.028419 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:46:54.028419 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:46:54.032416 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.034416 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.035414 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:46:54.092381 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.093381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.094381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:46:54.094381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:46:54.133358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:46:54.134360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.134360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:46:54.148696 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:46:54.156693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.157694 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:46:54.158693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.162703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.163690 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:46:54.163690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.197670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:46:54.198670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.198670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:46:54.200671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:54.206679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:46:54.207678 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:46:54.212103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:54.214116 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.214116 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:46:54.215106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C550C10>]}
[0m03:46:54.216104 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.19s]
[0m03:46:54.217699 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:46:54.218702 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:46:54.219703 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:46:54.220701 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.221701 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:46:54.222699 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:46:54.229696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.230694 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.231694 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:46:54.243687 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.244686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.245686 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:46:54.245686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:54.298655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:46:54.299655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.300654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:46:54.313647 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:46:54.319644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.320643 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:46:54.321642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.325642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.325642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:46:54.327648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.330637 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:46:54.331636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.332638 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:46:54.333637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:54.336634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:46:54.337634 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:46:54.341633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:54.344629 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.345629 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:46:54.346628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C5257B0>]}
[0m03:46:54.347629 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:46:54.348627 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:46:54.349628 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:46:54.350627 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:46:54.353626 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.354625 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:46:54.355624 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:46:54.363621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:46:54.364618 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.365617 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:46:54.377610 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:46:54.378612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.379611 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:46:54.379611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:54.439575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:46:54.440574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.440574 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:46:54.460564 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:46:54.464561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.465561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:46:54.466559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.472559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.473556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:46:54.474555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.478554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:46:54.478554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.479553 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:46:54.481551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:54.485548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:46:54.486548 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:46:54.491546 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:54.494543 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.495543 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:46:54.496543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C3F1180>]}
[0m03:46:54.497543 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.14s]
[0m03:46:54.499542 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:46:54.500541 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:46:54.501540 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:46:54.504539 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.506537 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:46:54.507538 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:46:54.514534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.515531 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.517541 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:46:54.528525 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.530523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.531523 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:46:54.532522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:54.628467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m03:46:54.629467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.630466 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:46:54.901312 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.27 seconds
[0m03:46:54.904309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.905309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:46:54.906310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.909306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.909306 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:46:54.910307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:54.914305 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:46:54.914305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.915304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:46:54.917591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:54.920592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:46:54.920592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:46:54.926136 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:54.928134 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.929135 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:46:54.930133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C3AEC20>]}
[0m03:46:54.931133 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.43s]
[0m03:46:54.933133 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:46:54.934132 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:46:54.935130 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:46:54.937129 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:54.938128 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:46:54.939128 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:46:54.945124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:54.946125 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:54.947124 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:46:54.955119 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:54.956118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:54.957118 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:46:54.957118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.000094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:46:55.001093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:55.001093 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:46:55.011501 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.015497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:55.016497 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:46:55.017498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.022493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:55.023493 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:46:55.024493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.027491 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:46:55.027491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:55.028489 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:46:55.030067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.033068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:46:55.033068 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:46:55.038501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:55.040500 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.041499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:46:55.042499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C40F7C0>]}
[0m03:46:55.042499 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.10s]
[0m03:46:55.044500 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:46:55.044500 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:46:55.045497 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:46:55.046497 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:46:55.047497 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:46:55.048496 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:46:55.057491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:46:55.058490 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.059489 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:46:55.064501 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:46:55.066486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:46:55.067484 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:46:55.068484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.111459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:46:55.112460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:46:55.112460 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ',2)) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:46:55.114458 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la función string_to_array(character varying, unknown, integer)
LINE 12:     unnest(string_to_array(psg.genre, ', ',2)) as genre
                    ^
HINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.

[0m03:46:55.115458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:46:55.116457 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.117465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:46:55.118456 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  no existe la función string_to_array(character varying, unknown, integer)
  LINE 12:     unnest(string_to_array(psg.genre, ', ',2)) as genre
                      ^
  HINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:46:55.119455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C519750>]}
[0m03:46:55.119455 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:46:55.121453 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:46:55.122453 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:46:55.122453 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:46:55.124452 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.124452 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:46:55.125452 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:46:55.130448 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.132447 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.133448 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:46:55.145440 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.147440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.147440 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:46:55.148438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.204406 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:46:55.204406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.205405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:46:55.218397 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.221396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.222395 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:46:55.223396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.226393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.226393 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:46:55.227393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.230391 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:46:55.231390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.231390 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:46:55.235262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.237262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:46:55.238262 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:46:55.243294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:46:55.245292 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.245292 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:46:55.246292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C5019C0>]}
[0m03:46:55.248291 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.12s]
[0m03:46:55.250290 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:46:55.251290 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:46:55.252288 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:46:55.253287 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.254288 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:46:55.255287 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:46:55.261283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.263283 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.263283 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:46:55.275275 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.276276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.276276 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:46:55.277274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.320250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:46:55.321249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.321249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:46:55.330872 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.334869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.335868 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:46:55.336869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.339866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.340865 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:46:55.341865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.344864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:46:55.345862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.345862 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:46:55.348098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.351100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:46:55.351100 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:46:55.357449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:46:55.358459 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.359447 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:46:55.360446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C507A60>]}
[0m03:46:55.360446 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:46:55.362446 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:46:55.363445 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:46:55.363445 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:46:55.365447 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.366444 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:46:55.367443 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:46:55.375438 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.376438 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.377436 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:46:55.388431 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.390429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.391429 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:46:55.391429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.439401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:46:55.440403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.440403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:46:55.452239 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.456240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.457238 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:46:55.458238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.461235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.461235 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:46:55.462233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.468230 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:46:55.469234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.469234 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:46:55.471675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.473677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:46:55.474675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:46:55.480672 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:46:55.483671 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.484671 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:46:55.486669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C507C40>]}
[0m03:46:55.487668 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:46:55.489667 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:46:55.490668 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:46:55.491666 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:46:55.494665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.494665 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:46:55.495665 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:46:55.506658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.508656 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.508656 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:46:55.523648 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.525647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.526646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:46:55.526646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.576617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:46:55.577618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.577618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:46:55.589480 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.595475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.595475 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:46:55.596474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.600473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.600473 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:46:55.601473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.605469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:46:55.605469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.606469 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:46:55.608029 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.611031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:46:55.611031 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:46:55.616204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:46:55.618202 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.619201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:46:55.619201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C5250C0>]}
[0m03:46:55.620201 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.13s]
[0m03:46:55.622199 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:46:55.622199 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:46:55.623200 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:46:55.624199 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.625198 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:46:55.625198 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:46:55.631196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.633194 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.634199 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:46:55.644187 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.645186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.645186 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:46:55.646186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.703154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:46:55.704152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.704152 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:46:55.719145 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:46:55.725141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.725141 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:46:55.726140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.730138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.731138 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:46:55.732138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.737133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:46:55.738133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.738133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:46:55.740133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.743132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:46:55.743132 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:46:55.750126 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:46:55.751127 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.752126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:46:55.753125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C524FD0>]}
[0m03:46:55.754124 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:46:55.756124 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:46:55.757123 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:46:55.758122 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:46:55.760122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.761121 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:46:55.762120 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:46:55.775114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.777111 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.777111 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:46:55.783108 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.785106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.786107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:46:55.787108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:46:55.838076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:46:55.839076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.840075 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:46:55.888048 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.05 seconds
[0m03:46:55.898042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.898042 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:46:55.899041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.950012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.950012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:46:55.951012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:46:55.955010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:46:55.955010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.956010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:46:55.959008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:46:55.962006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:46:55.962006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:46:55.969001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:46:55.970002 [debug] [Thread-1 (]: finished collecting timing info
[0m03:46:55.971002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:46:55.972000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f8b24-045a-428b-9d5f-f5659e07da4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C494040>]}
[0m03:46:55.972999 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.21s]
[0m03:46:55.974998 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:46:55.975997 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:46:55.976997 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:46:55.979996 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:46:55.981994 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:46:55.983993 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:46:55.985992 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:46:55.987991 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:46:55.987991 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:55.988991 [debug] [MainThread]: On master: BEGIN
[0m03:46:55.989989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:46:56.040960 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:46:56.041959 [debug] [MainThread]: On master: COMMIT
[0m03:46:56.041959 [debug] [MainThread]: Using postgres connection "master"
[0m03:46:56.042960 [debug] [MainThread]: On master: COMMIT
[0m03:46:56.042960 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:46:56.043958 [debug] [MainThread]: On master: Close
[0m03:46:56.043958 [info ] [MainThread]: 
[0m03:46:56.044958 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m03:46:56.046958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:46:56.046958 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:46:56.047957 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:46:56.047957 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:46:56.062948 [info ] [MainThread]: 
[0m03:46:56.063948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:46:56.065946 [info ] [MainThread]: 
[0m03:46:56.070943 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:46:56.071943 [error] [MainThread]:   no existe la función string_to_array(character varying, unknown, integer)
[0m03:46:56.072942 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ',2)) as genre
[0m03:46:56.073941 [error] [MainThread]:                       ^
[0m03:46:56.075942 [error] [MainThread]:   HINT:  Ninguna función coincide en el nombre y tipos de argumentos. Puede ser necesario agregar conversión explícita de tipos.
[0m03:46:56.076940 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:46:56.077940 [info ] [MainThread]: 
[0m03:46:56.078940 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:46:56.079939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C1DD750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C1DD720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295C1DD0C0>]}


============================== 2022-11-23 03:49:37.522350 | 036e24e0-c03a-4943-abe8-b5929148b4f3 ==============================
[0m03:49:37.522350 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:49:37.523347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:49:37.523347 [debug] [MainThread]: Tracking: tracking
[0m03:49:37.540338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635CB0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635CB09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635CB07F0>]}
[0m03:49:37.648500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:49:37.648500 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:49:37.667471 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:49:37.698451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:49:37.709658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635E51A50>]}
[0m03:49:37.722651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635DCFEE0>]}
[0m03:49:37.723650 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:49:37.725079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635DCFE50>]}
[0m03:49:37.728096 [info ] [MainThread]: 
[0m03:49:37.730080 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:49:37.733080 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:37.748083 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:37.749085 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:37.750069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:37.813033 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:49:37.815031 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:37.816030 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:37.819029 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:37.820028 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:37.820028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:37.859005 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:49:37.861005 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:37.862004 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:37.865003 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:37.866002 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:37.866002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:37.904981 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:49:37.907978 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:37.910978 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:37.918972 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:37.919972 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:49:37.919972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:37.961947 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:49:37.961947 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:37.962947 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:49:37.969975 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:49:37.971944 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:49:37.972941 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:49:37.973940 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:37.976939 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:37.976939 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:49:37.977938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:38.015916 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:49:38.016916 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:38.017916 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:49:38.023913 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:49:38.025911 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:49:38.026909 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:49:38.027909 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:38.030907 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:38.030907 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:49:38.031907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:38.214210 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m03:49:38.215213 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:38.215213 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:49:38.227355 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:49:38.229355 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:49:38.229355 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:49:38.237350 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:38.238350 [debug] [MainThread]: On master: BEGIN
[0m03:49:38.238350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:49:38.276996 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:49:38.277993 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:38.278992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:49:38.325965 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:49:38.327966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635E05F00>]}
[0m03:49:38.328963 [debug] [MainThread]: On master: ROLLBACK
[0m03:49:38.328963 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:38.329964 [debug] [MainThread]: On master: BEGIN
[0m03:49:38.330963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:49:38.330963 [debug] [MainThread]: On master: COMMIT
[0m03:49:38.331962 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:38.332962 [debug] [MainThread]: On master: COMMIT
[0m03:49:38.332962 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:49:38.333961 [debug] [MainThread]: On master: Close
[0m03:49:38.334961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:49:38.335961 [info ] [MainThread]: 
[0m03:49:38.345956 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:49:38.346954 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:49:38.347953 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.348954 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:49:38.349952 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:49:38.357949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.358949 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.359946 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:49:38.432905 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.434905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.435902 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:49:38.435902 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:49:38.478880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:38.479877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.479877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:49:38.497874 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:49:38.508861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.509860 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:49:38.510860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.515857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.515857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:49:38.517857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.554835 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:49:38.554835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.555834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:49:38.557834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:38.564829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:38.564829 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:49:38.570827 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:38.571825 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.572824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:49:38.573823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EE8BB0>]}
[0m03:49:38.574824 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.23s]
[0m03:49:38.576822 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:49:38.577822 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:49:38.578821 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:49:38.580820 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.581820 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:49:38.581820 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:49:38.590815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.592813 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.593813 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:49:38.605808 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.607805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.607805 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:49:38.608805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:38.652780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:38.653779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.654778 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:49:38.663569 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:49:38.670565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.671565 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:49:38.672565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.678561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.678561 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:49:38.680561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.684558 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:49:38.685557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.686556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:49:38.688555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:38.692553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:38.693553 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:49:38.700548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:38.703547 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.704546 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:49:38.705546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EB57B0>]}
[0m03:49:38.707545 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:49:38.709543 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:49:38.710543 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:49:38.711543 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:49:38.714540 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.717539 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:49:38.718540 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:49:38.737527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:49:38.740527 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.741526 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:49:38.753518 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:49:38.755517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.755517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:49:38.756515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:38.810486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:38.811485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.811485 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:49:38.828304 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:49:38.832303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.833302 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:49:38.834301 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.839298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.840298 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:49:38.841297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:38.844295 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:49:38.844295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.845294 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:49:38.847387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:38.850389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:38.851388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:49:38.856385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:38.858385 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.859384 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:49:38.860382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635F91180>]}
[0m03:49:38.861382 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.15s]
[0m03:49:38.862381 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:49:38.863380 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:49:38.864381 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:49:38.865380 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:38.866379 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:49:38.867378 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:49:38.875374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:49:38.876374 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:38.877372 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:49:38.882369 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:49:38.884370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:38.886368 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:49:38.887367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:38.939338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:38.940337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:38.940337 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:49:39.043074 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:49:39.048071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:39.048071 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:49:39.049071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.052068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:39.053067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:49:39.054068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.058066 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:49:39.058066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:39.059064 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:49:39.061547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.064548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:39.064548 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:49:39.070662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:39.072659 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.073658 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:49:39.074673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635DE1960>]}
[0m03:49:39.075657 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.21s]
[0m03:49:39.076673 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:49:39.077656 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:39.078655 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:49:39.079671 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.080658 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:39.081654 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:39.088661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.090649 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.091649 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:39.098644 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.099659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.100646 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:49:39.101642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.144618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:39.145616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.145616 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:49:39.157901 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.161897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.162897 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:49:39.162897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.169893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.169893 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:49:39.170891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.174890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:49:39.175888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.175888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:49:39.178159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.180161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:39.181161 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:49:39.187156 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:39.189156 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.190154 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:49:39.191154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635FB45B0>]}
[0m03:49:39.191154 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:49:39.193153 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:39.194153 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:39.194153 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:49:39.195152 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:39.196152 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:39.197152 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:39.204147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:39.206147 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.206147 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:39.212141 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:39.214141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:39.214141 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:49:39.215140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.262114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.263114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:39.263114 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')[0:2]) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:49:39.264112 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «[»
LINE 12:     unnest(string_to_array(psg.genre, ', ')[0:2]) as genre
                                                    ^

[0m03:49:39.265112 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:49:39.265112 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.266114 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:49:39.267111 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «[»
  LINE 12:     unnest(string_to_array(psg.genre, ', ')[0:2]) as genre
                                                      ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:49:39.268110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635E9C2E0>]}
[0m03:49:39.269110 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:49:39.271110 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:39.272107 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:39.272107 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:49:39.274108 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.274108 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:39.275106 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:39.279104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.280103 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.281103 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:39.288101 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.290099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.290099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:49:39.291097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.337070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.338072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.339069 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:49:39.351017 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.355013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.356012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:49:39.357013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.360009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.360009 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:49:39.361010 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.365008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:49:39.365008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.366007 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:49:39.368535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.371537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:39.371537 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:49:39.377548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:39.379547 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.380547 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:49:39.380547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635E05BA0>]}
[0m03:49:39.381546 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:49:39.383548 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:39.384544 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:49:39.384544 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:49:39.386544 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.387543 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:49:39.387543 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:49:39.392539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.394538 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.394538 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:49:39.407532 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.408532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.409529 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:49:39.409529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.457502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.458503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.458503 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:49:39.469503 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.473502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.473502 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:49:39.474500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.478499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.478499 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:49:39.480500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.483496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:49:39.483496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.484497 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:49:39.486364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.489367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:39.489367 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:49:39.495363 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:39.497361 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.498361 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:49:39.499359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EB5270>]}
[0m03:49:39.499359 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:49:39.501360 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:49:39.502358 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:39.502358 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:49:39.504357 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.505357 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:39.506356 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:49:39.511352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.513351 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.513351 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:39.522347 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.523346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.524348 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:49:39.524348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.572319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.572319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.573318 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:49:39.584367 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.588364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.588364 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:49:39.589364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.592361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.593360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:49:39.594360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.597359 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:49:39.598358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.598358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:49:39.600356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.603355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:39.604354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:49:39.609291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:39.611299 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.612303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:49:39.613287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EB51B0>]}
[0m03:49:39.614286 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:49:39.615287 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:39.616286 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:49:39.617285 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:49:39.618285 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.619284 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:49:39.620284 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:49:39.626282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.627279 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.628278 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:49:39.637274 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.639273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.640273 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:49:39.641274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.703236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:49:39.704235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.704235 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:49:39.719226 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.725224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.725224 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:49:39.726223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.730220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.730220 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:49:39.732219 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.736216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:49:39.736216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.737217 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:49:39.739216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.743212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:39.743212 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:49:39.752208 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:39.755207 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.756206 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:49:39.757206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EB5210>]}
[0m03:49:39.759206 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.14s]
[0m03:49:39.761203 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:49:39.761203 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:49:39.762202 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:49:39.764201 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.765201 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:49:39.766200 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:49:39.776194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.777195 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.778193 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:49:39.787189 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.789187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.790186 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:49:39.791186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.842156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.842156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.843157 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:49:39.859146 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:39.863144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.864144 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:49:39.865143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.869142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.870141 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:49:39.871139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:39.875139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:49:39.875139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.876137 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:49:39.878137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:39.881135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:39.881135 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:49:39.888129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:39.890131 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.890131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:49:39.892127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635EB4FD0>]}
[0m03:49:39.893127 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:49:39.895126 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:49:39.895126 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:49:39.896125 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:49:39.898126 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:39.899124 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:49:39.899124 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:49:39.915115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:49:39.919115 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:39.920112 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:49:39.928109 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:49:39.930107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:39.930107 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:49:39.931107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:39.981077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:39.982076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:39.982076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:49:40.036061 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.05 seconds
[0m03:49:40.042056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:40.043056 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:49:40.044041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:40.090035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:40.091034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:49:40.092013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:40.096011 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:49:40.096011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:40.097010 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:49:40.099819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:40.101841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:40.102821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:49:40.108207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:40.110223 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:40.110223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:49:40.111205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036e24e0-c03a-4943-abe8-b5929148b4f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013636030040>]}
[0m03:49:40.112206 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.21s]
[0m03:49:40.114224 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:49:40.115203 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:49:40.115203 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:49:40.117203 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:49:40.118202 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:49:40.119202 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:49:40.121200 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:49:40.122200 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:49:40.123220 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:40.123220 [debug] [MainThread]: On master: BEGIN
[0m03:49:40.124201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:49:40.170173 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:49:40.171173 [debug] [MainThread]: On master: COMMIT
[0m03:49:40.171173 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:40.172171 [debug] [MainThread]: On master: COMMIT
[0m03:49:40.173170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:49:40.173170 [debug] [MainThread]: On master: Close
[0m03:49:40.174170 [info ] [MainThread]: 
[0m03:49:40.175169 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m03:49:40.176169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:40.177168 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:49:40.177168 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:49:40.178167 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:49:40.191160 [info ] [MainThread]: 
[0m03:49:40.192160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:40.194158 [info ] [MainThread]: 
[0m03:49:40.195158 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:49:40.196158 [error] [MainThread]:   error de sintaxis en o cerca de «[»
[0m03:49:40.197159 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ')[0:2]) as genre
[0m03:49:40.198157 [error] [MainThread]:                                                       ^
[0m03:49:40.200155 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:49:40.202154 [info ] [MainThread]: 
[0m03:49:40.203153 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:49:40.205152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635C7D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635C7D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013635C7E200>]}


============================== 2022-11-23 03:49:57.153424 | 5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e ==============================
[0m03:49:57.153424 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:49:57.154432 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:49:57.154432 [debug] [MainThread]: Tracking: tracking
[0m03:49:57.171422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAF10520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAF10A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAF10790>]}
[0m03:49:57.266360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:49:57.267362 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:49:57.280351 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:49:57.303100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:49:57.315112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB0B1A80>]}
[0m03:49:57.328083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB02BF10>]}
[0m03:49:57.329085 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:49:57.330314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB02BE80>]}
[0m03:49:57.333317 [info ] [MainThread]: 
[0m03:49:57.335314 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:49:57.340313 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:57.355303 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:57.356313 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:57.356313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:57.413750 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:49:57.415749 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:57.417749 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:57.420761 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:57.420761 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:57.421745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:57.580430 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.16 seconds
[0m03:49:57.581448 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:57.582442 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:49:57.585426 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:49:57.586425 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:49:57.586425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:57.627552 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:49:57.630568 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:49:57.633551 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:57.641561 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:57.641561 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:49:57.641561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:49:57.779189 [debug] [ThreadPool]: SQL status: BEGIN in 0.14 seconds
[0m03:49:57.779189 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:49:57.780190 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:49:57.787839 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:49:57.789854 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:49:57.790859 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:49:57.791838 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:57.793838 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:57.794837 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:49:57.794837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:57.835965 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:49:57.836978 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:49:57.836978 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:49:57.845628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:49:57.847630 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:49:57.848628 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:49:57.849626 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:57.852624 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:57.852624 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:49:57.853623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:49:57.893143 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:49:57.893143 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:49:57.894132 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:49:57.902150 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:49:57.904164 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:49:57.905148 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:49:57.912146 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:57.913144 [debug] [MainThread]: On master: BEGIN
[0m03:49:57.913144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:49:57.953945 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:49:57.953945 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:57.954935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:49:57.987935 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m03:49:57.988915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB067B80>]}
[0m03:49:57.989931 [debug] [MainThread]: On master: ROLLBACK
[0m03:49:57.990916 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:57.990916 [debug] [MainThread]: On master: BEGIN
[0m03:49:57.991912 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:49:57.991912 [debug] [MainThread]: On master: COMMIT
[0m03:49:57.992912 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:57.992912 [debug] [MainThread]: On master: COMMIT
[0m03:49:57.993911 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:49:57.993911 [debug] [MainThread]: On master: Close
[0m03:49:57.994910 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:49:57.995911 [info ] [MainThread]: 
[0m03:49:58.004907 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:49:58.004907 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:49:58.006903 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.006903 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:49:58.007903 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:49:58.011903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.012900 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.013918 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:49:58.081863 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.083860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.084864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:49:58.085859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:49:58.130836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:58.131832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.131832 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:49:58.150822 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:49:58.163815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.164813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:49:58.165814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.174807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.174807 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:49:58.175808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.213785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:49:58.213785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.214785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:49:58.216784 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:58.223779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:49:58.223779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:49:58.228777 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:58.230777 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.231775 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:49:58.232774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB144BE0>]}
[0m03:49:58.233775 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.23s]
[0m03:49:58.235774 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:49:58.235774 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:49:58.236773 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:49:58.238773 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.239771 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:49:58.239771 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:49:58.247768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.248766 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.249765 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:49:58.260759 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.262763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.263757 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:49:58.263757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:58.318725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:58.318725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.319726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:49:58.331718 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:49:58.336716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.337716 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:49:58.338713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.343712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.343712 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:49:58.344710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.349708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:49:58.350707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.350707 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:49:58.352706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:58.355706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:49:58.356706 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:49:58.361702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:49:58.363700 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.364699 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:49:58.365698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB1157B0>]}
[0m03:49:58.366698 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.13s]
[0m03:49:58.368697 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:49:58.369697 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:49:58.370697 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:49:58.373695 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.374694 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:49:58.375693 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:49:58.380690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:49:58.381691 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.382689 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:49:58.392683 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:49:58.393684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.394682 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:49:58.394682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:58.440655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:58.440655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.441656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:49:58.459049 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:49:58.463048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.463048 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:49:58.465046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.471043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.472042 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:49:58.473042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.476040 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:49:58.476040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.477040 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:49:58.478763 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:58.481766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:49:58.482763 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:49:58.488202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:58.490201 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.491201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:49:58.491201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB1F1180>]}
[0m03:49:58.492201 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:49:58.494199 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:49:58.494199 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:49:58.495198 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:49:58.496197 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.497198 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:49:58.498197 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:49:58.507191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.509190 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.510189 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:49:58.515186 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.517186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.518185 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:49:58.519185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:58.563159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:58.564160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.564160 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:49:58.663614 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:49:58.669596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.669596 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:49:58.672595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.678591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.678591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:49:58.679590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.685587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:49:58.685587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.686586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:49:58.689585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:58.694581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:49:58.695584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:49:58.704579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:58.706575 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.707579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:49:58.708573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB02BE80>]}
[0m03:49:58.709573 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.21s]
[0m03:49:58.712571 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:49:58.713572 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:58.713572 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:49:58.716570 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.717569 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:58.720567 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:58.728562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.730561 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.731560 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:58.745553 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.746552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.747554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:49:58.748551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:58.808516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:49:58.809516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.809516 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:49:58.819980 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:58.824976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.824976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:49:58.825975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.830974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.831972 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:49:58.832972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:58.836970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:49:58.836970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.837971 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:49:58.839682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:58.841684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:49:58.842684 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:49:58.847966 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:58.849966 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.849966 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:49:58.850965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB20B790>]}
[0m03:49:58.851963 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.14s]
[0m03:49:58.853963 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:49:58.854962 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:58.854962 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:49:58.856964 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:58.857960 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:58.858959 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:58.863956 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:58.864955 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.865957 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:58.877949 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:58.879950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:58.879950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:49:58.880947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:58.924921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:58.925921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:49:58.925921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')[-1:1]) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:49:58.926920 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «[»
LINE 12:     unnest(string_to_array(psg.genre, ', ')[-1:1]) as genre
                                                    ^

[0m03:49:58.927919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:49:58.927919 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.928919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:49:58.929919 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «[»
  LINE 12:     unnest(string_to_array(psg.genre, ', ')[-1:1]) as genre
                                                      ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:49:58.929919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB10B130>]}
[0m03:49:58.930918 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:49:58.932916 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:49:58.933917 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:58.934916 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:49:58.936914 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:58.936914 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:58.937913 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:58.942910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:58.943909 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:58.944909 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:58.951905 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:58.953905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:58.954905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:49:58.955904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.001878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:59.002876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:59.003877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:49:59.017868 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:59.021866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:59.022864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:49:59.023865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.026862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:59.027862 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:49:59.028862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.033859 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:49:59.034858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:59.035857 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:49:59.037856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.042853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:49:59.043852 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:49:59.049850 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.051848 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.052847 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:49:59.053847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB0FBE20>]}
[0m03:49:59.054846 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.12s]
[0m03:49:59.057845 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:49:59.058844 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:49:59.059844 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:49:59.061843 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.062843 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:49:59.063843 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:49:59.071839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.073836 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.074835 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:49:59.084836 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.086829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.087828 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:49:59.088828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.137799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:59.138798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.138798 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:49:59.149796 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:59.153794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.154793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:49:59.155794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.158793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.159790 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:49:59.160791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.163791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:49:59.164789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.164789 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:49:59.166788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.169785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:49:59.169785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:49:59.175866 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.177866 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.178863 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:49:59.179863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB248C40>]}
[0m03:49:59.179863 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:49:59.181863 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:49:59.182861 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:59.183861 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:49:59.184863 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.185860 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:59.185860 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:49:59.189872 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.190859 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.191856 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:59.197854 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.198852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.199867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:49:59.199867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.249824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:59.250824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.251823 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:49:59.261731 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:59.265730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.266728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:49:59.267728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.270727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.271726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:49:59.272725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.275724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:49:59.275724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.276723 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:49:59.278377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.280380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:49:59.281379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:49:59.287719 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.289729 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.289729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:49:59.290717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB1AFCA0>]}
[0m03:49:59.291717 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:49:59.292732 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:49:59.293716 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:49:59.294716 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:49:59.295717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.296715 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:49:59.297714 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:49:59.304719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.306723 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.306723 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:49:59.315720 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.317704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.318705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:49:59.319702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.363689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:49:59.363689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.364677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:49:59.376675 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:59.381671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.382670 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:49:59.383670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.387667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.388667 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:49:59.389667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.392665 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:49:59.393664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.393664 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:49:59.395666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.398661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:49:59.399661 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:49:59.406657 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.408657 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.408657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:49:59.410656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB1150C0>]}
[0m03:49:59.411654 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.11s]
[0m03:49:59.412654 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:49:59.413653 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:49:59.414652 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:49:59.415652 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.416651 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:49:59.417651 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:49:59.425645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.427645 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.427645 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:49:59.437639 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.439638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.440637 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:49:59.441637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.494607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:49:59.494607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.495606 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:49:59.508598 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:49:59.512597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.513597 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:49:59.514596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.520591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.521591 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:49:59.522590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.527587 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:49:59.528586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.529586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:49:59.530586 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.533584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:49:59.534584 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:49:59.540580 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.542580 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.543579 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:49:59.544578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB114FD0>]}
[0m03:49:59.545577 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:49:59.547577 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:49:59.548575 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:49:59.548575 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:49:59.550575 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.551574 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:49:59.552574 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:49:59.565566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.567565 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.567565 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:49:59.573561 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.574561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.575560 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:49:59.575560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:49:59.729472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:49:59.729472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.730474 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:49:59.778403 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.05 seconds
[0m03:49:59.783416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.784400 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:49:59.785399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.831375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.832374 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:49:59.833372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:49:59.836370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:49:59.837370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.837370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:49:59.840980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.844962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:49:59.844962 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:49:59.851193 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:49:59.853192 [debug] [Thread-1 (]: finished collecting timing info
[0m03:49:59.854191 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:49:59.854191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d803603-fb3c-4ca8-9b7e-1f0c86a8d71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEB294040>]}
[0m03:49:59.855193 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.30s]
[0m03:49:59.856972 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:49:59.857977 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:49:59.857977 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:49:59.859974 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:49:59.861973 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:49:59.862976 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:49:59.865188 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:49:59.868197 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:49:59.869204 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:59.870188 [debug] [MainThread]: On master: BEGIN
[0m03:49:59.870188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:49:59.917561 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:49:59.918561 [debug] [MainThread]: On master: COMMIT
[0m03:49:59.919559 [debug] [MainThread]: Using postgres connection "master"
[0m03:49:59.919559 [debug] [MainThread]: On master: COMMIT
[0m03:49:59.920558 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:49:59.920558 [debug] [MainThread]: On master: Close
[0m03:49:59.921558 [info ] [MainThread]: 
[0m03:49:59.922557 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m03:49:59.924556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:49:59.924556 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:49:59.925556 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:49:59.926556 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:49:59.941546 [info ] [MainThread]: 
[0m03:49:59.942546 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:49:59.944544 [info ] [MainThread]: 
[0m03:49:59.945544 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:49:59.947545 [error] [MainThread]:   error de sintaxis en o cerca de «[»
[0m03:49:59.948543 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ')[-1:1]) as genre
[0m03:49:59.949544 [error] [MainThread]:                                                       ^
[0m03:49:59.951553 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:49:59.955539 [info ] [MainThread]: 
[0m03:49:59.957538 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:49:59.959538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAEDD720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAEDD360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026FEAEDDF90>]}


============================== 2022-11-23 03:51:27.441020 | 683c2663-94a0-4308-ba96-e5a4dbde0414 ==============================
[0m03:51:27.441020 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:51:27.442282 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:51:27.442282 [debug] [MainThread]: Tracking: tracking
[0m03:51:27.462016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B1174C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B11A09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B11A0790>]}
[0m03:51:27.555954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:51:27.556951 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:51:27.571958 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:51:27.593933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:51:27.605998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B133DA20>]}
[0m03:51:27.617991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B1137E20>]}
[0m03:51:27.618997 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:51:27.620988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B1174C10>]}
[0m03:51:27.624997 [info ] [MainThread]: 
[0m03:51:27.626874 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:51:27.629875 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:27.646865 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:27.647864 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:27.647864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:27.720432 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.07 seconds
[0m03:51:27.722430 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:27.723429 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:27.725429 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:27.726427 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:27.727428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:27.767720 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:51:27.769717 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:27.770717 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:27.773715 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:27.774714 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:27.774714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:27.813692 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:51:27.815692 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:27.818689 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:27.826684 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:27.827684 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:51:27.827684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:27.866663 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:51:27.867661 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:27.867661 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:51:27.874658 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:51:27.876656 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:51:27.877655 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:51:27.878655 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:27.883653 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:27.883653 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:51:27.884653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:27.921632 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:51:27.922631 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:27.923629 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:51:27.929626 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:51:27.931625 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:51:27.932624 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:51:27.933623 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:27.936622 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:27.936622 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:51:27.937621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:27.977600 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:51:27.978598 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:27.978598 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:51:27.985595 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:51:27.987593 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:51:27.988592 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:51:27.995588 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:27.995588 [debug] [MainThread]: On master: BEGIN
[0m03:51:27.996589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:28.037568 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:51:28.037568 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:28.038564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:51:28.084538 [debug] [MainThread]: SQL status: SELECT 0 in 0.05 seconds
[0m03:51:28.086536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B12F5930>]}
[0m03:51:28.087535 [debug] [MainThread]: On master: ROLLBACK
[0m03:51:28.087535 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:28.088534 [debug] [MainThread]: On master: BEGIN
[0m03:51:28.088534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:51:28.089534 [debug] [MainThread]: On master: COMMIT
[0m03:51:28.089534 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:28.090533 [debug] [MainThread]: On master: COMMIT
[0m03:51:28.090533 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:51:28.091532 [debug] [MainThread]: On master: Close
[0m03:51:28.092533 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:51:28.093532 [info ] [MainThread]: 
[0m03:51:28.103527 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:51:28.104526 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:51:28.106525 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.107524 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:51:28.107524 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:51:28.111522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.113522 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.113522 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:51:28.173488 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.175487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.175487 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:51:28.176484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:51:28.314408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.14 seconds
[0m03:51:28.315407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.315407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:51:28.333397 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:51:28.343389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.343389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:51:28.344388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.351400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.352399 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:51:28.353384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.393362 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:51:28.394363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.395359 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:51:28.396359 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:28.405354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:28.405354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:51:28.410350 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:28.412349 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.413348 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:51:28.414349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14E0B80>]}
[0m03:51:28.415348 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.31s]
[0m03:51:28.417347 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:51:28.418347 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:51:28.419347 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:51:28.421345 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.421345 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:51:28.422344 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:51:28.429340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.430339 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.431340 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:51:28.440334 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.441333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.441333 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:51:28.442333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:28.487309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:28.488306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.488306 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:51:28.498944 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:51:28.503940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.503940 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:51:28.504941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.507938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.508937 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:51:28.509938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.512936 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:51:28.513935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.513935 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:51:28.515672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:28.518674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:28.518674 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:51:28.522750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:28.524750 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.524750 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:51:28.525749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14B17B0>]}
[0m03:51:28.526748 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:51:28.528749 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:51:28.528749 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:51:28.529748 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:51:28.531746 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.531746 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:51:28.532745 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:51:28.540741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:51:28.542739 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.543738 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:51:28.549734 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:51:28.551736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.552733 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:51:28.552733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:28.595710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:28.595710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.596708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:51:28.615090 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:28.620088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.620088 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:51:28.621088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.626086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.626086 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:51:28.627086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.630083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:51:28.631083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.631083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:51:28.633200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:28.636202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:28.637201 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:51:28.642199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:28.644198 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.644198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:51:28.645197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B1381180>]}
[0m03:51:28.646196 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:51:28.648195 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:51:28.648195 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:51:28.649195 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:51:28.650195 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.651194 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:51:28.652193 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:51:28.659189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.660190 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.661187 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:51:28.666184 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.669183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.670183 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:51:28.671182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:28.738144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:51:28.739145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.739145 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:51:28.856075 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m03:51:28.860074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.860074 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:51:28.861073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.865071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.865071 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:51:28.866070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:28.870068 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:51:28.870068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.871067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:51:28.874919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:28.876935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:28.877919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:51:28.882688 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:28.884687 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.885686 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:51:28.886676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B11A0790>]}
[0m03:51:28.887675 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.24s]
[0m03:51:28.889673 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:51:28.889673 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:28.890673 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:51:28.892671 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:28.892671 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:28.893671 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:28.899682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:28.901666 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:28.902667 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:28.911671 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:28.913661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:28.913661 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:51:28.913661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.088553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:51:29.089564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:29.090552 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:51:29.107283 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:29.112279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:29.113279 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:51:29.114287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.122280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:29.122280 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:51:29.123272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.126268 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:51:29.126268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:29.127267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:51:29.129445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.131467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:29.132446 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:51:29.138496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:29.140513 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.140513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:51:29.141496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B13A4580>]}
[0m03:51:29.142496 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.25s]
[0m03:51:29.143808 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:29.144810 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:29.145809 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:51:29.146809 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:29.147811 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:29.148808 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:29.155812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:29.157496 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.157496 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:29.164495 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:29.166511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:29.166511 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:51:29.168492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.211953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:29.212949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:29.212949 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')[1,2]) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:51:29.213951 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «[»
LINE 12:     unnest(string_to_array(psg.genre, ', ')[1,2]) as genre
                                                    ^

[0m03:51:29.213951 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:51:29.214948 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.215947 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:51:29.216948 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «[»
  LINE 12:     unnest(string_to_array(psg.genre, ', ')[1,2]) as genre
                                                      ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:51:29.217948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14981F0>]}
[0m03:51:29.218948 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:51:29.220948 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:29.220948 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:29.221960 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:51:29.223946 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.223946 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:29.224944 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:29.228942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.229940 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.230950 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:29.237935 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.239934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.240933 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:51:29.240933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.289917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:29.290921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.290921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:51:29.304916 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:29.308927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.308927 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:51:29.309910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.312925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.313910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:51:29.314909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.317922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:51:29.317922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.318906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:51:29.320904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.322906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:29.323905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:51:29.329198 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:29.331185 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.332186 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:51:29.333184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B12D1F90>]}
[0m03:51:29.334185 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:51:29.336184 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:29.336184 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:51:29.337184 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:51:29.338198 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.339181 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:51:29.340181 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:51:29.345193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.346177 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.347178 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:51:29.360169 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.362168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.363167 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:51:29.363167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.412139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:29.413140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.413140 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:51:29.426235 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:29.430233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.430233 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:51:29.432234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.437229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.438228 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:51:29.439229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.442226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:51:29.442226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.443226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:51:29.445104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.448120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:29.449120 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:51:29.455102 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:29.457102 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.458101 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:51:29.459098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14B12A0>]}
[0m03:51:29.460097 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:51:29.462096 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:51:29.462096 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:29.463096 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:51:29.465096 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.466094 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:29.466094 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:51:29.476092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.477091 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.478087 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:29.490083 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.492080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.493078 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:51:29.493078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.544051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:29.544051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.545049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:51:29.558042 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:29.562040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.563038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:51:29.564039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.568038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.568038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:51:29.570035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.573033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:51:29.574032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.574032 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:51:29.576031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.580030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:29.580030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:51:29.586025 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:29.589023 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.589023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:51:29.590023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14B11B0>]}
[0m03:51:29.591023 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.13s]
[0m03:51:29.593022 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:29.594022 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:51:29.595020 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:51:29.596020 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.597021 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:51:29.598020 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:51:29.607016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.608013 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.609013 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:51:29.615010 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.617009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.619007 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:51:29.620007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.681971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:51:29.682971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.683970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:51:29.700961 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:29.706958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.706958 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:51:29.707957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.711955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.711955 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:51:29.713952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.717951 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:51:29.717951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.718951 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:51:29.720950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.722948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:29.723948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:51:29.731942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:29.733943 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.734941 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:51:29.735940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14B1240>]}
[0m03:51:29.736940 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.14s]
[0m03:51:29.738938 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:51:29.739938 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:51:29.740937 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:51:29.743936 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.744937 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:51:29.745935 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:51:29.751938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.753930 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.754930 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:51:29.763926 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.764923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.765922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:51:29.765922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.821892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:51:29.821892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.822890 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:51:29.833883 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:29.838882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.838882 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:51:29.839881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.842878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.843878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:51:29.844879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:29.847875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:51:29.848875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.848875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:51:29.850876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:29.853872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:29.854871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:51:29.859815 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:29.861815 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.862813 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:51:29.863812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B14B0FD0>]}
[0m03:51:29.864813 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:51:29.865812 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:51:29.866812 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:51:29.867811 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:51:29.868810 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.869810 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:51:29.870810 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:51:29.878804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.879805 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:29.880804 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:51:29.890798 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.891798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.892798 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:51:29.892798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:29.937771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:29.937771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.938771 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:51:29.982745 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.04 seconds
[0m03:51:29.987742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:29.988741 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:51:29.989742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:30.036714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:30.036714 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:51:30.037713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:30.041711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:51:30.041711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:30.042710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:51:30.043825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:30.046841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:30.046841 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:51:30.052049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:30.055045 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:30.055045 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:51:30.056059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '683c2663-94a0-4308-ba96-e5a4dbde0414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B1424040>]}
[0m03:51:30.057043 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.19s]
[0m03:51:30.059044 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:51:30.060043 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:51:30.060043 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:51:30.062041 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:51:30.063041 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:51:30.064039 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:51:30.066038 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:51:30.070036 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:51:30.071036 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:30.073036 [debug] [MainThread]: On master: BEGIN
[0m03:51:30.073036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:51:30.121006 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:51:30.121006 [debug] [MainThread]: On master: COMMIT
[0m03:51:30.122007 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:30.122007 [debug] [MainThread]: On master: COMMIT
[0m03:51:30.123005 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:51:30.123005 [debug] [MainThread]: On master: Close
[0m03:51:30.124005 [info ] [MainThread]: 
[0m03:51:30.125004 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m03:51:30.126004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:30.127003 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:51:30.127003 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:51:30.128003 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:51:30.141995 [info ] [MainThread]: 
[0m03:51:30.143994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:51:30.144994 [info ] [MainThread]: 
[0m03:51:30.145995 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:51:30.147991 [error] [MainThread]:   error de sintaxis en o cerca de «[»
[0m03:51:30.148991 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ')[1,2]) as genre
[0m03:51:30.149991 [error] [MainThread]:                                                       ^
[0m03:51:30.152988 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:51:30.153988 [info ] [MainThread]: 
[0m03:51:30.155988 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:51:30.157986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B116D840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B116D300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232B116E1A0>]}


============================== 2022-11-23 03:51:51.155598 | 5a87e019-c2f0-4e94-939a-7a47b76288cb ==============================
[0m03:51:51.155598 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:51:51.156503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:51:51.156503 [debug] [MainThread]: Tracking: tracking
[0m03:51:51.176365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656E0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656E09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656E07F0>]}
[0m03:51:51.268893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:51:51.268893 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:51:51.285868 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:51:51.308580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:51:51.322574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65881A50>]}
[0m03:51:51.333565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD657FFEE0>]}
[0m03:51:51.335577 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:51:51.336564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD657FFE50>]}
[0m03:51:51.341578 [info ] [MainThread]: 
[0m03:51:51.343561 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:51:51.346561 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:51.366549 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:51.366549 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:51.367547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:51.430353 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:51:51.433367 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:51.435351 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:51.439349 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:51.440348 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:51.440348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:51.495317 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:51:51.498315 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:51.500314 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:51:51.505312 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:51:51.506310 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:51:51.506310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:51.556281 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:51:51.558291 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:51:51.562278 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:51.572274 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:51.572274 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:51:51.573272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:51:51.619245 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:51:51.620245 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:51:51.620245 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:51:51.628240 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:51:51.631238 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:51:51.631238 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:51:51.632239 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:51.638234 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:51.638234 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:51:51.639234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:51.693203 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:51:51.694203 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:51:51.694203 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:51:51.706198 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:51:51.708195 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:51:51.709194 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:51:51.710195 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:51.713192 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:51.714191 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:51:51.714191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:51:51.761165 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:51:51.762164 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:51:51.762164 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:51:51.771158 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:51:51.774157 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:51:51.775156 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:51:51.786150 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:51.786150 [debug] [MainThread]: On master: BEGIN
[0m03:51:51.787150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:51:51.827128 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:51:51.827128 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:51.828126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:51:51.866104 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:51:51.868105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65835150>]}
[0m03:51:51.869105 [debug] [MainThread]: On master: ROLLBACK
[0m03:51:51.870102 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:51.870102 [debug] [MainThread]: On master: BEGIN
[0m03:51:51.871103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:51:51.871103 [debug] [MainThread]: On master: COMMIT
[0m03:51:51.872100 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:51.872100 [debug] [MainThread]: On master: COMMIT
[0m03:51:51.873116 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:51:51.873116 [debug] [MainThread]: On master: Close
[0m03:51:51.874101 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:51:51.875099 [info ] [MainThread]: 
[0m03:51:51.886109 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:51:51.887093 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:51:51.890091 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:51.891102 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:51:51.891102 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:51:51.896102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:51:51.897089 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:51.897089 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:51:51.955074 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:51:51.956074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:51.957073 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:51:51.957073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:51:51.996047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:51.997050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:51.998029 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:51:52.028464 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.03 seconds
[0m03:51:52.036444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:52.037444 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:51:52.038443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.043441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:52.043441 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:51:52.044439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.073444 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:51:52.074443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:52.074443 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:51:52.076696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.081710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:51:52.082710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:51:52.087663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:52.089685 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.089685 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:51:52.090666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65914BB0>]}
[0m03:51:52.091663 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.20s]
[0m03:51:52.093077 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:51:52.094079 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:51:52.095079 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:51:52.096099 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.097099 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:51:52.098077 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:51:52.105074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.107076 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.107076 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:51:52.113089 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.114067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.115067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:51:52.116066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.162051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:52.163057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.164039 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:51:52.176465 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:51:52.182465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.183465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:51:52.184462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.189458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.189458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:51:52.191459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.194456 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:51:52.195455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.195455 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:51:52.197466 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.200452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:51:52.201451 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:51:52.205449 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:52.207450 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.208450 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:51:52.209446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658E57B0>]}
[0m03:51:52.210446 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:51:52.212445 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:51:52.213446 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:51:52.214444 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:51:52.215454 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.216446 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:51:52.217443 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:51:52.227447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:51:52.229435 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.229435 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:51:52.237431 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:51:52.239430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.239430 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:51:52.240431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.286405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:52.287402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.287402 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:51:52.305326 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:52.309325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.310324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:51:52.311323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.316321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.317320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:51:52.318320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.322317 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:51:52.322317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.323317 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:51:52.325347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.328349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:51:52.328349 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:51:52.334921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:52.336921 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.337919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:51:52.338918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD659C1180>]}
[0m03:51:52.339919 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:51:52.341917 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:51:52.342916 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:51:52.343916 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:51:52.345918 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.345918 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:51:52.346915 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:51:52.357909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.359909 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.359909 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:51:52.365903 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.366903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.367903 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:51:52.368915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.412880 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:51:52.412880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.413876 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:51:52.517411 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:51:52.520410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.521409 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:51:52.522409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.525407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.525407 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:51:52.526407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.529405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:51:52.530404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.530404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:51:52.533257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.536261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:51:52.536261 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:51:52.542552 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:52.543552 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.544551 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:51:52.545550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65811690>]}
[0m03:51:52.546550 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:51:52.548549 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:51:52.548549 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:52.549548 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:51:52.551547 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.551547 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:52.552547 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:52.559542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.560920 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.560920 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:52.566918 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.569917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.570917 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:51:52.570917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.618891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:51:52.618891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.619889 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:51:52.631882 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:52.636879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.637878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:51:52.638878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.643875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.643875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:51:52.644874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.648873 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:51:52.649872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.649872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:51:52.651940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.653942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:51:52.654941 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:51:52.659912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:51:52.661912 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.662910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:51:52.663910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD659E45B0>]}
[0m03:51:52.664910 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:51:52.667909 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:51:52.668908 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:52.669907 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:51:52.676903 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:52.676903 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:52.677903 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:52.692894 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:52.694892 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.695892 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:52.707885 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:52.709884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:52.710884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:51:52.710884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.810826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m03:51:52.811826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:51:52.811826 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')[1]) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:51:52.812825 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «[»
LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
                                                    ^

[0m03:51:52.813825 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:51:52.814823 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.815823 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:51:52.816823 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «[»
  LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
                                                      ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:51:52.817823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658D1840>]}
[0m03:51:52.818822 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.14s]
[0m03:51:52.820820 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:51:52.820820 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:52.821820 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:51:52.823819 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.824820 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:52.825818 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:52.833813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.834813 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:52.835812 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:52.846806 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.847806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.848805 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:51:52.848805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:52.946749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.1 seconds
[0m03:51:52.947748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.948747 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:51:52.968736 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:52.973733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.974732 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:51:52.975732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.981728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.981728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:51:52.983727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:52.987725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:51:52.988724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.989724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:51:52.991723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:52.996720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:51:52.997719 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:51:53.005715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:53.007713 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.008713 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:51:53.009712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656E1570>]}
[0m03:51:53.010711 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.19s]
[0m03:51:53.012710 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:51:53.013710 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:51:53.013710 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:51:53.015709 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.016709 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:51:53.016709 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:51:53.023704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.024704 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.025704 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:51:53.037697 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.039695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.039695 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:51:53.040694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:53.281557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.24 seconds
[0m03:51:53.281557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.282556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:51:53.298547 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:53.304544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.305543 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:51:53.306543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.311540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.312540 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:51:53.313538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.318536 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:51:53.319535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.320534 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:51:53.322534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:53.327531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:51:53.328530 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:51:53.336525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:53.339524 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.339524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:51:53.340523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658E5270>]}
[0m03:51:53.341523 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.32s]
[0m03:51:53.343522 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:51:53.344521 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:53.345520 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:51:53.346520 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.347520 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:53.348519 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:51:53.356514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.357514 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.358513 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:53.368508 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.370507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.410483 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:51:53.432471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:53.591380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.16 seconds
[0m03:51:53.592380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.592380 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:51:53.608370 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:53.614367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.615366 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:51:53.616366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.622363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.623362 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:51:53.624361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.628358 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:51:53.629358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.630357 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:51:53.631357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:53.636354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:51:53.637354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:51:53.645349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:53.647348 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.648347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:51:53.649347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658E51B0>]}
[0m03:51:53.650346 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.30s]
[0m03:51:53.652345 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:51:53.652345 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:51:53.653345 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:51:53.655343 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.655343 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:51:53.656343 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:51:53.663339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.665338 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.666337 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:51:53.676331 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.678330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.694322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:51:53.710312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:53.884212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:51:53.885212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.886211 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:51:53.902202 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:51:53.912197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.913197 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:51:53.914196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.921191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.922191 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:51:53.924190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:53.928189 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:51:53.929186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.930186 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:51:53.932186 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:53.938182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:51:53.939181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:51:53.947178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:53.949176 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.950175 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:51:53.951174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658E50C0>]}
[0m03:51:53.953174 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.30s]
[0m03:51:53.955172 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:51:53.956171 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:51:53.956171 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:51:53.958171 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:53.959171 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:51:53.960170 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:51:53.969164 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:51:53.970163 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:53.971163 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:51:53.980157 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:51:53.982156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:53.982156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:51:53.983156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:54.040123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:51:54.040123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:54.041123 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:51:54.056114 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:51:54.061112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:54.061112 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:51:54.062111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:54.067111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:54.068108 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:51:54.069108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:54.074105 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:51:54.074105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:54.075104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:51:54.077103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:54.082100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:51:54.083099 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:51:54.090095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:54.092094 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:54.093093 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:51:54.094093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD658E4FD0>]}
[0m03:51:54.095093 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.14s]
[0m03:51:54.098091 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:51:54.099090 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:51:54.100089 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:51:54.102089 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.103088 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:51:54.104088 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:51:54.118079 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.121078 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:54.122077 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:51:54.135071 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.138068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.139067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:51:54.140067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:51:54.198033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:51:54.198033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.199033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:51:54.288981 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.09 seconds
[0m03:51:54.296976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.297976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:51:54.298975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:54.362939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.363938 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:51:54.364938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:51:54.369934 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:51:54.370934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.371934 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:51:54.374933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:51:54.378930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:51:54.379930 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:51:54.388925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:51:54.391924 [debug] [Thread-1 (]: finished collecting timing info
[0m03:51:54.392922 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:51:54.393922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a87e019-c2f0-4e94-939a-7a47b76288cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD65A64040>]}
[0m03:51:54.395920 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.29s]
[0m03:51:54.397920 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:51:54.398919 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:51:54.399918 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:51:54.401917 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:51:54.403916 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:51:54.404915 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:51:54.406913 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:51:54.409912 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:51:54.410911 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:54.410911 [debug] [MainThread]: On master: BEGIN
[0m03:51:54.411911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:51:54.467882 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:51:54.468893 [debug] [MainThread]: On master: COMMIT
[0m03:51:54.469878 [debug] [MainThread]: Using postgres connection "master"
[0m03:51:54.470877 [debug] [MainThread]: On master: COMMIT
[0m03:51:54.470877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:51:54.471878 [debug] [MainThread]: On master: Close
[0m03:51:54.472878 [info ] [MainThread]: 
[0m03:51:54.473878 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m03:51:54.475874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:51:54.475874 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:51:54.476874 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:51:54.477873 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:51:54.497861 [info ] [MainThread]: 
[0m03:51:54.498861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:51:54.502860 [info ] [MainThread]: 
[0m03:51:54.504858 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:51:54.507857 [error] [MainThread]:   error de sintaxis en o cerca de «[»
[0m03:51:54.509855 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
[0m03:51:54.510854 [error] [MainThread]:                                                       ^
[0m03:51:54.511854 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:51:54.513853 [info ] [MainThread]: 
[0m03:51:54.514852 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:51:54.515851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656AD7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656AD330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD656AE200>]}


============================== 2022-11-23 03:54:10.624743 | a51f9948-1f7f-4615-9d31-9ca8d0af8acb ==============================
[0m03:54:10.624743 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:54:10.625869 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:54:10.625869 [debug] [MainThread]: Tracking: tracking
[0m03:54:10.643129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A4330730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A43309D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A43307F0>]}
[0m03:54:10.766856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:54:10.767842 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\datawarehouse\fact_publication.sql
[0m03:54:10.781831 [debug] [MainThread]: 1699: static parser successfully parsed datawarehouse\fact_publication.sql
[0m03:54:10.806833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:54:10.819827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A44D1A50>]}
[0m03:54:10.832805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A445BAC0>]}
[0m03:54:10.833802 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:54:10.835814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A42FA770>]}
[0m03:54:10.840798 [info ] [MainThread]: 
[0m03:54:10.842799 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:54:10.845795 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:10.862789 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:10.863797 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:10.864785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:10.921752 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:54:10.923752 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:10.925750 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:10.928748 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:10.928748 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:10.929748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:10.971725 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:54:10.974722 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:10.975721 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:10.978720 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:10.979719 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:10.979719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:11.022694 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:54:11.025692 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:11.028691 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:11.036686 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:11.036686 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:54:11.037687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:11.081662 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:54:11.082661 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:11.083659 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:54:11.092654 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:54:11.095652 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:54:11.095652 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:54:11.097651 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:11.100650 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:11.100650 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:54:11.101649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:11.147622 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:54:11.148623 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:11.149621 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:54:11.157618 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:54:11.160616 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:54:11.161615 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:54:11.162614 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:11.167612 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:11.168610 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:54:11.168610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:11.220581 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:54:11.220581 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:11.221581 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:54:11.233574 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:54:11.236572 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:54:11.237571 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:54:11.248566 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:11.249565 [debug] [MainThread]: On master: BEGIN
[0m03:54:11.250564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:54:11.303533 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:54:11.304533 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:11.305533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:54:11.364498 [debug] [MainThread]: SQL status: SELECT 0 in 0.06 seconds
[0m03:54:11.366499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A4484490>]}
[0m03:54:11.366499 [debug] [MainThread]: On master: ROLLBACK
[0m03:54:11.367497 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:11.368498 [debug] [MainThread]: On master: BEGIN
[0m03:54:11.369497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:54:11.369497 [debug] [MainThread]: On master: COMMIT
[0m03:54:11.370495 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:11.370495 [debug] [MainThread]: On master: COMMIT
[0m03:54:11.371495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:54:11.372495 [debug] [MainThread]: On master: Close
[0m03:54:11.373495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:54:11.374493 [info ] [MainThread]: 
[0m03:54:11.392483 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:54:11.393482 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:54:11.395482 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.395482 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:54:11.396480 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:54:11.402481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.404477 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.405476 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:54:11.477434 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.479434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.479434 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:54:11.480432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:54:11.522411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:11.523408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.523408 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:54:11.537757 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:54:11.545751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.545751 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:54:11.546750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.551749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.551749 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:54:11.552749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.580731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:54:11.581731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.581731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:54:11.583731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:11.590725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:11.590725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:54:11.595733 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:11.596722 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.597721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:54:11.598720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A4564BB0>]}
[0m03:54:11.599720 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.20s]
[0m03:54:11.601722 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:54:11.602719 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:54:11.602719 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:54:11.604717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.604717 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:54:11.605717 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:54:11.611714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.613715 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.613715 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:54:11.623709 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.624708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.625707 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:54:11.625707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:11.666681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:11.667684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.668681 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:54:11.682674 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:54:11.688670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.689669 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:54:11.691669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.697679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.697679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:54:11.699663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.703664 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:54:11.704660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.704660 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:54:11.706790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:11.709791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:11.709791 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:54:11.714040 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:11.716028 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.717027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:54:11.718026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A45357B0>]}
[0m03:54:11.719026 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.11s]
[0m03:54:11.721025 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:54:11.722024 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:54:11.724024 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:54:11.727022 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.728024 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:54:11.729023 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:54:11.735017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:54:11.737016 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.739015 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:54:11.745012 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:54:11.746010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.747012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:54:11.747012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:11.791984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:11.792987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.792987 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:54:11.814834 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:54:11.819831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.819831 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:54:11.820831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.827827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.827827 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:54:11.828825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:11.832824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:54:11.832824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.832824 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:54:11.836367 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:11.839370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:11.839370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:54:11.845039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:11.847038 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.848037 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:54:11.849036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A460CFD0>]}
[0m03:54:11.850036 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:54:11.852034 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:54:11.853033 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:54:11.853033 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:54:11.855033 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:11.855033 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:54:11.856032 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:54:11.861028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:54:11.863027 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:11.864027 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:54:11.872028 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:54:11.874023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:11.874023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:54:11.875022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:11.919995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:11.920995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:11.920995 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:54:12.020765 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:54:12.024762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:12.024762 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:54:12.025762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.028760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:12.029760 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:54:12.030759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.033757 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:54:12.034757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:12.034757 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:54:12.037459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.040460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:12.040460 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:54:12.046495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.048499 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.049498 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:54:12.050496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A44620E0>]}
[0m03:54:12.051495 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:54:12.052497 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:54:12.053494 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:12.054509 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:54:12.055493 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.056492 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:12.056492 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:12.062500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.064487 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.064487 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:12.074484 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.076483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.077480 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:54:12.077480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.123455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:12.123455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.124453 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:54:12.137406 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:12.140404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.141403 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:54:12.142405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.147400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.148400 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:54:12.149400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.152398 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:54:12.153396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.153396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:54:12.155444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.157446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:12.158445 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:54:12.164703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.166699 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.166699 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:54:12.167698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A46345B0>]}
[0m03:54:12.168698 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:54:12.170697 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:12.170697 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:12.171697 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:54:12.172697 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:12.173695 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:12.174695 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:12.180706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:12.181689 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.181689 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:12.191687 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:12.193683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:12.193683 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:54:12.194682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.241657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:12.241657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:12.242655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')[1]) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:54:12.243655 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «[»
LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
                                                    ^

[0m03:54:12.243655 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:54:12.244654 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.244654 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:54:12.245653 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «[»
  LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
                                                      ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:54:12.246652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A451E980>]}
[0m03:54:12.247653 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.07s]
[0m03:54:12.248652 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:12.249651 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:12.250651 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:54:12.252649 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.252649 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:12.253649 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:12.257646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.258646 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.259646 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:12.264642 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.266642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.266642 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:54:12.266642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.313618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:12.313618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.314614 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:54:12.327976 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:12.332974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.332974 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:54:12.334973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.338971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.339970 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:54:12.340969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.343968 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:54:12.344966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.344966 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:54:12.347967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.350963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:12.351962 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:54:12.358088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.360085 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.360085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:54:12.361085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A44A3EE0>]}
[0m03:54:12.362084 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:54:12.364084 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:12.364084 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:54:12.365083 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:54:12.366082 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.367081 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:54:12.367081 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:54:12.374078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.375079 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.376077 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:54:12.385071 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.387070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.388070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:54:12.389078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.432046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:12.433044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.433044 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:54:12.446036 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:12.450034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.451034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:54:12.452033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.456031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.456031 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:54:12.457030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.461027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:54:12.461027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.462027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:54:12.464026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.467025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:12.467025 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:54:12.473424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.475436 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.475436 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:54:12.476421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A4535270>]}
[0m03:54:12.477421 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:54:12.479418 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:54:12.480417 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:12.480417 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:54:12.482416 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.483416 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:12.485415 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:54:12.491413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.492412 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.493412 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:12.500407 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.503404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.504404 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:54:12.504404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.561373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:54:12.561373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.562371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:54:12.575363 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:12.578364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.579363 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:54:12.580360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.585358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.586356 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:54:12.587358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.590354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:54:12.591354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.591354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:54:12.593356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.596353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:12.596353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:54:12.603349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.605346 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.605346 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:54:12.606348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A45351B0>]}
[0m03:54:12.607345 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:54:12.609343 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:12.610345 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:54:12.611345 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:54:12.612342 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.613341 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:54:12.614341 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:54:12.623337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.625334 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.625334 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:54:12.631330 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.633330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.635329 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:54:12.636329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.699294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:54:12.699294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.700293 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:54:12.726277 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:54:12.735273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.736272 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:54:12.737270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.744268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.745267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:54:12.746266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.752262 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:54:12.753261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.754261 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:54:12.756261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.761257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:12.762256 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:54:12.771251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.773249 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.774249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:54:12.776249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A45350C0>]}
[0m03:54:12.777247 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.16s]
[0m03:54:12.779246 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:54:12.779246 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:54:12.780247 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:54:12.781245 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.782245 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:54:12.783245 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:54:12.792240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.794238 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.795237 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:54:12.803236 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.805231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.806233 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:54:12.807230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:12.862199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:12.863199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.863199 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:54:12.877191 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:12.883186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.884186 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:54:12.885186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.889185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.889185 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:54:12.890184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:12.894181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:54:12.895180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.896179 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:54:12.898178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:12.902177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:12.902177 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:54:12.909172 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:12.912171 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.913169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:54:12.914170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A4534FD0>]}
[0m03:54:12.915170 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:54:12.917168 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:54:12.918167 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:54:12.919166 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:54:12.921165 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:12.921165 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:54:12.922165 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:54:12.934158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:54:12.935158 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:12.936157 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:54:12.943152 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:54:12.944152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:12.945151 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:54:12.945151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:13.120127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:54:13.121127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:13.122126 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:54:13.224067 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.1 seconds
[0m03:54:13.233062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:13.234063 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:54:13.235061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:13.297026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:13.298025 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:54:13.299024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:13.303023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:54:13.303023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:13.304022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:54:13.309992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:54:13.312994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:13.312994 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:54:13.319990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:13.320991 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:13.321990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:54:13.322989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a51f9948-1f7f-4615-9d31-9ca8d0af8acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A46B4040>]}
[0m03:54:13.323987 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.40s]
[0m03:54:13.324987 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:54:13.325987 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:54:13.326985 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:54:13.327988 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:54:13.328984 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:54:13.329986 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:54:13.332983 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:54:13.335983 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:54:13.336979 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:13.337979 [debug] [MainThread]: On master: BEGIN
[0m03:54:13.337979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:54:13.391951 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:54:13.392949 [debug] [MainThread]: On master: COMMIT
[0m03:54:13.392949 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:13.393948 [debug] [MainThread]: On master: COMMIT
[0m03:54:13.394947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:54:13.394947 [debug] [MainThread]: On master: Close
[0m03:54:13.396945 [info ] [MainThread]: 
[0m03:54:13.397944 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m03:54:13.399943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:13.400943 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:54:13.401943 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:54:13.402949 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:54:13.422931 [info ] [MainThread]: 
[0m03:54:13.424935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:54:13.426929 [info ] [MainThread]: 
[0m03:54:13.428927 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:54:13.429928 [error] [MainThread]:   error de sintaxis en o cerca de «[»
[0m03:54:13.430927 [error] [MainThread]:   LINE 12:     unnest(string_to_array(psg.genre, ', ')[1]) as genre
[0m03:54:13.432924 [error] [MainThread]:                                                       ^
[0m03:54:13.433925 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:54:13.435931 [info ] [MainThread]: 
[0m03:54:13.437923 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:54:13.439922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A42FD300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A42FD540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212A42FE260>]}


============================== 2022-11-23 03:54:34.570565 | 76a2777f-66e5-49bd-b959-4efc08fe35f2 ==============================
[0m03:54:34.570565 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:54:34.571536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:54:34.571536 [debug] [MainThread]: Tracking: tracking
[0m03:54:34.585530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B9AC520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B9ACA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B9AC7F0>]}
[0m03:54:34.737444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:54:34.738443 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:54:34.796411 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:54:34.849381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:54:34.866370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BB51A80>]}
[0m03:54:34.890357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BACBF10>]}
[0m03:54:34.891357 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:54:34.892356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BACBE80>]}
[0m03:54:34.896354 [info ] [MainThread]: 
[0m03:54:34.898352 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:54:34.903350 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:34.923340 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:34.924338 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:34.924338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:34.981305 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:54:34.983305 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:34.985304 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:34.989300 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:34.990299 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:34.990299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:35.037274 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:54:35.039272 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:35.040271 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:54:35.043269 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:54:35.043269 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:54:35.044269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:35.084246 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:54:35.087244 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:54:35.090244 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:35.098238 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:35.099238 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:54:35.100236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:54:35.139216 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.140213 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:54:35.140213 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:54:35.147212 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:54:35.149211 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:54:35.149211 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:54:35.151207 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:35.153207 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:35.154206 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:54:35.154206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:35.194185 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.195184 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:54:35.196182 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:54:35.204177 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:54:35.206176 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:54:35.206176 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:54:35.208175 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:35.212173 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:35.213171 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:54:35.213171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:54:35.253152 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.254149 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:54:35.254149 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:54:35.262144 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:54:35.264159 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:54:35.265144 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:54:35.272153 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:35.272153 [debug] [MainThread]: On master: BEGIN
[0m03:54:35.273137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:54:35.312120 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.313126 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:35.313126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:54:35.351092 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:54:35.353092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BB06A10>]}
[0m03:54:35.354092 [debug] [MainThread]: On master: ROLLBACK
[0m03:54:35.355090 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:35.355090 [debug] [MainThread]: On master: BEGIN
[0m03:54:35.356091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:54:35.356091 [debug] [MainThread]: On master: COMMIT
[0m03:54:35.357089 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:35.357089 [debug] [MainThread]: On master: COMMIT
[0m03:54:35.358092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:54:35.358092 [debug] [MainThread]: On master: Close
[0m03:54:35.359089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:54:35.361087 [info ] [MainThread]: 
[0m03:54:35.372081 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:54:35.373080 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:54:35.374096 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.375080 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:54:35.376079 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:54:35.380077 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.381076 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.381076 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:54:35.445039 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.447040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.448058 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:54:35.448058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:54:35.488017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.488017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.489015 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:54:35.503352 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:54:35.511368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.512347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:54:35.513347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.518346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.518346 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:54:35.519364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.550346 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:54:35.550346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.551337 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:54:35.553083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:35.559081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:54:35.560080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:54:35.564231 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:35.566243 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.566243 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:54:35.567231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BBE8BE0>]}
[0m03:54:35.568232 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.19s]
[0m03:54:35.570230 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:54:35.571230 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:54:35.572229 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:54:35.573228 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.574228 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:54:35.576227 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:54:35.581239 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.582239 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.583223 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:54:35.592218 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.593809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.593809 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:54:35.594811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:35.640928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:35.641941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.641941 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:54:35.654919 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:54:35.659914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.660917 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:54:35.661917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.667910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.669925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:54:35.670908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.674906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:54:35.674906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.675906 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:54:35.676905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:35.679903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:54:35.680902 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:54:35.685905 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:35.688898 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.689898 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:54:35.690897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BBB57B0>]}
[0m03:54:35.691898 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:54:35.693895 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:54:35.694896 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:54:35.695895 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:54:35.697894 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.698893 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:54:35.699893 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:54:35.711895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:54:35.713884 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.714883 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:54:35.726876 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:54:35.727875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.728877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:54:35.728877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:35.780846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:35.780846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.781846 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:54:35.800357 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:54:35.804356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.805356 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:54:35.806355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.811351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.812350 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:54:35.813352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:35.816348 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:54:35.817347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.817347 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:54:35.819347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:35.822345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:54:35.823344 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:54:35.827095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:35.829094 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.829094 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:54:35.830092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC91180>]}
[0m03:54:35.831093 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:54:35.833091 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:54:35.834090 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:54:35.835090 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:54:35.837089 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:35.838089 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:54:35.840091 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:54:35.847083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:54:35.848081 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:35.849081 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:54:35.857077 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:54:35.859077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:35.859077 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:54:35.860076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:35.904051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:35.905049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:35.905049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:54:36.006045 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:54:36.009044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:36.010043 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:54:36.011043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.014041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:36.014041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:54:36.015040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.018039 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:54:36.019039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:36.019039 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:54:36.027850 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:54:36.030866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:54:36.030866 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:54:36.035021 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:36.037019 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.038018 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:54:36.039015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC78730>]}
[0m03:54:36.040015 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:54:36.043013 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:54:36.044013 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:36.045012 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:54:36.047011 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.048010 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:36.049010 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:36.059004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.060003 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.061003 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:36.066999 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.069998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.070997 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:54:36.070997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.221911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:54:36.221911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.222910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:54:36.234903 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:36.238900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.239900 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:54:36.240899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.245896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.246896 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:54:36.247896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.251894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:54:36.251894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.252894 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:54:36.254891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.259889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:54:36.260888 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:54:36.265885 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:36.267884 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.268884 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:54:36.269883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BCAB790>]}
[0m03:54:36.270883 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.22s]
[0m03:54:36.272882 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:54:36.273883 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:36.274880 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:54:36.275881 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.276882 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:36.277879 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:36.283877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.285881 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.287873 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:36.299866 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.302874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.303864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:54:36.303864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.355835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:54:36.355835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.356833 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    unnest(string_to_array(psg.genre, ', ')) as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:54:36.373823 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:54:36.377821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.378822 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:54:36.379821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.383818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.383818 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:54:36.384818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.387816 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:54:36.388815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.388815 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:54:36.394205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.397208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:54:36.397208 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:54:36.402835 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:36.404835 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.405833 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:54:36.405833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BB985E0>]}
[0m03:54:36.406833 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 3706[0m in 0.13s]
[0m03:54:36.408832 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:54:36.409833 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:36.409833 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:54:36.410830 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.411833 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:36.411833 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:36.419827 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.421824 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.422832 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:36.430820 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.432821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.432821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:54:36.433818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.477791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:36.478792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.479792 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:54:36.493002 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:36.496999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.497999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:54:36.498999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.501998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.502996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:54:36.502996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.508993 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:54:36.509992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.509992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:54:36.512520 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.514521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:54:36.515520 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:54:36.519473 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:36.521460 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.522459 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:54:36.523461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BCEF490>]}
[0m03:54:36.524461 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:54:36.525459 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:54:36.526460 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:54:36.526460 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:54:36.528459 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.529456 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:54:36.530456 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:54:36.536451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.538451 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.539450 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:54:36.547460 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.548444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.548444 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:54:36.549445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.594419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:36.595418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.595418 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:54:36.606926 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:36.610924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.610924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:54:36.611925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.614922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.615921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:54:36.616921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.620919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:54:36.620919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.620919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:54:36.623622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.625623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:54:36.626622 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:54:36.630620 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:36.632620 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.633618 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:54:36.634618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BCCFD90>]}
[0m03:54:36.635617 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:54:36.636617 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:54:36.637617 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:36.638615 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:54:36.639615 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.640615 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:36.641614 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:54:36.646611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.647610 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.648609 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:36.655609 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.657606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.658603 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:54:36.658603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.716571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:54:36.717571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.718573 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:54:36.735560 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:54:36.742556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.742556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:54:36.744555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.748554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.748554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:54:36.750552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.756550 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:54:36.757548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.757548 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:54:36.759547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.766543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:54:36.766543 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:54:36.773540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:36.776537 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.776537 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:54:36.778536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BCBCEB0>]}
[0m03:54:36.779535 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.14s]
[0m03:54:36.781535 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:54:36.781535 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:54:36.782535 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:54:36.784533 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.785532 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:54:36.786532 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:54:36.792527 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.794527 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.795526 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:54:36.807518 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.809517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.810517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:54:36.810517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.872482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:54:36.873482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.873482 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:54:36.885384 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:36.889383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.890382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:54:36.891381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.894380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.895378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:54:36.896378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:36.900378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:54:36.900378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.901376 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:54:36.903375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:36.906373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:54:36.906373 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:54:36.911372 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:36.912372 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.913371 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:54:36.914368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC2FC40>]}
[0m03:54:36.915367 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.13s]
[0m03:54:36.916366 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:54:36.917368 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:54:36.918367 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:54:36.919365 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:36.920365 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:54:36.920365 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:54:36.927361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:54:36.928360 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:36.929359 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:54:36.936356 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:54:36.938356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:36.939355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:54:36.940353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:36.983328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:36.983328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:36.984328 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:54:36.997292 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:54:37.000289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:37.001288 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:54:37.002288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.006285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:37.007285 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:54:37.008284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.012282 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:54:37.012282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:37.013282 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:54:37.015001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:37.020002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:54:37.020002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:54:37.024354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:37.026353 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.026353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:54:37.027352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BD2CD00>]}
[0m03:54:37.028350 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:54:37.029350 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:54:37.030349 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:54:37.031348 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:54:37.032349 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.033348 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:54:37.033348 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:54:37.095314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.096311 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.097311 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:54:37.105306 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.107309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.107309 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:54:37.108304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:37.146285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:37.147284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.147284 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:54:37.192162 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.04 seconds
[0m03:54:37.197160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.197160 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:54:37.198160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.201157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.202156 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:54:37.203157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.206154 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:54:37.206154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.207154 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:54:37.212295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m03:54:37.215302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:54:37.216288 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:54:37.220284 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:54:37.222286 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.223283 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:54:37.223283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BD24E80>]}
[0m03:54:37.224285 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.19s]
[0m03:54:37.226281 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:54:37.227282 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:54:37.227282 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:54:37.229282 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.230280 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:54:37.231279 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:54:37.238277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.240277 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.241272 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:54:37.247286 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.249268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.249268 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:54:37.250267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:37.294259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:37.295241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.295241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:54:37.926117 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.63 seconds
[0m03:54:37.929116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.929116 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:54:37.930095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.933114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.934113 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:54:37.935092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:37.938110 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:54:37.939089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.939089 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:54:37.941387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:37.943418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:54:37.944398 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:54:37.951097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:37.953087 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.953087 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:54:37.954084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B90BA90>]}
[0m03:54:37.955083 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.72s]
[0m03:54:37.956743 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:54:37.957745 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:54:37.958759 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:54:37.960744 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:37.961743 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:54:37.962747 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:54:37.973738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:37.975696 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:37.975696 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:54:37.980717 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:37.982697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:37.982697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:54:37.983697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:54:38.028678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:54:38.028678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:38.029676 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    inner join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:54:38.047504 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.02 seconds
[0m03:54:38.051502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:38.052504 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:54:38.053501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:38.056519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:38.056519 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:54:38.057498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:54:38.060517 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:54:38.061497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:38.061497 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:54:38.064495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:54:38.066493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:54:38.067492 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:54:38.073095 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:54:38.075092 [debug] [Thread-1 (]: finished collecting timing info
[0m03:54:38.075092 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:54:38.076092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76a2777f-66e5-49bd-b959-4efc08fe35f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC4CCD0>]}
[0m03:54:38.077091 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 3706[0m in 0.12s]
[0m03:54:38.079091 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:54:38.081088 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:54:38.082108 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:38.083088 [debug] [MainThread]: On master: BEGIN
[0m03:54:38.083088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:54:38.128061 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:54:38.129061 [debug] [MainThread]: On master: COMMIT
[0m03:54:38.129061 [debug] [MainThread]: Using postgres connection "master"
[0m03:54:38.130060 [debug] [MainThread]: On master: COMMIT
[0m03:54:38.130060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:54:38.131062 [debug] [MainThread]: On master: Close
[0m03:54:38.132062 [info ] [MainThread]: 
[0m03:54:38.133062 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m03:54:38.134060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:54:38.136064 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:54:38.137057 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:54:38.138059 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:54:38.150050 [info ] [MainThread]: 
[0m03:54:38.151048 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:54:38.154047 [info ] [MainThread]: 
[0m03:54:38.156047 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:54:38.157046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC4D900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BC4D060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BCEDDB0>]}


============================== 2022-11-23 03:55:29.452592 | 1ae32bde-5c04-4dbd-945e-96f66a0b49a0 ==============================
[0m03:55:29.452592 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:55:29.453592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:55:29.454570 [debug] [MainThread]: Tracking: tracking
[0m03:55:29.472562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31D920520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31D920A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31D9207F0>]}
[0m03:55:29.586495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:55:29.587497 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:55:29.603485 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:55:29.631472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:55:29.644462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DABDA80>]}
[0m03:55:29.661452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA3BF10>]}
[0m03:55:29.662454 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:55:29.663454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA3BE80>]}
[0m03:55:29.667452 [info ] [MainThread]: 
[0m03:55:29.671447 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:55:29.679442 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:55:29.709427 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:55:29.710427 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:55:29.711424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:29.789379 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.08 seconds
[0m03:55:29.792377 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:55:29.793377 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:55:29.797376 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:55:29.797376 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:55:29.798374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:29.846347 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:55:29.848347 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:55:29.850346 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:55:29.853344 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:55:29.854343 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:55:29.855341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:29.892321 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:55:29.895319 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:55:29.898318 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:55:29.908313 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:55:29.909313 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:55:29.909313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:29.947289 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:55:29.947289 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:55:29.948290 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:55:29.956285 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:55:29.958283 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:55:29.958283 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:55:29.960282 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:55:29.962280 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:55:29.963280 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:55:29.963280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:30.001259 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:55:30.001259 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:55:30.002258 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:55:30.009253 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:55:30.011255 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:55:30.012252 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:55:30.013251 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:55:30.017248 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:55:30.018247 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:55:30.018247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:55:30.058229 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:55:30.058229 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:55:30.059225 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:55:30.066232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:55:30.068219 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:55:30.068219 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:55:30.075216 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:30.075216 [debug] [MainThread]: On master: BEGIN
[0m03:55:30.076226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:55:30.118191 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:55:30.119192 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:30.120192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:55:30.163182 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:55:30.165167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA75F30>]}
[0m03:55:30.166163 [debug] [MainThread]: On master: ROLLBACK
[0m03:55:30.166163 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:30.167180 [debug] [MainThread]: On master: BEGIN
[0m03:55:30.167180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:55:30.168163 [debug] [MainThread]: On master: COMMIT
[0m03:55:30.169162 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:30.169162 [debug] [MainThread]: On master: COMMIT
[0m03:55:30.170161 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:55:30.170161 [debug] [MainThread]: On master: Close
[0m03:55:30.171161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:55:30.172161 [info ] [MainThread]: 
[0m03:55:30.179157 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:55:30.180157 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:55:30.182155 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.183155 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:55:30.184155 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:55:30.190161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.192151 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.193148 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:55:30.274117 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.276101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.277100 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:55:30.277100 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:55:30.327071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:30.327071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.328072 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:55:30.341561 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:55:30.349556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.349556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:55:30.350556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.355554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.355554 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:55:30.357552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.392533 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:55:30.393533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.393533 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:55:30.395530 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:30.401527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:55:30.402526 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:55:30.406443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:30.408442 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.408442 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:55:30.409443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DC60BE0>]}
[0m03:55:30.410440 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.23s]
[0m03:55:30.413439 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:55:30.413439 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:55:30.414440 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:55:30.416439 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.416439 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:55:30.417437 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:55:30.424435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.425434 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.426433 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:55:30.432443 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.433427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.433427 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:55:30.434428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:30.493393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:55:30.493393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.494393 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:55:30.506386 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.01 seconds
[0m03:55:30.510383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.511382 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:55:30.512384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.515380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.516379 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:55:30.517381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.522377 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:55:30.522377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.523378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:55:30.525375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:30.528372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:55:30.528372 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:55:30.532527 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:30.534528 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.535525 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:55:30.535525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DC317B0>]}
[0m03:55:30.536525 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 15[0m in 0.12s]
[0m03:55:30.538524 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:55:30.538524 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:55:30.539524 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:55:30.541524 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.541524 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:55:30.542522 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:55:30.549518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:55:30.550518 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.550518 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:55:30.561511 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:55:30.562510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.563512 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:55:30.563512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:30.610482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:30.611482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.611482 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:55:30.627918 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:55:30.631917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.632916 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:55:30.633916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.638912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.639912 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:55:30.640913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.643909 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:55:30.644909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.644909 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:55:30.647299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:30.649299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:55:30.650298 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:55:30.655155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:30.657154 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.658153 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:55:30.659153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB01180>]}
[0m03:55:30.659153 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:55:30.661152 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:55:30.662151 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:55:30.662151 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:55:30.664152 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.664152 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:55:30.665150 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:55:30.675143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.677143 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.677143 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:55:30.691136 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.693134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.694133 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:55:30.694133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:30.764093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:55:30.765092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.765092 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:55:30.884391 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m03:55:30.888389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.888389 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:55:30.890388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.894386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.895385 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:55:30.896385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:30.901381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:55:30.902381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.902381 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:55:30.905379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:30.908379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:55:30.909378 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:55:30.915375 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:30.917373 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.918372 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:55:30.919371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA51A50>]}
[0m03:55:30.920371 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.26s]
[0m03:55:30.922370 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:55:30.923370 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:55:30.924368 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:55:30.929366 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:30.931367 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:55:30.932364 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:55:30.938361 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:30.941359 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:30.942359 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:55:30.948355 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:30.949355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:30.950354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:55:30.950354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.003324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:31.003324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:31.004324 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:55:31.014317 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.019315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:31.020313 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:55:31.021315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.026310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:31.026310 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:55:31.027309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.031307 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:55:31.032307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:31.032307 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:55:31.034306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.038304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:55:31.038304 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:55:31.044300 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:31.046299 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.047298 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:55:31.048299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB1B790>]}
[0m03:55:31.049298 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:55:31.051295 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:55:31.052297 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:55:31.053296 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:55:31.054295 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.055299 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:55:31.056294 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:55:31.062291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.063290 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.064288 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:55:31.077281 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.079282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.079282 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:55:31.080279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.134251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:31.135250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.136248 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    (string_to_array(psg.genre, ', '))[0] as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:55:31.153238 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:55:31.158235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.159234 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:55:31.160235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.164231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.165231 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:55:31.166230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.171227 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:55:31.172227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.172227 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:55:31.174228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.177224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:55:31.178223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:55:31.184222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:31.186219 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.187218 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:55:31.188219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB13A30>]}
[0m03:55:31.189218 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 2007[0m in 0.13s]
[0m03:55:31.190216 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:55:31.191217 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:55:31.192217 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:55:31.193216 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.194215 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:55:31.194215 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:55:31.200211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.202211 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.203209 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:55:31.212204 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.214203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.215203 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:55:31.215203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.261176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:31.261176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.262176 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:55:31.274169 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.278168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.278168 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:55:31.279166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.282163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.283163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:55:31.283163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.290159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:55:31.290159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.291158 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:55:31.293453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.295455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:55:31.296453 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:55:31.302405 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:31.304405 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.304405 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:55:31.305404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB5FDF0>]}
[0m03:55:31.306403 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.11s]
[0m03:55:31.308402 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:55:31.309404 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:55:31.310401 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:55:31.311401 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.312400 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:55:31.313399 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:55:31.323397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.325392 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.325392 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:55:31.331389 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.332389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.333388 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:55:31.333388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.377363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:55:31.377363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.378363 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:55:31.388846 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.392844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.393844 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:55:31.393844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.397841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.397841 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:55:31.398841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.402839 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:55:31.402839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.403838 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:55:31.405421 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.407425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:55:31.408421 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:55:31.413418 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:31.415417 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.416417 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:55:31.417416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB3FA60>]}
[0m03:55:31.417416 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:55:31.419415 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:55:31.420415 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:55:31.420415 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:55:31.422414 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.422414 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:55:31.423413 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:55:31.430410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.432408 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.432408 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:55:31.441402 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.443402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.444401 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:55:31.445400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.498374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:31.499370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.499370 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:55:31.511363 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.515361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.516360 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:55:31.517359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.522357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.523355 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:55:31.524355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.528354 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:55:31.529353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.530353 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:55:31.532351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.538347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:55:31.539346 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:55:31.546342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:31.549341 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.549341 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:55:31.550341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB2CEB0>]}
[0m03:55:31.552340 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.13s]
[0m03:55:31.554338 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:55:31.554338 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:55:31.555338 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:55:31.557339 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.558336 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:55:31.558336 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:55:31.564332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.566332 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.566332 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:55:31.580323 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.583322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.583322 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:55:31.584323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.733277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:55:31.734274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.735274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:55:31.745837 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.749852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.749852 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:55:31.750836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.753848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.754850 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:55:31.755848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.758845 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:55:31.759844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.759844 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:55:31.762278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.764295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:55:31.765279 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:55:31.771167 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:31.773185 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.774170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:55:31.774170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DCAA4A0>]}
[0m03:55:31.775168 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.22s]
[0m03:55:31.776603 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:55:31.777607 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:55:31.778608 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:55:31.779605 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.780605 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:55:31.780605 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:55:31.789600 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.791598 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.791598 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:55:31.797609 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.798610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.799594 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:55:31.800593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:31.874551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:55:31.875550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.875550 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:55:31.887472 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:55:31.891472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.892472 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:55:31.893470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.900467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.901464 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:55:31.902464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:31.905465 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:55:31.906463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.906463 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:55:31.909054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:31.913054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:55:31.913054 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:55:31.920051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:31.922049 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.922049 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:55:31.923048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB9CD00>]}
[0m03:55:31.924048 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.14s]
[0m03:55:31.925047 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:55:31.926047 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:55:31.927046 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:55:31.928046 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:31.929045 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:55:31.930045 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:55:31.994008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:55:31.995008 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:31.995008 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:55:32.001004 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.003003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.003003 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:55:32.004003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:32.041980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:55:32.041980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.042979 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:55:32.086954 [debug] [Thread-1 (]: SQL status: SELECT 3706 in 0.04 seconds
[0m03:55:32.089953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.090952 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:55:32.091952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.094950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.094950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:55:32.095949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.099948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:55:32.100946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.100946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:55:32.103910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:32.105911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:55:32.106909 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:55:32.111907 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:55:32.113918 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:32.114905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:55:32.115905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB943D0>]}
[0m03:55:32.116920 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 3706[0m in 0.19s]
[0m03:55:32.117905 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:55:32.118904 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:55:32.119903 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:55:32.120918 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.121903 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:55:32.121903 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:55:32.127913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.128913 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:32.129897 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:55:32.136894 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.137893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.138892 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:55:32.140891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:32.188864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:55:32.189863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.190862 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:55:32.443719 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.25 seconds
[0m03:55:32.447715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.448715 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:55:32.449731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.453712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.453712 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:55:32.454711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.457710 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:55:32.458709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.459708 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:55:32.460711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:32.464726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:55:32.465725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:55:32.471701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:32.473703 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:32.473703 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:55:32.474702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31D87BA90>]}
[0m03:55:32.475700 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 0[0m in 0.35s]
[0m03:55:32.477699 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:55:32.478698 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:55:32.479697 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:55:32.481696 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.482695 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:55:32.482695 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:55:32.492711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.493710 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:32.494689 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:55:32.499706 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.500687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.501684 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:55:32.503684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:32.548660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:55:32.549657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.549657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    inner join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:55:32.559653 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.01 seconds
[0m03:55:32.565648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.566648 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:55:32.567663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.571659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.571659 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:55:32.572646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:55:32.576656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:55:32.577640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.577640 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:55:32.579303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:55:32.581304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:55:32.582303 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:55:32.588311 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:55:32.590299 [debug] [Thread-1 (]: finished collecting timing info
[0m03:55:32.590299 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:55:32.591298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ae32bde-5c04-4dbd-945e-96f66a0b49a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA8F280>]}
[0m03:55:32.592300 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 0[0m in 0.11s]
[0m03:55:32.594297 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:55:32.595311 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:55:32.596298 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:32.596298 [debug] [MainThread]: On master: BEGIN
[0m03:55:32.597304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:55:32.646269 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:55:32.647266 [debug] [MainThread]: On master: COMMIT
[0m03:55:32.647266 [debug] [MainThread]: Using postgres connection "master"
[0m03:55:32.648281 [debug] [MainThread]: On master: COMMIT
[0m03:55:32.649267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:55:32.649267 [debug] [MainThread]: On master: Close
[0m03:55:32.650264 [info ] [MainThread]: 
[0m03:55:32.652264 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m03:55:32.654264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:32.654264 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:55:32.655262 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:55:32.656263 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:55:32.676251 [info ] [MainThread]: 
[0m03:55:32.677250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:55:32.681248 [info ] [MainThread]: 
[0m03:55:32.684246 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:55:32.693242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DA8F2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DB5D240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31DC8D060>]}


============================== 2022-11-23 03:56:04.551616 | a43ff9f4-261c-4b13-ae18-fea835351554 ==============================
[0m03:56:04.551616 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:56:04.552616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:56:04.553613 [debug] [MainThread]: Tracking: tracking
[0m03:56:04.569605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84980730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE849809D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE849807F0>]}
[0m03:56:04.661573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:04.662551 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:56:04.684538 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:56:04.726514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:56:04.741506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84B1DA50>]}
[0m03:56:04.761495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84A9FEE0>]}
[0m03:56:04.762494 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:56:04.766492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84A9FE50>]}
[0m03:56:04.776488 [info ] [MainThread]: 
[0m03:56:04.778486 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:04.781484 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:04.798474 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:04.798474 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:04.799473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:04.858440 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:56:04.860439 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:04.862437 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:04.865435 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:04.865435 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:04.866434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:04.907412 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:56:04.909411 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:04.910409 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:04.913409 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:04.913409 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:04.914407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:04.960381 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:56:04.963380 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:04.966378 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:04.979371 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:04.979371 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:56:04.980370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:05.036337 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:56:05.036337 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:05.037337 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:56:05.045334 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:56:05.048331 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:56:05.048331 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:56:05.050330 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:05.054327 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:05.055326 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:56:05.055326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:05.103301 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:56:05.104298 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:05.104298 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:56:05.112293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:56:05.115292 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:56:05.115292 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:56:05.117291 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:05.120291 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:05.120291 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:56:05.121289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:05.165265 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:56:05.166264 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:05.167262 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:56:05.175259 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:56:05.178256 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:56:05.179255 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:56:05.186251 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:05.187251 [debug] [MainThread]: On master: BEGIN
[0m03:56:05.187251 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:05.228231 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:56:05.228231 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:05.229227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:56:05.271202 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:56:05.273202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84AD63B0>]}
[0m03:56:05.274200 [debug] [MainThread]: On master: ROLLBACK
[0m03:56:05.275202 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:05.275202 [debug] [MainThread]: On master: BEGIN
[0m03:56:05.276200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:56:05.276200 [debug] [MainThread]: On master: COMMIT
[0m03:56:05.277200 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:05.277200 [debug] [MainThread]: On master: COMMIT
[0m03:56:05.278199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:05.278199 [debug] [MainThread]: On master: Close
[0m03:56:05.279198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:05.280198 [info ] [MainThread]: 
[0m03:56:05.288194 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:56:05.289193 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:56:05.291192 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.291192 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:56:05.292191 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:56:05.296188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.298188 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.298188 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:56:05.355169 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.356169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.356169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:56:05.357154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:56:05.394135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:05.395132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.395132 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:56:05.410470 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:56:05.418445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.418445 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:56:05.419445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.424442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.425441 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:56:05.426457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.452426 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:05.453458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.453458 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:05.455429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:05.461420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:05.461420 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:56:05.466295 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:05.468311 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.468311 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:56:05.469297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84CC0BB0>]}
[0m03:56:05.471294 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.18s]
[0m03:56:05.473293 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:56:05.474293 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:56:05.474293 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:56:05.476292 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.477294 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:56:05.478291 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:56:05.483309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.484289 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.485287 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:56:05.493302 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.495286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.495286 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:56:05.496280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:05.540254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:05.541265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.541265 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:56:05.552035 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m03:56:05.556030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.557030 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:56:05.558031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.562041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.562041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:56:05.563025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.568023 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:56:05.569023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.570022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:56:05.571524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:05.573540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:05.574524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:56:05.578253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:05.580255 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.580255 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:56:05.581239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C917B0>]}
[0m03:56:05.582239 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 1[0m in 0.10s]
[0m03:56:05.584237 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:56:05.584237 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:56:05.585237 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:56:05.586236 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.587236 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:56:05.588239 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:56:05.595245 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:05.596230 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.597230 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:56:05.606230 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:05.608226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.608226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:56:05.609225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:05.657196 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:05.658195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.659195 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:56:05.693175 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.03 seconds
[0m03:56:05.700171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.701171 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:56:05.702171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.712164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.713164 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:56:05.715163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:05.720161 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:05.721160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.722159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:05.724159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:05.729155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:05.729155 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:56:05.738150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:05.741148 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.742147 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:56:05.744147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84B61180>]}
[0m03:56:05.745146 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.16s]
[0m03:56:05.747145 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:56:05.748145 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:56:05.749144 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:56:05.751144 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:05.752141 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:56:05.753141 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:56:05.767135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:05.769132 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:05.770132 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:56:05.789121 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:05.791119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:05.792119 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:56:05.792119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:05.866076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.07 seconds
[0m03:56:05.867076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:05.867076 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:56:06.011009 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.14 seconds
[0m03:56:06.013993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:06.015008 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:56:06.015990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.018990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:06.019990 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:56:06.020988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.023986 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:06.024986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:06.024986 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:06.027673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.029674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:06.030675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:56:06.036957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:06.038968 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.038968 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:56:06.039953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84AB0550>]}
[0m03:56:06.040968 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.29s]
[0m03:56:06.043951 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:56:06.043951 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:06.044950 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:56:06.046949 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.047949 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:06.048948 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:06.057947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.058946 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.059942 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:06.065953 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.066941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.067937 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:56:06.068938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.115911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:06.116910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.116910 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:56:06.128257 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:06.132256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.133256 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:56:06.134254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.139251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.140250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:56:06.141251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.144249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:06.145248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.145248 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:06.147157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.150159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:06.150159 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:56:06.156153 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:06.158163 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.159152 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:56:06.160153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84B845B0>]}
[0m03:56:06.160153 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.11s]
[0m03:56:06.162152 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:06.163149 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:06.163149 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:56:06.165149 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:06.166149 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:06.167150 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:06.173155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:06.175156 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.175156 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:06.181154 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:06.182141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:06.183138 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:56:06.183138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.241106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:56:06.242105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:06.242105 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    (string_to_array(psg.genre, ', '))[0] as genre
    (string_to_array(psg.genre, ', '))[1] as genre
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:56:06.243105 [debug] [Thread-1 (]: Postgres adapter: Postgres error: error de sintaxis en o cerca de «(»
LINE 13:     (string_to_array(psg.genre, ', '))[1] as genre
             ^

[0m03:56:06.244104 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: ROLLBACK
[0m03:56:06.245103 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.245103 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:56:06.246102 [debug] [Thread-1 (]: Database Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)
  error de sintaxis en o cerca de «(»
  LINE 13:     (string_to_array(psg.genre, ', '))[1] as genre
               ^
  compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:56:06.247102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C7AE90>]}
[0m03:56:06.248101 [error] [Thread-1 (]: 6 of 14 ERROR creating table model SummerSong_staging.stg_publication_songgenres  [[31mERROR[0m in 0.08s]
[0m03:56:06.250100 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:06.251100 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:06.253098 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:56:06.255099 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.255099 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:06.256097 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:06.260095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.262094 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.262094 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:06.272088 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.274098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.275086 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:56:06.276086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.333054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:56:06.334052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.335051 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:56:06.350043 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:06.357038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.357038 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:56:06.358038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.364035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.365034 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:56:06.366033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.370033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:06.371032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.371032 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:06.373031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.376028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:06.377027 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:56:06.383024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:06.386022 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.387022 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:56:06.388022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84AD7460>]}
[0m03:56:06.389020 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.13s]
[0m03:56:06.391020 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:06.391020 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:06.392020 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:56:06.394018 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.394018 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:56:06.395017 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:56:06.402013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.403013 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.404012 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:56:06.416005 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.418004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.419005 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:56:06.420011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.474973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:06.474973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.475971 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:56:06.487963 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:06.491962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.492961 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:56:06.493961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.498958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.499958 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:56:06.499958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.503956 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:06.504955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.504955 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:06.506955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.510951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:06.511950 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:56:06.517948 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:06.520946 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.520946 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:56:06.522945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C91270>]}
[0m03:56:06.523944 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.13s]
[0m03:56:06.525943 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:06.526942 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:06.527941 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:56:06.529941 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.530940 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:06.530940 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:56:06.538937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.540934 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.541933 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:06.548930 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.550928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.550928 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:56:06.551928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.602899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:06.602899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.603899 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:56:06.613733 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:06.617730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.618730 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:56:06.619730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.624726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.624726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:56:06.625725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.628724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:06.629722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.629722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:06.631723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.634721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:06.635721 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:56:06.640997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:06.643005 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.643993 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:56:06.643993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C911B0>]}
[0m03:56:06.644994 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:56:06.646991 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:06.646991 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:06.647992 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:56:06.648990 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.650001 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:56:06.650991 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:56:06.658985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.660984 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.661983 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:56:06.674976 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.676974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.677973 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:56:06.677973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.831885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.15 seconds
[0m03:56:06.832886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.833886 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:56:06.850874 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:06.856871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.857871 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:56:06.858870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.862868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.862868 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:56:06.863867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.866866 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:06.867864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.867864 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:06.870342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.873343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:06.873343 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:56:06.878714 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:06.880712 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.881711 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:56:06.882711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C91210>]}
[0m03:56:06.883710 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.23s]
[0m03:56:06.885709 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:06.886710 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:56:06.887708 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:56:06.888707 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.889707 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:56:06.890707 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:56:06.895703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.897703 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.897703 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:56:06.905698 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.907697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.908697 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:56:06.908697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:06.954670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:06.955670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.956668 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:56:06.967091 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:06.971089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.971089 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:56:06.972089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.976086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.976086 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:56:06.977085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:06.981085 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:06.982083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.982083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:06.984040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:06.987041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:06.988041 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:56:06.993558 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:06.995556 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:06.995556 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:56:06.996557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C90FD0>]}
[0m03:56:06.997556 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:56:07.000555 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:56:07.000555 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:56:07.001554 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:56:07.003554 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.004553 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:56:07.005553 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:56:07.013547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.014547 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:07.015546 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:56:07.024540 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.025540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.026539 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:56:07.026539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:07.069517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:07.069517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.070514 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:56:07.093907 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.02 seconds
[0m03:56:07.099905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.100905 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:56:07.101905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:07.146879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.147878 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:56:07.148878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:07.151875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:56:07.151875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.152875 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:56:07.154090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:07.156092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:07.157091 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:56:07.161920 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:07.163920 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:07.164919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:56:07.165918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a43ff9f4-261c-4b13-ae18-fea835351554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE84C00040>]}
[0m03:56:07.165918 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 0[0m in 0.16s]
[0m03:56:07.167918 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:56:07.168918 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:07.168918 [info ] [Thread-1 (]: 13 of 14 SKIP relation SummerSong_staging.stg_genre_1 .......................... [[33mSKIP[0m]
[0m03:56:07.170917 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:07.171916 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:07.172915 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:56:07.174914 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:07.176912 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:07.177912 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:07.177912 [debug] [MainThread]: On master: BEGIN
[0m03:56:07.178911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:07.228883 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:56:07.228883 [debug] [MainThread]: On master: COMMIT
[0m03:56:07.229881 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:07.229881 [debug] [MainThread]: On master: COMMIT
[0m03:56:07.230881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:07.230881 [debug] [MainThread]: On master: Close
[0m03:56:07.231881 [info ] [MainThread]: 
[0m03:56:07.232880 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m03:56:07.234879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:07.235878 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:56:07.236878 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_datawarehouse' was properly closed.
[0m03:56:07.237877 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.fact_publication' was properly closed.
[0m03:56:07.250870 [info ] [MainThread]: 
[0m03:56:07.252874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:56:07.254867 [info ] [MainThread]: 
[0m03:56:07.255867 [error] [MainThread]: [33mDatabase Error in model stg_publication_songgenres (models\staging\publication\stg_publication_songgenres.sql)[0m
[0m03:56:07.258866 [error] [MainThread]:   error de sintaxis en o cerca de «(»
[0m03:56:07.260864 [error] [MainThread]:   LINE 13:     (string_to_array(psg.genre, ', '))[1] as genre
[0m03:56:07.261864 [error] [MainThread]:                ^
[0m03:56:07.262863 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\publication\stg_publication_songgenres.sql
[0m03:56:07.263862 [info ] [MainThread]: 
[0m03:56:07.265861 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=2 TOTAL=14
[0m03:56:07.266862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8494D7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8494D330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8494E200>]}


============================== 2022-11-23 03:56:29.781435 | 0b5c66b4-c63e-49d6-a354-b64b52db94fc ==============================
[0m03:56:29.781435 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:56:29.783435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:56:29.784434 [debug] [MainThread]: Tracking: tracking
[0m03:56:29.804422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D5EF6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D6109A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D610730>]}
[0m03:56:29.943342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:29.944342 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:56:29.973325 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:56:30.015301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:56:30.031293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D7ADA20>]}
[0m03:56:30.055280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D5DA770>]}
[0m03:56:30.056279 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:56:30.057279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D5EF6A0>]}
[0m03:56:30.063274 [info ] [MainThread]: 
[0m03:56:30.064274 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:30.079265 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:30.110248 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:30.111248 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:30.112247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:30.158220 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:56:30.160219 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:30.161218 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:30.164216 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:30.165215 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:30.165215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:30.206193 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:56:30.208193 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:30.209191 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:30.211191 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:30.212190 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:30.212190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:30.252167 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:56:30.255165 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:30.258164 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:30.265158 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:30.266158 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:56:30.266158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:30.437644 [debug] [ThreadPool]: SQL status: BEGIN in 0.17 seconds
[0m03:56:30.438659 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:30.438659 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:56:30.447688 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:56:30.449706 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:56:30.450685 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:56:30.451706 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:30.454704 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:30.454704 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:56:30.455685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:30.494198 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:56:30.495211 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:30.496194 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:56:30.505209 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:56:30.508187 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:56:30.508187 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:56:30.509186 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:30.512184 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:30.513184 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:56:30.513184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:30.551163 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:56:30.552162 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:30.553161 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:56:30.560157 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:56:30.562176 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:56:30.563157 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:56:30.569172 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:30.570172 [debug] [MainThread]: On master: BEGIN
[0m03:56:30.570172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:30.610131 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:56:30.611128 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:30.611128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:56:30.655119 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:56:30.657104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D765D50>]}
[0m03:56:30.657104 [debug] [MainThread]: On master: ROLLBACK
[0m03:56:30.658104 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:30.659100 [debug] [MainThread]: On master: BEGIN
[0m03:56:30.659100 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:56:30.660103 [debug] [MainThread]: On master: COMMIT
[0m03:56:30.660103 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:30.661099 [debug] [MainThread]: On master: COMMIT
[0m03:56:30.662100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:30.663099 [debug] [MainThread]: On master: Close
[0m03:56:30.664098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:30.667098 [info ] [MainThread]: 
[0m03:56:30.703079 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:56:30.705075 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:56:30.712071 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.713070 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:56:30.713070 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:56:30.723065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.725064 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:30.726063 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:56:30.835000 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.836999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.836999 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:56:30.838000 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:56:30.881975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:30.882973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.882973 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:56:30.900962 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:56:30.913955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.914954 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:56:30.915954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:30.921951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.921951 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:56:30.923952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:30.963926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:30.964926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.964926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:30.966924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:30.976919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:30.977920 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:56:30.982915 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:30.984915 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:30.985930 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:56:30.986913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D950B80>]}
[0m03:56:30.987913 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.28s]
[0m03:56:30.989912 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:56:30.990913 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:56:30.990913 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:56:30.992911 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:30.993910 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:56:30.994909 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:56:31.002909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.004904 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.005905 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:56:31.015897 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.016896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.017896 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:56:31.018896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.062869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:31.063872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.063872 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:56:31.073294 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m03:56:31.077291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.077291 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:56:31.078291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.081289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.082288 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:56:31.083288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.086287 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:56:31.087285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.087285 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:56:31.089316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.091321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:31.092320 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:56:31.096261 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.098260 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.099260 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:56:31.099260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D9217B0>]}
[0m03:56:31.100259 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 1[0m in 0.11s]
[0m03:56:31.102257 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:56:31.103257 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:56:31.103257 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:56:31.105257 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.106256 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:56:31.106256 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:56:31.113251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:31.114251 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.115250 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:56:31.127243 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:31.128243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.129243 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:56:31.129243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.171219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:31.171219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.172219 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:56:31.189467 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:31.193467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.193467 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:56:31.194466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.199463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.200462 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:56:31.201461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.204460 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:31.205459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.205459 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:31.207458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.210458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:31.211457 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:56:31.215442 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.217440 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.217440 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:56:31.219439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D7F1180>]}
[0m03:56:31.220439 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:56:31.221437 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:56:31.222439 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:56:31.222439 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:56:31.223436 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.224436 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:56:31.225436 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:56:31.235430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.237429 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.238428 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:56:31.246423 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.247424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.248421 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:56:31.248421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.293397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:31.293397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.294396 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:56:31.394529 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.1 seconds
[0m03:56:31.399513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.399513 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:56:31.400511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.404510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.404510 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:56:31.405508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.409506 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:31.409506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.410505 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:31.413505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.419499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:31.420501 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:56:31.424662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.426679 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.426679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:56:31.427662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D9C33D0>]}
[0m03:56:31.428662 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.20s]
[0m03:56:31.430661 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:56:31.431660 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:31.432659 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:56:31.434320 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.435325 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:31.435325 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:31.441319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.443318 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.444317 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:31.454312 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.456311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.457311 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:56:31.458314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.504327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:31.505327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.506326 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:56:31.522317 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:31.529313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.530312 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:56:31.531311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.542305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.542305 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:56:31.544305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.549301 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:31.550301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.551300 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:31.553300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.558296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:31.559295 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:56:31.565292 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.568291 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.569290 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:56:31.570289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D814580>]}
[0m03:56:31.571289 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.14s]
[0m03:56:31.573288 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:31.573288 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:31.574287 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:56:31.576286 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.577286 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:31.577286 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:31.586280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.588279 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.589280 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:31.600272 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.603282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.605295 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:56:31.606269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.670232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:56:31.670232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.671232 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    (string_to_array(psg.genre, ', '))[0] as genre_1,
    (string_to_array(psg.genre, ', '))[1] as genre_2
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:56:31.693220 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:31.700216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.701216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:56:31.702215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.709210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.710210 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:56:31.711209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.717206 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:56:31.718205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.719205 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:56:31.722204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.728201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:31.729198 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:56:31.737194 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:31.740193 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.741192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:56:31.742191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D921480>]}
[0m03:56:31.743191 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 2007[0m in 0.17s]
[0m03:56:31.746189 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:31.746189 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:31.747189 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:56:31.749188 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.750187 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:31.751187 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:31.761181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.763179 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.764178 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:31.775173 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.777171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.778170 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:56:31.778170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.834138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:56:31.835139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.836139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:56:31.850129 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:31.857125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.857125 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:56:31.858125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.861123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.862122 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:56:31.863123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.870120 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:31.871118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.871118 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:31.874116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.878113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:31.878113 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:56:31.882112 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.884112 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.885109 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:56:31.886110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D84F130>]}
[0m03:56:31.887110 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.14s]
[0m03:56:31.889108 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:31.889108 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:31.890107 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:56:31.892106 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.893106 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:56:31.894105 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:56:31.899102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.900101 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.901102 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:56:31.909095 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.910095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.911095 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:56:31.911095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:31.953072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:31.953072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.954070 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:56:31.963640 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:31.967637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.968637 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:56:31.969637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.972634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.973633 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:56:31.974633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:31.977632 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:31.978632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.978632 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:31.980867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:31.982868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:31.983867 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:56:31.987876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:31.989880 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:31.989880 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:56:31.990879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D9212A0>]}
[0m03:56:31.991863 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.10s]
[0m03:56:31.993862 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:31.994862 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:31.995861 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:56:31.997860 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:31.997860 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:31.998860 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:56:32.005858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.007854 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.007854 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:32.014852 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.015851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.016856 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:56:32.016856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:32.066820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:32.066820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.067821 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:56:32.081812 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:32.085812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.086810 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:56:32.087808 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.090806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.091806 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:56:32.092806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.097802 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:32.097802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.098802 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:32.100800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:32.107796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:32.108796 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:56:32.112793 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:32.114794 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.115793 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:56:32.116791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D9211B0>]}
[0m03:56:32.117791 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:56:32.119790 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:32.120790 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:32.121789 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:56:32.122788 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.123790 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:56:32.124788 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:56:32.130784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.131783 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.132783 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:56:32.144776 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.146774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.146774 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:56:32.147775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:32.195748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:32.196746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.197746 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:56:32.210739 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:32.216735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.216735 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:56:32.218734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.221733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.222731 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:56:32.223730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.227729 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:32.227729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.228728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:32.230727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:32.232726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:32.233725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:56:32.238723 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:32.240720 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.240720 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:56:32.241720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D9210C0>]}
[0m03:56:32.242720 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.12s]
[0m03:56:32.245718 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:32.246720 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:56:32.247717 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:56:32.249717 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.250716 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:56:32.250716 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:56:32.257713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.259710 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.259710 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:56:32.265708 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.267706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.267706 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:56:32.269710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:32.320675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:32.321675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.321675 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:56:32.333668 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:32.339664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.340663 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:56:32.341664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.344662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.345662 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:56:32.346660 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.350657 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:32.351657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.352658 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:32.354657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:32.358653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:32.359653 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:56:32.364650 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:32.366649 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.366649 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:56:32.367648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D921150>]}
[0m03:56:32.368648 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:56:32.370647 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:56:32.371646 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:56:32.371646 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:56:32.373645 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.374646 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:56:32.375644 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:56:32.440608 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.441606 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.441606 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:56:32.447604 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.449601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.449601 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:56:32.449601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:32.488150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:32.488150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.489146 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:56:32.515133 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.03 seconds
[0m03:56:32.519131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.519131 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:56:32.520128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.523141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.524127 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:56:32.524127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:32.527139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:56:32.527139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.528139 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:56:32.529711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:32.532728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:56:32.532728 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:56:32.535854 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:32.537865 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.538855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:56:32.539853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D886B60>]}
[0m03:56:32.540851 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 0[0m in 0.17s]
[0m03:56:32.542851 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:56:32.543850 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:32.544850 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:56:32.546848 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:32.547848 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:56:32.548847 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:56:32.559843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:32.560843 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.561839 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:56:32.569835 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:32.571834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:32.573834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:56:32.573834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:32.615808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:32.615808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:32.616807 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:56:32.617808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna spsg.genre
LINE 11:     spsg.genre as genre_1    
             ^
HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre_1» o la columna «spsg.genre_2».

[0m03:56:32.618807 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: ROLLBACK
[0m03:56:32.619807 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:32.619807 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:56:32.620806 [debug] [Thread-1 (]: Database Error in model stg_genre_1 (models\staging\genre\stg_genre_1.sql)
  no existe la columna spsg.genre
  LINE 11:     spsg.genre as genre_1    
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre_1» o la columna «spsg.genre_2».
  compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_1.sql
[0m03:56:32.621805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5c66b4-c63e-49d6-a354-b64b52db94fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D7F0070>]}
[0m03:56:32.621805 [error] [Thread-1 (]: 13 of 14 ERROR creating table model SummerSong_staging.stg_genre_1 ............. [[31mERROR[0m in 0.07s]
[0m03:56:32.623805 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:32.624804 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:32.624804 [info ] [Thread-1 (]: 14 of 14 SKIP relation SummerSong_staging.stg_genre_2 .......................... [[33mSKIP[0m]
[0m03:56:32.626803 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:32.628801 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:32.628801 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:32.629801 [debug] [MainThread]: On master: BEGIN
[0m03:56:32.629801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:32.688767 [debug] [MainThread]: SQL status: BEGIN in 0.06 seconds
[0m03:56:32.688767 [debug] [MainThread]: On master: COMMIT
[0m03:56:32.689768 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:32.689768 [debug] [MainThread]: On master: COMMIT
[0m03:56:32.690766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:32.690766 [debug] [MainThread]: On master: Close
[0m03:56:32.692766 [info ] [MainThread]: 
[0m03:56:32.694764 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m03:56:32.695764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:32.696762 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:56:32.697762 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:56:32.697762 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_1' was properly closed.
[0m03:56:32.721750 [info ] [MainThread]: 
[0m03:56:32.723748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:56:32.733741 [info ] [MainThread]: 
[0m03:56:32.741737 [error] [MainThread]: [33mDatabase Error in model stg_genre_1 (models\staging\genre\stg_genre_1.sql)[0m
[0m03:56:32.743736 [error] [MainThread]:   no existe la columna spsg.genre
[0m03:56:32.745735 [error] [MainThread]:   LINE 11:     spsg.genre as genre_1    
[0m03:56:32.747733 [error] [MainThread]:                ^
[0m03:56:32.749733 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «spsg.genre_1» o la columna «spsg.genre_2».
[0m03:56:32.753732 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\staging\genre\stg_genre_1.sql
[0m03:56:32.755729 [info ] [MainThread]: 
[0m03:56:32.757727 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 TOTAL=14
[0m03:56:32.762727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D5CD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D921930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002442D7F3CD0>]}


============================== 2022-11-23 03:56:52.460718 | 0b4f0cdc-08e8-4aa7-94c7-e88179e46b17 ==============================
[0m03:56:52.460718 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:56:52.461698 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:56:52.462697 [debug] [MainThread]: Tracking: tracking
[0m03:56:52.480686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF22CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF250970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF250700>]}
[0m03:56:52.575632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:56:52.576631 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:56:52.590645 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:56:52.615609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:56:52.625620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF3ED9F0>]}
[0m03:56:52.637599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF21A770>]}
[0m03:56:52.639597 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:56:52.640595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF22CE80>]}
[0m03:56:52.643596 [info ] [MainThread]: 
[0m03:56:52.645592 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:52.648592 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:52.663602 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:52.664602 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:52.665582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:52.752532 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.09 seconds
[0m03:56:52.755530 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:52.757529 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:52.761529 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:52.762526 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:52.762526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:52.812498 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.05 seconds
[0m03:56:52.815495 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:52.816495 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:56:52.819494 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:56:52.820493 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:56:52.820493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:52.865467 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:56:52.868466 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:56:52.872462 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:52.885455 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:52.885455 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:56:52.886455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:56:52.933429 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:56:52.934427 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:56:52.935427 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:56:52.942424 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:56:52.944422 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:56:52.945420 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:56:52.946420 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:52.949419 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:52.950418 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:56:52.950418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:52.997392 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:56:52.998391 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:56:52.998391 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:56:53.006387 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:56:53.008384 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:56:53.009384 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:56:53.010384 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:53.014381 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:53.015381 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:56:53.015381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:56:53.064354 [debug] [ThreadPool]: SQL status: BEGIN in 0.05 seconds
[0m03:56:53.065353 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:56:53.065353 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:56:53.073348 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:56:53.075346 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:56:53.076346 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:56:53.087340 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:53.087340 [debug] [MainThread]: On master: BEGIN
[0m03:56:53.088339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:56:53.133315 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:56:53.134314 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:53.135312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:56:53.179288 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:56:53.181286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF3A4CD0>]}
[0m03:56:53.182285 [debug] [MainThread]: On master: ROLLBACK
[0m03:56:53.182285 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:53.183284 [debug] [MainThread]: On master: BEGIN
[0m03:56:53.183284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:56:53.184284 [debug] [MainThread]: On master: COMMIT
[0m03:56:53.184284 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:53.185285 [debug] [MainThread]: On master: COMMIT
[0m03:56:53.185285 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:53.186284 [debug] [MainThread]: On master: Close
[0m03:56:53.187282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:56:53.188283 [info ] [MainThread]: 
[0m03:56:53.196279 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:56:53.197277 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:56:53.198276 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.199278 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:56:53.199278 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:56:53.207274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.208272 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.209270 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:56:53.266237 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.267237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.268236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:56:53.269236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:56:53.306215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:53.306215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.307214 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:56:53.321059 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.01 seconds
[0m03:56:53.329054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.329054 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:56:53.330053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.335051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.335051 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:56:53.336050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.374028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:53.375028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.375028 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:56:53.376991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:53.383992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:56:53.384989 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:56:53.388831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:53.390834 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.390834 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:56:53.391819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF590B50>]}
[0m03:56:53.392817 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.19s]
[0m03:56:53.395816 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:56:53.395816 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:56:53.396814 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:56:53.398814 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:53.399814 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:56:53.400812 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:56:53.407826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:53.409681 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.409681 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:56:53.414681 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:56:53.415680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:53.416682 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:56:53.416682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:53.464045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:53.465045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:56:53.465045 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:56:53.467043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: no existe la columna spg1.genre
LINE 10:     spg1.genre
             ^
HINT:  Probablemente quiera hacer referencia a la columna «spg1.genre_1» o la columna «spg1.genre_2».

[0m03:56:53.467043 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: ROLLBACK
[0m03:56:53.468040 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.469039 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:56:53.470049 [debug] [Thread-1 (]: Database Error in model dim_genre (models\datawarehouse\dim_genre.sql)
  no existe la columna spg1.genre
  LINE 10:     spg1.genre
               ^
  HINT:  Probablemente quiera hacer referencia a la columna «spg1.genre_1» o la columna «spg1.genre_2».
  compiled SQL at target\run\dbt_summersong_etl\models\datawarehouse\dim_genre.sql
[0m03:56:53.471039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF546020>]}
[0m03:56:53.472050 [error] [Thread-1 (]: 2 of 14 ERROR creating table model SummerSong_datawarehouse.dim_genre .......... [[31mERROR[0m in 0.07s]
[0m03:56:53.474038 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:56:53.475053 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:56:53.476036 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:56:53.477036 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.478038 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:56:53.478038 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:56:53.486031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:53.487031 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.488030 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:56:53.494040 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:56:53.496025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.496025 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:56:53.497025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:53.544001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:53.544001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.544997 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:56:53.562985 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:53.566983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.566983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:56:53.567984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.571981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.571981 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:56:53.572980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.576977 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:53.577978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.577978 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:56:53.580309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:53.583310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:56:53.583310 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:56:53.589063 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:53.591060 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.592059 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:56:53.593058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF5461A0>]}
[0m03:56:53.594058 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.12s]
[0m03:56:53.597056 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:56:53.597056 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:56:53.598055 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:56:53.600054 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.602053 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:56:53.603055 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:56:53.612049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.614046 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.614046 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:56:53.621044 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.623040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.623040 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:56:53.624040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:53.666018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:53.667016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.667016 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:56:53.865262 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.2 seconds
[0m03:56:53.871259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.872258 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:56:53.873258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.880254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.880254 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:56:53.882252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:53.888249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:53.888249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.889249 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:56:53.892247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:53.897244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:56:53.898243 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:56:53.906239 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:53.909237 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.910237 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:56:53.911236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF423E50>]}
[0m03:56:53.912238 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.31s]
[0m03:56:53.915234 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:56:53.916234 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:53.917233 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:56:53.921231 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:53.921231 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:53.922230 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:53.929226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:53.931225 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:53.931225 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:53.943218 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:53.949215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:53.950214 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:56:53.950214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.013178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m03:56:54.014178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:54.014178 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:56:54.025244 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.031241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:54.031241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:56:54.032240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.036239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:54.036239 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:56:54.037237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.040236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:54.041235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:54.041235 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:56:54.043449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.045450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:56:54.046449 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:56:54.051207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:54.053195 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.054194 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:56:54.054194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF5B3B20>]}
[0m03:56:54.055194 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.13s]
[0m03:56:54.058192 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:56:54.059191 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:54.060191 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:56:54.061190 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.062190 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:54.063191 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:54.072184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.075183 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.076182 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:54.083192 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.084177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.086177 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:56:54.087177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.139145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.139145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.140145 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    (string_to_array(psg.genre, ', '))[0] as genre,
    (string_to_array(psg.genre, ', '))[1] as genre_2
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:56:54.154008 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.157007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.158006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:56:54.159007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.162004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.162004 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:56:54.163005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.167002 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:56:54.168002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.169000 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:56:54.170998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.174996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:56:54.175996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:56:54.180994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:54.183992 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.184991 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:56:54.185992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF561450>]}
[0m03:56:54.186990 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 2007[0m in 0.12s]
[0m03:56:54.188989 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:56:54.189988 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:54.190987 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:56:54.192987 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.193987 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:54.194986 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:54.201981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.203980 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.204980 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:54.214973 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.216972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.216972 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:56:54.217972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.272942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.272942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.273940 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:56:54.286932 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.290931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.290931 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:56:54.291932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.296927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.297926 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:56:54.298925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.302925 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:54.302925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.303923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:56:54.305922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.308919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:56:54.309920 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:56:54.315917 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:54.317915 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.318914 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:56:54.319914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF461C90>]}
[0m03:56:54.320914 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.13s]
[0m03:56:54.322912 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:56:54.323912 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:54.323912 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:56:54.326910 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.328910 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:56:54.329912 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:56:54.335905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.337906 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.338904 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:56:54.350897 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.352907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.353895 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:56:54.353895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.408864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.408864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.409863 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:56:54.423854 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.427852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.428851 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:56:54.429851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.432849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.433848 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:56:54.434848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.440844 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:54.441844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.441844 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:56:54.443844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.447841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:56:54.448840 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:56:54.454838 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:54.456837 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.457835 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:56:54.458836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF4840A0>]}
[0m03:56:54.459834 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.13s]
[0m03:56:54.461833 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:56:54.462832 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:54.462832 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:56:54.464831 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.465831 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:54.466831 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:56:54.474826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.476825 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.476825 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:54.487819 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.489818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.490816 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:56:54.491815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.543787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.544786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.545785 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:56:54.557788 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.560786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.561786 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:56:54.562787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.565784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.566784 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:56:54.567784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.571780 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:54.571780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.572780 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:56:54.574326 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.576328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:56:54.577327 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:56:54.582051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:54.584051 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.584051 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:56:54.585050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF54B610>]}
[0m03:56:54.586050 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.12s]
[0m03:56:54.588047 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:56:54.589047 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:54.589047 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:56:54.590047 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.591047 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:56:54.592047 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:56:54.599042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.600041 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.601041 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:56:54.611035 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.613033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.613033 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:56:54.614033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.660007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.661006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.661006 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:56:54.677998 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:56:54.686992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.686992 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:56:54.688992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.694989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.695987 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:56:54.696986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.702983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:54.703983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.703983 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:56:54.706980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.714976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:56:54.714976 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:56:54.723971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:56:54.727969 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.728969 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:56:54.729968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF5610C0>]}
[0m03:56:54.730966 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.14s]
[0m03:56:54.733965 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:56:54.734965 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:56:54.734965 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:56:54.737964 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.737964 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:56:54.738963 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:56:54.749955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.751955 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.752955 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:56:54.761949 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.762948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.763948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:56:54.763948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.806924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:54.807923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.807923 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:56:54.818788 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:56:54.822784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.822784 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:56:54.823784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.826783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.827782 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:56:54.828783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:54.831779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:54.831779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.832779 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:56:54.834778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:54.839776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:56:54.839776 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:56:54.845457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:54.847456 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.848454 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:56:54.849454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF560FD0>]}
[0m03:56:54.849454 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.11s]
[0m03:56:54.851454 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:56:54.852453 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:56:54.853452 [info ] [Thread-1 (]: 12 of 14 SKIP relation SummerSong_datawarehouse.fact_publication ............... [[33mSKIP[0m]
[0m03:56:54.855451 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:56:54.856451 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:54.857450 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:56:54.860449 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:54.860449 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:56:54.861448 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:56:54.866445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:54.869453 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:54.870443 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:56:54.877438 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:54.878438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:54.879438 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:56:54.879438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:54.925410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:56:54.925410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:54.926410 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:56:55.102269 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.18 seconds
[0m03:56:55.109267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:55.109267 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:56:55.110264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:55.155253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:55.156253 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:56:55.157254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:55.160236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:56:55.160236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:55.160236 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:56:55.162268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:55.165268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:56:55.165268 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:56:55.168266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:55.170281 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:55.170281 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:56:55.171280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297C9268D30>]}
[0m03:56:55.172264 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 0[0m in 0.31s]
[0m03:56:55.174264 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:56:55.175266 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:55.176264 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:56:55.177264 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.178261 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:56:55.178261 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:56:55.184272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.186260 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:55.187256 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:56:55.197252 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.198249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.199251 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:56:55.199251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:56:55.244239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:56:55.244239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.245223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    inner join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:56:55.256734 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.01 seconds
[0m03:56:55.259746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.260744 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:56:55.261730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:55.264727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.265726 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:56:55.265726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:56:55.268725 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:56:55.269724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.269724 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:56:55.271800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:56:55.274802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:56:55.274802 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:56:55.277862 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:56:55.279862 [debug] [Thread-1 (]: finished collecting timing info
[0m03:56:55.280861 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:56:55.280861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4f0cdc-08e8-4aa7-94c7-e88179e46b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF450070>]}
[0m03:56:55.281861 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 0[0m in 0.10s]
[0m03:56:55.283861 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:56:55.285858 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:56:55.285858 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:55.286858 [debug] [MainThread]: On master: BEGIN
[0m03:56:55.286858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:56:55.333831 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:56:55.333831 [debug] [MainThread]: On master: COMMIT
[0m03:56:55.334847 [debug] [MainThread]: Using postgres connection "master"
[0m03:56:55.335829 [debug] [MainThread]: On master: COMMIT
[0m03:56:55.336832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:56:55.336832 [debug] [MainThread]: On master: Close
[0m03:56:55.337830 [info ] [MainThread]: 
[0m03:56:55.338830 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m03:56:55.339827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:56:55.340827 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:56:55.340827 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_staging' was properly closed.
[0m03:56:55.341842 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:56:55.354819 [info ] [MainThread]: 
[0m03:56:55.356819 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:56:55.358817 [info ] [MainThread]: 
[0m03:56:55.360816 [error] [MainThread]: [33mDatabase Error in model dim_genre (models\datawarehouse\dim_genre.sql)[0m
[0m03:56:55.361816 [error] [MainThread]:   no existe la columna spg1.genre
[0m03:56:55.363814 [error] [MainThread]:   LINE 10:     spg1.genre
[0m03:56:55.364829 [error] [MainThread]:                ^
[0m03:56:55.365814 [error] [MainThread]:   HINT:  Probablemente quiera hacer referencia a la columna «spg1.genre_1» o la columna «spg1.genre_2».
[0m03:56:55.366832 [error] [MainThread]:   compiled SQL at target\run\dbt_summersong_etl\models\datawarehouse\dim_genre.sql
[0m03:56:55.367814 [info ] [MainThread]: 
[0m03:56:55.369821 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 TOTAL=14
[0m03:56:55.371811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF21B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF2190C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297CF437F40>]}


============================== 2022-11-23 03:57:50.713941 | 71b13f03-cb58-4cba-8e16-f2bf1d0d3b34 ==============================
[0m03:57:50.713941 [info ] [MainThread]: Running with dbt=1.2.0
[0m03:57:50.714941 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\feder\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:57:50.715941 [debug] [MainThread]: Tracking: tracking
[0m03:57:50.733933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E7C4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E7F09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E7F0730>]}
[0m03:57:50.849864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:57:50.850863 [debug] [MainThread]: Partial parsing: updated file: dbt_summersong_etl://models\staging\publication\stg_publication_songgenres.sql
[0m03:57:50.866854 [debug] [MainThread]: 1699: static parser successfully parsed staging\publication\stg_publication_songgenres.sql
[0m03:57:50.890769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_summersong_etl.example

[0m03:57:50.900599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E991A20>]}
[0m03:57:50.914595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E7B8B20>]}
[0m03:57:50.915595 [info ] [MainThread]: Found 14 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 16 sources, 0 exposures, 0 metrics
[0m03:57:50.916578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E7C4F40>]}
[0m03:57:50.922579 [info ] [MainThread]: 
[0m03:57:50.924588 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:57:50.927574 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:57:50.943564 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:57:50.944563 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:57:50.945563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:51.003530 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.06 seconds
[0m03:57:51.005528 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:57:51.006527 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:57:51.009526 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:57:51.009526 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:57:51.010525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:51.051502 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:57:51.053502 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:57:51.054500 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song"
[0m03:57:51.057500 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song"
[0m03:57:51.057500 [debug] [ThreadPool]: On list_Summer_Song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song"} */

    select distinct nspname from pg_namespace
  
[0m03:57:51.058497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:51.095479 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.04 seconds
[0m03:57:51.098477 [debug] [ThreadPool]: On list_Summer_Song: Close
[0m03:57:51.101476 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:57:51.115480 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:57:51.116464 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: BEGIN
[0m03:57:51.116464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:57:51.154443 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.154443 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_datawarehouse"
[0m03:57:51.155442 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_datawarehouse"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_datawarehouse'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_datawarehouse'
  
[0m03:57:51.162453 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m03:57:51.164439 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: ROLLBACK
[0m03:57:51.164439 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_datawarehouse: Close
[0m03:57:51.166437 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:57:51.168450 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:57:51.169437 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: BEGIN
[0m03:57:51.169437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:51.207424 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.208414 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_staging"
[0m03:57:51.209412 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_staging"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_staging'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_staging'
  
[0m03:57:51.215419 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.01 seconds
[0m03:57:51.218408 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: ROLLBACK
[0m03:57:51.218408 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_staging: Close
[0m03:57:51.219408 [debug] [ThreadPool]: Acquiring new postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:57:51.222419 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:57:51.222419 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: BEGIN
[0m03:57:51.223419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:57:51.264393 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.264393 [debug] [ThreadPool]: Using postgres connection "list_Summer_Song_SummerSong_profile"
[0m03:57:51.265380 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "list_Summer_Song_SummerSong_profile"} */
select
      'Summer_Song' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'SummerSong_profile'
    union all
    select
      'Summer_Song' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'SummerSong_profile'
  
[0m03:57:51.272377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m03:57:51.274374 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: ROLLBACK
[0m03:57:51.275375 [debug] [ThreadPool]: On list_Summer_Song_SummerSong_profile: Close
[0m03:57:51.283370 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:51.283370 [debug] [MainThread]: On master: BEGIN
[0m03:57:51.284371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:57:51.322346 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.323352 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:51.323352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:57:51.361324 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m03:57:51.363324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E946DA0>]}
[0m03:57:51.363324 [debug] [MainThread]: On master: ROLLBACK
[0m03:57:51.364323 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:51.364323 [debug] [MainThread]: On master: BEGIN
[0m03:57:51.365323 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:57:51.365323 [debug] [MainThread]: On master: COMMIT
[0m03:57:51.366324 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:51.366324 [debug] [MainThread]: On master: COMMIT
[0m03:57:51.367324 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:57:51.367324 [debug] [MainThread]: On master: Close
[0m03:57:51.368321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:57:51.370320 [info ] [MainThread]: 
[0m03:57:51.379146 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_artist
[0m03:57:51.379146 [info ] [Thread-1 (]: 1 of 14 START table model SummerSong_datawarehouse.dim_artist .................. [RUN]
[0m03:57:51.381144 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.382143 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_artist
[0m03:57:51.382143 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_artist
[0m03:57:51.396135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.398134 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.399133 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_artist
[0m03:57:51.476089 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.477091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.477091 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: BEGIN
[0m03:57:51.478089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:57:51.516066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.516066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.517067 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp"
  as (
    

with artist as (
    select distinct
    spg1.artist as artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as spg1
),

identified_artist as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.artist)) AS id_artist,
    spg.artist as artist
    from artist as spg
)


select * from identified_artist
  );
[0m03:57:51.533152 [debug] [Thread-1 (]: SQL status: SELECT 832 in 0.02 seconds
[0m03:57:51.540146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.541146 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist" rename to "dim_artist__dbt_backup"
[0m03:57:51.542146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.547143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.548144 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_tmp" rename to "dim_artist"
[0m03:57:51.549142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.582137 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:57:51.582137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.583122 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: COMMIT
[0m03:57:51.584723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:51.590737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_artist"
[0m03:57:51.590737 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_artist"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_artist__dbt_backup" cascade
[0m03:57:51.595078 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:51.597082 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.597082 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_artist: Close
[0m03:57:51.598082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EA24B80>]}
[0m03:57:51.599065 [info ] [Thread-1 (]: 1 of 14 OK created table model SummerSong_datawarehouse.dim_artist ............. [[32mSELECT 832[0m in 0.22s]
[0m03:57:51.601066 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_artist
[0m03:57:51.602064 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_genre
[0m03:57:51.603079 [info ] [Thread-1 (]: 2 of 14 START table model SummerSong_datawarehouse.dim_genre ................... [RUN]
[0m03:57:51.604063 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.605063 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_genre
[0m03:57:51.606062 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_genre
[0m03:57:51.611059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.613057 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.613057 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_genre
[0m03:57:51.620064 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.622053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.624052 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: BEGIN
[0m03:57:51.625052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:51.670031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.671025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.671025 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp"
  as (
    

with genres as (
    select distinct
    spg1.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spg1
),

identified_genre as (
    select
    ROW_NUMBER() OVER(ORDER BY (spg.genre)) AS id_genre,
    spg.genre
    from genres as spg
)

select * from identified_genre
  );
[0m03:57:51.686017 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m03:57:51.693012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.693012 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre" rename to "dim_genre__dbt_backup"
[0m03:57:51.694012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.698011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.699011 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_tmp" rename to "dim_genre"
[0m03:57:51.700008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.706004 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:57:51.707004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.707004 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: COMMIT
[0m03:57:51.709004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:51.712000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_genre"
[0m03:57:51.712000 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_genre"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_genre__dbt_backup" cascade
[0m03:57:51.716540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:51.718538 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.718538 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_genre: Close
[0m03:57:51.719538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F57B0>]}
[0m03:57:51.720537 [info ] [Thread-1 (]: 2 of 14 OK created table model SummerSong_datawarehouse.dim_genre .............. [[32mSELECT 1[0m in 0.12s]
[0m03:57:51.722535 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_genre
[0m03:57:51.723536 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.dim_song
[0m03:57:51.723536 [info ] [Thread-1 (]: 3 of 14 START table model SummerSong_datawarehouse.dim_song .................... [RUN]
[0m03:57:51.725534 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.725534 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.dim_song
[0m03:57:51.726535 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.dim_song
[0m03:57:51.733529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:57:51.734529 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.736535 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.dim_song
[0m03:57:51.743525 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.dim_song"
[0m03:57:51.744523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.745524 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: BEGIN
[0m03:57:51.746522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:51.791498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:51.792496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.792496 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp"
  as (
    

with song as (
    select
    ssy.id_song,
    ssy.song,
    ssy.artist,
    ssy.year,    
    ssd.duration_ms as duration,
    sse.explicit,
    sst.mode,
    sst.key,
    sst.tempo
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_staging"."stg_song_traits" as sst,
        "Summer_Song"."SummerSong_staging"."stg_song_explicit" as sse, "Summer_Song"."SummerSong_staging"."stg_song_duration" as ssd
        where
            ssy.id_song = sst.id_song and ssy.id_song = sse.id_song and ssy.id_song = ssd.id_song
)

select * from song
  );
[0m03:57:51.813830 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:57:51.818826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.819825 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song" rename to "dim_song__dbt_backup"
[0m03:57:51.820825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.827821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.828820 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_tmp" rename to "dim_song"
[0m03:57:51.829820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:51.832818 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:57:51.833817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.833817 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: COMMIT
[0m03:57:51.835817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:51.839816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.dim_song"
[0m03:57:51.839816 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.dim_song"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."dim_song__dbt_backup" cascade
[0m03:57:51.846810 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:57:51.848809 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.849808 [debug] [Thread-1 (]: On model.dbt_summersong_etl.dim_song: Close
[0m03:57:51.850809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EAD1180>]}
[0m03:57:51.851808 [info ] [Thread-1 (]: 3 of 14 OK created table model SummerSong_datawarehouse.dim_song ............... [[32mSELECT 2007[0m in 0.13s]
[0m03:57:51.853806 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.dim_song
[0m03:57:51.853806 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.profiled_data
[0m03:57:51.854806 [info ] [Thread-1 (]: 4 of 14 START table model SummerSong_profile.profiled_data ..................... [RUN]
[0m03:57:51.856806 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:51.857805 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.profiled_data
[0m03:57:51.858804 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.profiled_data
[0m03:57:51.866799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:57:51.867798 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:51.868798 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.profiled_data
[0m03:57:51.881791 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.profiled_data"
[0m03:57:51.883789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:51.883789 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: BEGIN
[0m03:57:51.884788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:51.939757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:57:51.940757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:51.940757 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */


  create  table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp"
  as (
    

with profiled_data as (
    select distinct
    d.artist,
    d.song,
    y.year,
    d.duration_ms,
    g.genre,
    p.popularity,
    ri.explicit,
    ss.danceability,
    ss.energy,
    ss.key,
    ss.loudness,
    ss.mode,
    ss.speechiness,
    ss.acousticness,
    ss.instrumentalness,
    ss.liveness,
    ss.valence,
    ss.tempo
    from "Summer_Song"."SummerSong"."duration" as d
    inner join "Summer_Song"."SummerSong"."genre" as g on (g.artist=d.artist and g.song=d.song)
    inner join "Summer_Song"."SummerSong"."year" as y on (y.artist=d.artist and y.song=d.song)
    inner join "Summer_Song"."SummerSong"."statistics"  as ss on (ss.artist=d.artist and ss.song=d.song)
    inner join "Summer_Song"."SummerSong"."regulatory_information" as ri on (ri.artist=d.artist and ri.song=d.song)
    inner join "Summer_Song"."SummerSong"."popularity" as p on (d.artist=p.artist and d.song=p.song)
),

identified_profiled_data as (
    select distinct
    ROW_NUMBER() OVER(ORDER BY (pf.song)) AS id_song,
    pf.artist,
    pf.song,
    pf.year,
    pf.duration_ms,
    pf.genre,
    pf.popularity,
    pf.explicit,
    pf.danceability,
    pf.energy,
    pf.key,
    pf.loudness,
    pf.mode,
    pf.speechiness,
    pf.acousticness,
    pf.instrumentalness,
    pf.liveness,
    pf.valence,
    pf.tempo
    from profiled_data as pf
)

select * from identified_profiled_data
  );
[0m03:57:52.060689 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.12 seconds
[0m03:57:52.064686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:52.065685 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data" rename to "profiled_data__dbt_backup"
[0m03:57:52.066685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.071681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:52.072681 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
alter table "Summer_Song"."SummerSong_profile"."profiled_data__dbt_tmp" rename to "profiled_data"
[0m03:57:52.073681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.078677 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:57:52.078677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:52.079679 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: COMMIT
[0m03:57:52.081676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.086673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.profiled_data"
[0m03:57:52.086673 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.profiled_data"} */
drop table if exists "Summer_Song"."SummerSong_profile"."profiled_data__dbt_backup" cascade
[0m03:57:52.092669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:52.094668 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.095668 [debug] [Thread-1 (]: On model.dbt_summersong_etl.profiled_data: Close
[0m03:57:52.096668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EA8D060>]}
[0m03:57:52.097667 [info ] [Thread-1 (]: 4 of 14 OK created table model SummerSong_profile.profiled_data ................ [[32mSELECT 2007[0m in 0.24s]
[0m03:57:52.099666 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.profiled_data
[0m03:57:52.099666 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:57:52.100665 [info ] [Thread-1 (]: 5 of 14 START table model SummerSong_staging.stg_publication_popularity ........ [RUN]
[0m03:57:52.102664 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.103664 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_popularity
[0m03:57:52.104664 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_popularity
[0m03:57:52.109662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.111660 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.111660 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_popularity
[0m03:57:52.121653 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.124652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.125651 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: BEGIN
[0m03:57:52.126650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.175623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:57:52.175623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.176622 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp"
  as (
    

with song_popularity as (
    select
    p.id_song,
    p.popularity
    from "Summer_Song"."SummerSong_profile"."profiled_data" as p
)

select * from song_popularity
  );
[0m03:57:52.188614 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.191614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.192614 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity" rename to "stg_publication_popularity__dbt_backup"
[0m03:57:52.193612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.197610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.198610 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_tmp" rename to "stg_publication_popularity"
[0m03:57:52.199610 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.203607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:57:52.203607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.204607 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: COMMIT
[0m03:57:52.206449 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.208451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_popularity"
[0m03:57:52.209450 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_popularity"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_popularity__dbt_backup" cascade
[0m03:57:52.214603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:57:52.217601 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.217601 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_popularity: Close
[0m03:57:52.219603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EAF4580>]}
[0m03:57:52.220600 [info ] [Thread-1 (]: 5 of 14 OK created table model SummerSong_staging.stg_publication_popularity ... [[32mSELECT 2007[0m in 0.12s]
[0m03:57:52.222598 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_popularity
[0m03:57:52.223598 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:57:52.224596 [info ] [Thread-1 (]: 6 of 14 START table model SummerSong_staging.stg_publication_songgenres ........ [RUN]
[0m03:57:52.225597 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.226596 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:57:52.227596 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_songgenres
[0m03:57:52.231593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.232592 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.233592 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:57:52.240589 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.242586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.242586 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: BEGIN
[0m03:57:52.243589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.289997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:57:52.290996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.290996 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp"
  as (
    

with publication_songgenres as (
    select
    psg.id_song,
    psg.song,
    (string_to_array(psg.genre, ', '))[1] as genre,
    (string_to_array(psg.genre, ', '))[2] as genre_2
    from "Summer_Song"."SummerSong_profile"."profiled_data" as psg
)

select * from publication_songgenres
  );
[0m03:57:52.305226 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.309222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.309222 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" rename to "stg_publication_songgenres__dbt_backup"
[0m03:57:52.310223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.313220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.314220 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_tmp" rename to "stg_publication_songgenres"
[0m03:57:52.315218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.318217 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:57:52.319218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.320216 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: COMMIT
[0m03:57:52.321216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.326213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_songgenres"
[0m03:57:52.326213 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_songgenres"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_songgenres__dbt_backup" cascade
[0m03:57:52.332123 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:52.334122 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.335121 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_songgenres: Close
[0m03:57:52.336121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F5480>]}
[0m03:57:52.337120 [info ] [Thread-1 (]: 6 of 14 OK created table model SummerSong_staging.stg_publication_songgenres ... [[32mSELECT 2007[0m in 0.11s]
[0m03:57:52.339120 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_songgenres
[0m03:57:52.340118 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:57:52.341117 [info ] [Thread-1 (]: 7 of 14 START table model SummerSong_staging.stg_publication_statistics ........ [RUN]
[0m03:57:52.343117 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.344117 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_publication_statistics
[0m03:57:52.345117 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_publication_statistics
[0m03:57:52.350113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.352112 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.353118 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_publication_statistics
[0m03:57:52.361106 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.362106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.363106 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: BEGIN
[0m03:57:52.363106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.408080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:52.408080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.409080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp"
  as (
    

with song_statistics as (
    select
    s.id_song,
    s.danceability,
    s.energy,
    s.loudness,
    s.speechiness,
    s.acousticness,
    s.instrumentalness,
    s.liveness,
    s.valence,
    s.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as s
)

select * from song_statistics
  );
[0m03:57:52.423070 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.428068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.429069 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics" rename to "stg_publication_statistics__dbt_backup"
[0m03:57:52.430067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.435065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.436064 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
alter table "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_tmp" rename to "stg_publication_statistics"
[0m03:57:52.438063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.443060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:57:52.444060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.444060 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: COMMIT
[0m03:57:52.446263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.448264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_publication_statistics"
[0m03:57:52.449263 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_publication_statistics"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_publication_statistics__dbt_backup" cascade
[0m03:57:52.454574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:57:52.456573 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.457573 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_publication_statistics: Close
[0m03:57:52.458573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EB2F010>]}
[0m03:57:52.458573 [info ] [Thread-1 (]: 7 of 14 OK created table model SummerSong_staging.stg_publication_statistics ... [[32mSELECT 2007[0m in 0.12s]
[0m03:57:52.460571 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_publication_statistics
[0m03:57:52.461570 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_duration
[0m03:57:52.461570 [info ] [Thread-1 (]: 8 of 14 START table model SummerSong_staging.stg_song_duration ................. [RUN]
[0m03:57:52.463570 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.463570 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_duration
[0m03:57:52.464570 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_duration
[0m03:57:52.472566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.474563 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.475563 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_duration
[0m03:57:52.483557 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.484558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.485557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: BEGIN
[0m03:57:52.486570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.529532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:52.530531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.530531 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp"
  as (
    

with song_duration as (
    select
    d.id_song,
    d.duration_ms
    from "Summer_Song"."SummerSong_profile"."profiled_data"  as d
)

select * from song_duration
  );
[0m03:57:52.542927 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.546924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.547924 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration" rename to "stg_song_duration__dbt_backup"
[0m03:57:52.548924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.551922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.552921 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_tmp" rename to "stg_song_duration"
[0m03:57:52.553921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.556919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:57:52.557919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.557919 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: COMMIT
[0m03:57:52.559964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.561964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_duration"
[0m03:57:52.562963 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_duration"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_duration__dbt_backup" cascade
[0m03:57:52.568690 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:57:52.570705 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.570705 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_duration: Close
[0m03:57:52.571704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F52A0>]}
[0m03:57:52.572704 [info ] [Thread-1 (]: 8 of 14 OK created table model SummerSong_staging.stg_song_duration ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:57:52.574700 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_duration
[0m03:57:52.575705 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_explicit
[0m03:57:52.575705 [info ] [Thread-1 (]: 9 of 14 START table model SummerSong_staging.stg_song_explicit ................. [RUN]
[0m03:57:52.577701 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.577701 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_explicit
[0m03:57:52.578713 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_explicit
[0m03:57:52.584696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.586703 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.587696 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_explicit
[0m03:57:52.596687 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.597687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.598687 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: BEGIN
[0m03:57:52.598687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.645661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:57:52.645661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.646659 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp"
  as (
    

with song_explicit as (
    select
    e.id_song,
    e.explicit
    from "Summer_Song"."SummerSong_profile"."profiled_data" as e
)

select * from song_explicit
  );
[0m03:57:52.657231 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.661230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.662229 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit" rename to "stg_song_explicit__dbt_backup"
[0m03:57:52.663228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.666226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.666226 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_tmp" rename to "stg_song_explicit"
[0m03:57:52.667226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.671225 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:57:52.672223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.672223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: COMMIT
[0m03:57:52.674212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.678212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_explicit"
[0m03:57:52.678212 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_explicit"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_explicit__dbt_backup" cascade
[0m03:57:52.684199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:52.687197 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.687197 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_explicit: Close
[0m03:57:52.688197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F5180>]}
[0m03:57:52.689196 [info ] [Thread-1 (]: 9 of 14 OK created table model SummerSong_staging.stg_song_explicit ............ [[32mSELECT 2007[0m in 0.11s]
[0m03:57:52.690197 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_explicit
[0m03:57:52.691195 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_traits
[0m03:57:52.692194 [info ] [Thread-1 (]: 10 of 14 START table model SummerSong_staging.stg_song_traits .................. [RUN]
[0m03:57:52.693194 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.694193 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_traits
[0m03:57:52.695195 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_traits
[0m03:57:52.702189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.704187 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.706188 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_traits
[0m03:57:52.713182 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.714182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.715181 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: BEGIN
[0m03:57:52.715181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.759156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:52.759156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.760155 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp"
  as (
    

with song_traits as (
    select
    t.id_song,
    t.mode,
    t.key,
    t.tempo
    from "Summer_Song"."SummerSong_profile"."profiled_data" as t
)

select * from song_traits
  );
[0m03:57:52.771174 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.01 seconds
[0m03:57:52.775173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.775173 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits" rename to "stg_song_traits__dbt_backup"
[0m03:57:52.776172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.779170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.780169 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_tmp" rename to "stg_song_traits"
[0m03:57:52.781168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:52.784166 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:57:52.784166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.785167 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: COMMIT
[0m03:57:52.787165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:52.790163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_traits"
[0m03:57:52.790163 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_traits"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_traits__dbt_backup" cascade
[0m03:57:52.796161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:52.798158 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.798158 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_traits: Close
[0m03:57:52.799158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F50C0>]}
[0m03:57:52.800158 [info ] [Thread-1 (]: 10 of 14 OK created table model SummerSong_staging.stg_song_traits ............. [[32mSELECT 2007[0m in 0.11s]
[0m03:57:52.801158 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_traits
[0m03:57:52.802157 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_song_year
[0m03:57:52.803156 [info ] [Thread-1 (]: 11 of 14 START table model SummerSong_staging.stg_song_year .................... [RUN]
[0m03:57:52.804155 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:52.805157 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_song_year
[0m03:57:52.806155 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_song_year
[0m03:57:52.811151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:57:52.812151 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:52.813151 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_song_year
[0m03:57:52.820146 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_song_year"
[0m03:57:52.822147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:52.823146 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: BEGIN
[0m03:57:52.824148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:52.996950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.17 seconds
[0m03:57:52.997970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:52.998948 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp"
  as (
    

with song_year as (
    select
    y.id_song,
    y.artist,
    y.song,
    y.year
    from "Summer_Song"."SummerSong_profile"."profiled_data" as y
)

select * from song_year
  );
[0m03:57:53.015784 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:57:53.020801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:53.021801 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year" rename to "stg_song_year__dbt_backup"
[0m03:57:53.022779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.026798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:53.026798 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
alter table "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_tmp" rename to "stg_song_year"
[0m03:57:53.027779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.031794 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:57:53.031794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:53.031794 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: COMMIT
[0m03:57:53.034546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:53.038567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_song_year"
[0m03:57:53.039557 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_song_year"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_song_year__dbt_backup" cascade
[0m03:57:53.046129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m03:57:53.048146 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.048146 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_song_year: Close
[0m03:57:53.049145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F4FD0>]}
[0m03:57:53.050129 [info ] [Thread-1 (]: 11 of 14 OK created table model SummerSong_staging.stg_song_year ............... [[32mSELECT 2007[0m in 0.24s]
[0m03:57:53.052345 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_song_year
[0m03:57:53.052345 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.fact_publication
[0m03:57:53.053342 [info ] [Thread-1 (]: 12 of 14 START table model SummerSong_datawarehouse.fact_publication ........... [RUN]
[0m03:57:53.054363 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.055344 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.fact_publication
[0m03:57:53.055344 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.fact_publication
[0m03:57:53.116306 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.117305 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.119305 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.fact_publication
[0m03:57:53.126315 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.127302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.127302 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: BEGIN
[0m03:57:53.128315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:53.172279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:53.173274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.173274 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */


  create  table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp"
  as (
    

with publication_genre_1 as (
    select
    sps.id_song,
    gen.id_genre as id_principal_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1
         where
             sps.id_song = spg1.id_song and gen.genre = spg1.genre_1
),

publication_genre_2 as (
    select distinct
    sps.id_song,
    gen.id_genre as id_secondary_genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps, "Summer_Song"."SummerSong_datawarehouse"."dim_genre" as gen, 
         "Summer_Song"."SummerSong_staging"."stg_genre_2" as spg2
         where
             sps.id_song = spg2.id_song and gen.genre = spg2.genre
),

publication_artist as (
    select
    ssy.id_song,
    art.id_artist
    from "Summer_Song"."SummerSong_staging"."stg_song_year" as ssy, "Summer_Song"."SummerSong_datawarehouse"."dim_artist" as art
         where
             ssy.artist = art.artist
),

publication as (
    select
    sps.id_song,
    pg1.id_principal_genre,
    pg2.id_secondary_genre,
    pa.id_artist,
    sps.danceability,
    sps.energy,
    sps.loudness,
    sps.speechiness,
    sps.acousticness,
    sps.instrumentalness,
    sps.liveness,
    sps.valence
    from "Summer_Song"."SummerSong_staging"."stg_publication_statistics" as sps
    inner join
        publication_genre_1 as pg1 on
            pg1.id_song = sps.id_song
    inner join
        publication_artist as pa on
            pa.id_song = sps.id_song
    full outer join
        publication_genre_2 as pg2 on
        pg2.id_song = sps.id_song
)

select distinct * from publication
  );
[0m03:57:53.203257 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.03 seconds
[0m03:57:53.209254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.209254 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication" rename to "fact_publication__dbt_backup"
[0m03:57:53.210252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.214253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.215252 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
alter table "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_tmp" rename to "fact_publication"
[0m03:57:53.216249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.220250 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:57:53.221246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.221246 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: COMMIT
[0m03:57:53.223245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:53.225244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.fact_publication"
[0m03:57:53.226243 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.fact_publication"} */
drop table if exists "Summer_Song"."SummerSong_datawarehouse"."fact_publication__dbt_backup" cascade
[0m03:57:53.230241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:53.233241 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.233241 [debug] [Thread-1 (]: On model.dbt_summersong_etl.fact_publication: Close
[0m03:57:53.234242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EB65990>]}
[0m03:57:53.236239 [info ] [Thread-1 (]: 12 of 14 OK created table model SummerSong_datawarehouse.fact_publication ...... [[32mSELECT 0[0m in 0.18s]
[0m03:57:53.237240 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.fact_publication
[0m03:57:53.238237 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_1
[0m03:57:53.239236 [info ] [Thread-1 (]: 13 of 14 START table model SummerSong_staging.stg_genre_1 ...................... [RUN]
[0m03:57:53.240235 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.241236 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_1
[0m03:57:53.241236 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_1
[0m03:57:53.248232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.249231 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.250231 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_1
[0m03:57:53.260225 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.262223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.263223 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: BEGIN
[0m03:57:53.263223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:53.317194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m03:57:53.318193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.319192 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp"
  as (
    

with stg_genre_1 as (
    select distinct
    spsg.id_song,
    spsg.genre as genre_1    
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg
        where spsg.genre in (select spsg1.genre from
            (select spsg2.id_song,spsg2.genre from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg2 
                where spsg.id_song=spsg2.id_song LIMIT 1) as spsg1)
)

select * from stg_genre_1
  );
[0m03:57:53.534088 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.21 seconds
[0m03:57:53.538065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.538065 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1" rename to "stg_genre_1__dbt_backup"
[0m03:57:53.539067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.543083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.543083 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_tmp" rename to "stg_genre_1"
[0m03:57:53.544061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.547081 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:57:53.547081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.548080 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: COMMIT
[0m03:57:53.549592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:53.551594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_1"
[0m03:57:53.552592 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_1"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_1__dbt_backup" cascade
[0m03:57:53.555638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:53.557656 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.557656 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_1: Close
[0m03:57:53.558641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EB0CDC0>]}
[0m03:57:53.559638 [info ] [Thread-1 (]: 13 of 14 OK created table model SummerSong_staging.stg_genre_1 ................. [[32mSELECT 2007[0m in 0.32s]
[0m03:57:53.561637 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_1
[0m03:57:53.562639 [debug] [Thread-1 (]: Began running node model.dbt_summersong_etl.stg_genre_2
[0m03:57:53.563636 [info ] [Thread-1 (]: 14 of 14 START table model SummerSong_staging.stg_genre_2 ...................... [RUN]
[0m03:57:53.564651 [debug] [Thread-1 (]: Acquiring new postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.565638 [debug] [Thread-1 (]: Began compiling node model.dbt_summersong_etl.stg_genre_2
[0m03:57:53.565638 [debug] [Thread-1 (]: Compiling model.dbt_summersong_etl.stg_genre_2
[0m03:57:53.578627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.579722 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.579722 [debug] [Thread-1 (]: Began executing node model.dbt_summersong_etl.stg_genre_2
[0m03:57:53.585726 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.588722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.588722 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: BEGIN
[0m03:57:53.589721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:57:53.633343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m03:57:53.633343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.634342 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */


  create  table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp"
  as (
    

with stg_genre_2 as (
    select distinct
    spsg.id_song,
    spsg.genre
    from "Summer_Song"."SummerSong_staging"."stg_publication_songgenres" as spsg 
    inner join "Summer_Song"."SummerSong_staging"."stg_genre_1" as spg1 on spsg.id_song = spg1.id_song
)

select * from stg_genre_2
  );
[0m03:57:53.649866 [debug] [Thread-1 (]: SQL status: SELECT 2007 in 0.02 seconds
[0m03:57:53.653866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.654865 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2" rename to "stg_genre_2__dbt_backup"
[0m03:57:53.655864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.658877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.658877 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
alter table "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_tmp" rename to "stg_genre_2"
[0m03:57:53.659876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:57:53.663873 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:57:53.663873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.663873 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: COMMIT
[0m03:57:53.665869 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m03:57:53.669856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_summersong_etl.stg_genre_2"
[0m03:57:53.670855 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: /* {"app": "dbt", "dbt_version": "1.2.0", "profile_name": "dbt_summersong_etl", "target_name": "dev", "node_id": "model.dbt_summersong_etl.stg_genre_2"} */
drop table if exists "Summer_Song"."SummerSong_staging"."stg_genre_2__dbt_backup" cascade
[0m03:57:53.674855 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m03:57:53.676852 [debug] [Thread-1 (]: finished collecting timing info
[0m03:57:53.676852 [debug] [Thread-1 (]: On model.dbt_summersong_etl.stg_genre_2: Close
[0m03:57:53.678851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71b13f03-cb58-4cba-8e16-f2bf1d0d3b34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F5330>]}
[0m03:57:53.679850 [info ] [Thread-1 (]: 14 of 14 OK created table model SummerSong_staging.stg_genre_2 ................. [[32mSELECT 2007[0m in 0.11s]
[0m03:57:53.680850 [debug] [Thread-1 (]: Finished running node model.dbt_summersong_etl.stg_genre_2
[0m03:57:53.683850 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m03:57:53.683850 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:53.684847 [debug] [MainThread]: On master: BEGIN
[0m03:57:53.685847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:57:53.739815 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m03:57:53.740815 [debug] [MainThread]: On master: COMMIT
[0m03:57:53.740815 [debug] [MainThread]: Using postgres connection "master"
[0m03:57:53.741815 [debug] [MainThread]: On master: COMMIT
[0m03:57:53.741815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:57:53.742816 [debug] [MainThread]: On master: Close
[0m03:57:53.743814 [info ] [MainThread]: 
[0m03:57:53.744813 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m03:57:53.745815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:57:53.746813 [debug] [MainThread]: Connection 'list_Summer_Song' was properly closed.
[0m03:57:53.746813 [debug] [MainThread]: Connection 'list_Summer_Song_SummerSong_profile' was properly closed.
[0m03:57:53.747811 [debug] [MainThread]: Connection 'model.dbt_summersong_etl.stg_genre_2' was properly closed.
[0m03:57:53.760805 [info ] [MainThread]: 
[0m03:57:53.762802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:57:53.763801 [info ] [MainThread]: 
[0m03:57:53.764801 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m03:57:53.765800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EAD3D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31EA259C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A31E9F6A70>]}
